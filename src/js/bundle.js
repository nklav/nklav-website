function _get(e,t,r){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var i=_superPropBase(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(r):n.value}})(e,t,r||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var r,i=_getPrototypeOf(e);if(t){var n=_getPrototypeOf(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).window=e.window||{})}(this,(function(e){function t(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i(e){return"string"==typeof e}function n(e){return"function"==typeof e}function s(e){return"number"==typeof e}function a(e){return void 0===e}function o(e){return"object"==typeof e}function h(e){return!1!==e}function l(){return"undefined"!=typeof window}function u(e){return n(e)||i(e)}function d(e){return(ve=ft(e,nt))&&fr}function c(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")}function f(e,t){return!t&&console.warn(e)}function p(e,t){return e&&(nt[e]=t)&&ve&&(ve[e]=t)||nt}function _(){return 0}function g(e){var t,r,i=e[0];if(o(i)||n(i)||(e=[e]),!(t=(i._gsap||{}).harness)){for(r=dt.length;r--&&!dt[r].targetTest(i););t=dt[r]}for(r=e.length;r--;)e[r]&&(e[r]._gsap||(e[r]._gsap=new It(e[r],t)))||e.splice(r,1);return e}function m(e){return e._gsap||g(xt(e))[0]._gsap}function v(e,t,r){return(r=e[t])&&n(r)?e[t]():a(r)&&e.getAttribute&&e.getAttribute(t)||r}function y(e,t){return(e=e.split(",")).forEach(t)||e}function x(e){return Math.round(1e5*e)/1e5||0}function b(e,t){for(var r=t.length,i=0;e.indexOf(t[i])<0&&++i<r;);return i<r}function k(){var e,t,r=at.length,i=at.slice(0);for(ot={},e=at.length=0;e<r;e++)(t=i[e])&&t._lazy&&(t.render(t._lazy[0],t._lazy[1],!0)._lazy=0)}function w(e,t,r,i){at.length&&k(),e.render(t,r,i),at.length&&k()}function T(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(rt).length<2?t:i(e)?e.trim():e}function P(e){return e}function R(e,t){for(var r in t)r in e||(e[r]=t[r]);return e}function S(e,t){for(var r in t)r in e||"duration"===r||"ease"===r||(e[r]=t[r])}function C(e,t){for(var r in t)"__proto__"!==r&&"constructor"!==r&&"prototype"!==r&&(e[r]=o(t[r])?C(e[r]||(e[r]={}),t[r]):t[r]);return e}function E(e,t){var r,i={};for(r in e)r in t||(i[r]=e[r]);return i}function M(e){var t=e.parent||pe,r=e.keyframes?S:R;if(h(e.inherit))for(;t;)r(e,t.vars.defaults),t=t.parent||t._dp;return e}function A(e,t,r,i){void 0===r&&(r="_first"),void 0===i&&(i="_last");var n=t._prev,s=t._next;n?n._next=s:e[r]===t&&(e[r]=s),s?s._prev=n:e[i]===t&&(e[i]=n),t._next=t._prev=t.parent=null}function O(e,t){!e.parent||t&&!e.parent.autoRemoveChildren||e.parent.remove(e),e._act=0}function F(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var r=e;r;)r._dirty=1,r=r.parent;return e}function D(e){return e._repeat?pt(e._tTime,e=e.duration()+e._rDelay)*e:0}function z(e,t){return(e-t._start)*t._ts+(0<=t._ts?0:t._dirty?t.totalDuration():t._tDur)}function L(e){return e._end=x(e._start+(e._tDur/Math.abs(e._ts||e._rts||We)||0))}function I(e,t){var r=e._dp;return r&&r.smoothChildTiming&&e._ts&&(e._start=x(r._time-(0<e._ts?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),L(e),r._dirty||F(r,e)),e}function U(e,t){var r;if((t._time||t._initted&&!t._dur)&&(r=z(e.rawTime(),t),(!t._dur||vt(0,t.totalDuration(),r)-t._tTime>We)&&t.render(r,!0)),F(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(r=e;r._dp;)0<=r.rawTime()&&r.totalTime(r._tTime),r=r._dp;e._zTime=-We}}function B(e,t,r,i){return t.parent&&O(t),t._start=x((s(r)?r:r||e!==pe?mt(e,r,t):e._time)+t._delay),t._end=x(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),function(e,t,r,i,n){void 0===r&&(r="_first"),void 0===i&&(i="_last");var s,a=e[i];if(n)for(s=t[n];a&&a[n]>s;)a=a._prev;a?(t._next=a._next,a._next=t):(t._next=e[r],e[r]=t),t._next?t._next._prev=t:e[i]=t,t._prev=a,t.parent=t._dp=e}(e,t,"_first","_last",e._sort?"_start":0),_t(t)||(e._recent=t),i||U(e,t),e}function N(e,t){return(nt.ScrollTrigger||c("scrollTrigger",t))&&nt.ScrollTrigger.create(t,e)}function V(e,t,r,i){return Gt(e,t),e._initted?!r&&e._pt&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&xe!==St.frame?(at.push(e),e._lazy=[t,i],1):void 0:1}function W(e,t,r,i){var n=e._repeat,s=x(t)||0,a=e._tTime/e._tDur;return a&&!i&&(e._time*=s/e._dur),e._dur=s,e._tDur=n?n<0?1e10:x(s*(n+1)+e._rDelay*n):s,a&&!i?I(e,e._tTime=e._tDur*a):e.parent&&L(e),r||F(e.parent,e),e}function X(e){return e instanceof Nt?F(e):W(e,e._dur)}function G(e,t,r){var i,n,a=s(t[1]),o=(a?2:1)+(e<2?0:1),l=t[o];if(a&&(l.duration=t[1]),l.parent=r,e){for(i=l,n=r;n&&!("immediateRender"in i);)i=n.vars.defaults||{},n=h(n.vars.inherit)&&n.parent;l.immediateRender=h(i.immediateRender),e<2?l.runBackwards=1:l.startAt=t[o-1]}return new qt(t[0],l,t[1+o])}function Y(e,t){return e||0===e?t(e):t}function j(e){if("string"!=typeof e)return"";var t=it.exec(e);return t?e.substr(t.index+t[0].length):""}function H(e,t){return e&&o(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&o(e[0]))&&!e.nodeType&&e!==_e}function q(e){return e.sort((function(){return.5-Math.random()}))}function Q(e){if(n(e))return e;var t=o(e)?e:{each:e},r=Ft(t.ease),s=t.from||0,a=parseFloat(t.base)||0,h={},l=0<s&&s<1,u=isNaN(s)||l,d=t.axis,c=s,f=s;return i(s)?c=f={center:.5,edges:.5,end:1}[s]||0:!l&&u&&(c=s[0],f=s[1]),function(e,i,n){var o,l,p,_,g,m,v,y,b,k=(n||t).length,w=h[k];if(!w){if(!(b="auto"===t.grid?0:(t.grid||[1,Ve])[1])){for(v=-Ve;v<(v=n[b++].getBoundingClientRect().left)&&b<k;);b--}for(w=h[k]=[],o=u?Math.min(b,k)*c-.5:s%b,l=u?k*f/b-.5:s/b|0,y=Ve,m=v=0;m<k;m++)p=m%b-o,_=l-(m/b|0),w[m]=g=d?Math.abs("y"===d?_:p):je(p*p+_*_),v<g&&(v=g),g<y&&(y=g);"random"===s&&q(w),w.max=v-y,w.min=y,w.v=k=(parseFloat(t.amount)||parseFloat(t.each)*(k<b?k-1:d?"y"===d?k/b:b:Math.max(b,k/b))||0)*("edges"===s?-1:1),w.b=k<0?a-k:a,w.u=j(t.amount||t.each)||0,r=r&&k<0?Ot(r):r}return k=(w[e]-w.min)/w.max||0,x(w.b+(r?r(k):k)*w.v)+w.u}}function Z(e){var t=e<1?Math.pow(10,(e+"").length-2):1;return function(r){var i=Math.round(parseFloat(r)/e)*e*t;return(i-i%1)/t+(s(r)?0:j(r))}}function K(e,t){var r,i,a=Ze(e);return!a&&o(e)&&(r=a=e.radius||Ve,e.values?(e=xt(e.values),(i=!s(e[0]))&&(r*=r)):e=Z(e.increment)),Y(t,a?n(e)?function(t){return i=e(t),Math.abs(i-t)<=r?i:t}:function(t){for(var n,a,o=parseFloat(i?t.x:t),h=parseFloat(i?t.y:0),l=Ve,u=0,d=e.length;d--;)(n=i?(n=e[d].x-o)*n+(a=e[d].y-h)*a:Math.abs(e[d]-o))<l&&(l=n,u=d);return u=!r||l<=r?e[u]:t,i||u===t||s(t)?u:u+j(t)}:Z(e))}function $(e,t,r,i){return Y(Ze(e)?!t:!0===r?!!(r=0):!i,(function(){return Ze(e)?e[~~(Math.random()*e.length)]:(r=r||1e-5)&&(i=r<1?Math.pow(10,(r+"").length-2):1)&&Math.floor(Math.round((e-r/2+Math.random()*(t-e+.99*r))/r)*r*i)/i}))}function J(e,t,r){return Y(r,(function(r){return e[~~t(r)]}))}function ee(e){for(var t,r,i,n,s=0,a="";~(t=e.indexOf("random(",s));)i=e.indexOf(")",t),n="["===e.charAt(t+7),r=e.substr(t+7,i-t-7).match(n?rt:Ke),a+=e.substr(s,t-s)+$(n?r:+r[0],n?0:+r[1],+r[2]||1e-5),s=i+1;return a+e.substr(s,e.length-s)}function te(e,t,r){var i,n,s,a=e.labels,o=Ve;for(i in a)(n=a[i]-t)<0==!!r&&n&&o>(n=Math.abs(n))&&(s=i,o=n);return s}function re(e){return O(e),e.scrollTrigger&&e.scrollTrigger.kill(!1),e.progress()<1&&kt(e,"onInterrupt"),e}function ie(e,t,r){return(6*(e=e<0?e+1:1<e?e-1:e)<1?t+(r-t)*e*6:e<.5?r:3*e<2?t+(r-t)*(2/3-e)*6:t)*wt+.5|0}function ne(e,t,r){var i,n,a,o,h,l,u,d,c,f,p=e?s(e)?[e>>16,e>>8&wt,e&wt]:0:Tt.black;if(!p){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),Tt[e])p=Tt[e];else if("#"===e.charAt(0)){if(e.length<6&&(e="#"+(i=e.charAt(1))+i+(n=e.charAt(2))+n+(a=e.charAt(3))+a+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(p=parseInt(e.substr(1,6),16))>>16,p>>8&wt,p&wt,parseInt(e.substr(7),16)/255];p=[(e=parseInt(e.substr(1),16))>>16,e>>8&wt,e&wt]}else if("hsl"===e.substr(0,3))if(p=f=e.match(Ke),t){if(~e.indexOf("="))return p=e.match($e),r&&p.length<4&&(p[3]=1),p}else o=+p[0]%360/360,h=p[1]/100,i=2*(l=p[2]/100)-(n=l<=.5?l*(h+1):l+h-l*h),3<p.length&&(p[3]*=1),p[0]=ie(o+1/3,i,n),p[1]=ie(o,i,n),p[2]=ie(o-1/3,i,n);else p=e.match(Ke)||Tt.transparent;p=p.map(Number)}return t&&!f&&(i=p[0]/wt,n=p[1]/wt,a=p[2]/wt,l=((u=Math.max(i,n,a))+(d=Math.min(i,n,a)))/2,u===d?o=h=0:(c=u-d,h=.5<l?c/(2-u-d):c/(u+d),o=u===i?(n-a)/c+(n<a?6:0):u===n?(a-i)/c+2:(i-n)/c+4,o*=60),p[0]=~~(o+.5),p[1]=~~(100*h+.5),p[2]=~~(100*l+.5)),r&&p.length<4&&(p[3]=1),p}function se(e){var t=[],r=[],i=-1;return e.split(Pt).forEach((function(e){var n=e.match(Je)||[];t.push.apply(t,n),r.push(i+=n.length+1)})),t.c=r,t}function ae(e,t,r){var i,n,s,a,o="",h=(e+o).match(Pt),l=t?"hsla(":"rgba(",u=0;if(!h)return e;if(h=h.map((function(e){return(e=ne(e,t,1))&&l+(t?e[0]+","+e[1]+"%,"+e[2]+"%,"+e[3]:e.join(","))+")"})),r&&(s=se(e),(i=r.c).join(o)!==s.c.join(o)))for(a=(n=e.replace(Pt,"1").split(Je)).length-1;u<a;u++)o+=n[u]+(~i.indexOf(u)?h.shift()||l+"0,0,0,0)":(s.length?s:h.length?h:r).shift());if(!n)for(a=(n=e.split(Pt)).length-1;u<a;u++)o+=n[u]+h[u];return o+n[a]}function oe(e){var t,r=e.join(" ");if(Pt.lastIndex=0,Pt.test(r))return t=Rt.test(r),e[1]=ae(e[1],t),e[0]=ae(e[0],t,se(e[1])),!0}function he(e,t){for(var r,i=e._first;i;)i instanceof Nt?he(i,t):!i.vars.yoyoEase||i._yoyo&&i._repeat||i._yoyo===t||(i.timeline?he(i.timeline,t):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=t)),i=i._next}function le(e,t,r,i){void 0===r&&(r=function(e){return 1-t(1-e)}),void 0===i&&(i=function(e){return e<.5?t(2*e)/2:1-t(2*(1-e))/2});var n,s={easeIn:t,easeOut:r,easeInOut:i};return y(e,(function(e){for(var t in Et[e]=nt[e]=s,Et[n=e.toLowerCase()]=r,s)Et[n+("easeIn"===t?".in":"easeOut"===t?".out":".inOut")]=Et[e+"."+t]=s[t]})),s}function ue(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}}function de(e,t,r){function i(e){return 1===e?1:n*Math.pow(2,-10*e)*qe((e-a)*s)+1}var n=1<=t?t:1,s=(r||(e?.3:.45))/(t<1?t:1),a=s/Xe*(Math.asin(1/n)||0),o="out"===e?i:"in"===e?function(e){return 1-i(1-e)}:ue(i);return s=Xe/s,o.config=function(t,r){return de(e,t,r)},o}function ce(e,t){function r(e){return e?--e*e*((t+1)*e+t)+1:0}void 0===t&&(t=1.70158);var i="out"===e?r:"in"===e?function(e){return 1-r(1-e)}:ue(r);return i.config=function(t){return ce(e,t)},i}var fe,pe,_e,ge,me,ve,ye,xe,be,ke,we,Te,Pe,Re,Se,Ce,Ee,Me,Ae,Oe,Fe,De,ze,Le,Ie,Ue,Be={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Ne={duration:.5,overwrite:!1,delay:0},Ve=1e8,We=1/Ve,Xe=2*Math.PI,Ge=Xe/4,Ye=0,je=Math.sqrt,He=Math.cos,qe=Math.sin,Qe="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},Ze=Array.isArray,Ke=/(?:-?\.?\d|\.)+/gi,$e=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Je=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,et=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,tt=/[+-]=-?[.\d]+/,rt=/[^,'"\[\]\s]+/gi,it=/[\d.+\-=]+(?:e[-+]\d*)*/i,nt={},st={},at=[],ot={},ht={},lt={},ut=30,dt=[],ct="",ft=function(e,t){for(var r in t)e[r]=t[r];return e},pt=function(e,t){var r=Math.floor(e/=t);return e&&r===e?r-1:r},_t=function(e){var t=e.data;return"isFromStart"===t||"isStart"===t},gt={_start:0,endTime:_,totalDuration:_},mt=function e(t,r,n){var s,a,o,h=t.labels,l=t._recent||gt,u=t.duration()>=Ve?l.endTime(!1):t._dur;return i(r)&&(isNaN(r)||r in h)?(a=r.charAt(0),o="%"===r.substr(-1),s=r.indexOf("="),"<"===a||">"===a?(0<=s&&(r=r.replace(/=/,"")),("<"===a?l._start:l.endTime(0<=l._repeat))+(parseFloat(r.substr(1))||0)*(o?(s<0?l:n).totalDuration()/100:1)):s<0?(r in h||(h[r]=u),h[r]):(a=parseFloat(r.charAt(s-1)+r.substr(s+1)),o&&n&&(a=a/100*(Ze(n)?n[0]:n).totalDuration()),1<s?e(t,r.substr(0,s-1),n)+a:u+a)):null==r?u:+r},vt=function(e,t,r){return r<e?e:t<r?t:r},yt=[].slice,xt=function(e,t,r){return!i(e)||r||!ge&&Ct()?Ze(e)?function(e,t,r){return void 0===r&&(r=[]),e.forEach((function(e){return i(e)&&!t||H(e,1)?r.push.apply(r,xt(e)):r.push(e)}))||r}(e,r):H(e)?yt.call(e,0):e?[e]:[]:yt.call((t||me).querySelectorAll(e),0)},bt=function(e,t,r,i,n){var s=t-e,a=i-r;return Y(n,(function(t){return r+((t-e)/s*a||0)}))},kt=function(e,t,r){var i,n,s=e.vars,a=s[t];if(a)return i=s[t+"Params"],n=s.callbackScope||e,r&&at.length&&k(),i?a.apply(n,i):a.call(n)},wt=255,Tt={aqua:[0,wt,wt],lime:[0,wt,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,wt],navy:[0,0,128],white:[wt,wt,wt],olive:[128,128,0],yellow:[wt,wt,0],orange:[wt,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[wt,0,0],pink:[wt,192,203],cyan:[0,wt,wt],transparent:[wt,wt,wt,0]},Pt=function(){var e,t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in Tt)t+="|"+e+"\\b";return new RegExp(t+")","gi")}(),Rt=/hsl[a]?\(/,St=(Ee=Date.now,Me=500,Ae=33,Oe=Ee(),Fe=Oe,ze=De=1e3/240,Re={time:0,frame:0,tick:function(){Dt(!0)},deltaRatio:function(e){return Se/(1e3/(e||60))},wake:function(){ye&&(!ge&&l()&&(_e=ge=window,me=_e.document||{},nt.gsap=fr,(_e.gsapVersions||(_e.gsapVersions=[])).push(fr.version),d(ve||_e.GreenSockGlobals||!_e.gsap&&_e||{}),Pe=_e.requestAnimationFrame),we&&Re.sleep(),Te=Pe||function(e){return setTimeout(e,ze-1e3*Re.time+1|0)},ke=1,Dt(2))},sleep:function(){(Pe?_e.cancelAnimationFrame:clearTimeout)(we),ke=0,Te=_},lagSmoothing:function(e,t){Me=e||1e8,Ae=Math.min(t,Me,0)},fps:function(e){De=1e3/(e||240),ze=1e3*Re.time+De},add:function(e){Le.indexOf(e)<0&&Le.push(e),Ct()},remove:function(e){var t;~(t=Le.indexOf(e))&&Le.splice(t,1)&&t<=Ce&&Ce--},_listeners:Le=[]}),Ct=function(){return!ke&&St.wake()},Et={},Mt=/^[\d.\-M][\d.\-,\s]/,At=/["']/g,Ot=function(e){return function(t){return 1-e(1-t)}},Ft=function(e,t){return e&&(n(e)?e:Et[e]||function(e){var t=(e+"").split("("),r=Et[t[0]];return r&&1<t.length&&r.config?r.config.apply(null,~e.indexOf("{")?[function(e){for(var t,r,i,n={},s=e.substr(1,e.length-3).split(":"),a=s[0],o=1,h=s.length;o<h;o++)r=s[o],t=o!==h-1?r.lastIndexOf(","):r.length,i=r.substr(0,t),n[a]=isNaN(i)?i.replace(At,"").trim():+i,a=r.substr(t+1).trim();return n}(t[1])]:function(e){var t=e.indexOf("(")+1,r=e.indexOf(")"),i=e.indexOf("(",t);return e.substring(t,~i&&i<r?e.indexOf(")",r+1):r)}(e).split(",").map(T)):Et._CE&&Mt.test(e)?Et._CE("",e):r}(e))||t};function Dt(e){var t,r,i,n,s=Ee()-Fe,a=!0===e;if(Me<s&&(Oe+=s-Ae),(0<(t=(i=(Fe+=s)-Oe)-ze)||a)&&(n=++Re.frame,Se=i-1e3*Re.time,Re.time=i/=1e3,ze+=t+(De<=t?4:De-t),r=1),a||(we=Te(Dt)),r)for(Ce=0;Ce<Le.length;Ce++)Le[Ce](i,Se,n,e)}function zt(e){return e<Ue?Ie*e*e:e<.7272727272727273?Ie*Math.pow(e-1.5/2.75,2)+.75:e<.9090909090909092?Ie*(e-=2.25/2.75)*e+.9375:Ie*Math.pow(e-2.625/2.75,2)+.984375}y("Linear,Quad,Cubic,Quart,Quint,Strong",(function(e,t){var r=t<5?t+1:t;le(e+",Power"+(r-1),t?function(e){return Math.pow(e,r)}:function(e){return e},(function(e){return 1-Math.pow(1-e,r)}),(function(e){return e<.5?Math.pow(2*e,r)/2:1-Math.pow(2*(1-e),r)/2}))})),Et.Linear.easeNone=Et.none=Et.Linear.easeIn,le("Elastic",de("in"),de("out"),de()),Ie=7.5625,Ue=1/2.75,le("Bounce",(function(e){return 1-zt(1-e)}),zt),le("Expo",(function(e){return e?Math.pow(2,10*(e-1)):0})),le("Circ",(function(e){return-(je(1-e*e)-1)})),le("Sine",(function(e){return 1===e?1:1-He(e*Ge)})),le("Back",ce("in"),ce("out"),ce()),Et.SteppedEase=Et.steps=nt.SteppedEase={config:function(e,t){void 0===e&&(e=1);var r=1/e,i=e+(t?0:1),n=t?1:0;return function(e){return((i*vt(0,.99999999,e)|0)+n)*r}}},Ne.ease=Et["quad.out"],y("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(e){return ct+=e+","+e+"Params,"}));var Lt,It=function(e,t){this.id=Ye++,(e._gsap=this).target=e,this.harness=t,this.get=t?t.get:v,this.set=t?t.getSetter:er},Ut=((Lt=Bt.prototype).delay=function(e){return e||0===e?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+e-this._delay),this._delay=e,this):this._delay},Lt.duration=function(e){return arguments.length?this.totalDuration(0<this._repeat?e+(e+this._rDelay)*this._repeat:e):this.totalDuration()&&this._dur},Lt.totalDuration=function(e){return arguments.length?(this._dirty=0,W(this,this._repeat<0?e:(e-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},Lt.totalTime=function(e,t){if(Ct(),!arguments.length)return this._tTime;var r=this._dp;if(r&&r.smoothChildTiming&&this._ts){for(I(this,e),!r._dp||r.parent||U(r,this);r.parent;)r.parent._time!==r._start+(0<=r._ts?r._tTime/r._ts:(r.totalDuration()-r._tTime)/-r._ts)&&r.totalTime(r._tTime,!0),r=r.parent;!this.parent&&this._dp.autoRemoveChildren&&(0<this._ts&&e<this._tDur||this._ts<0&&0<e||!this._tDur&&!e)&&B(this._dp,this,this._start-this._delay)}return(this._tTime!==e||!this._dur&&!t||this._initted&&Math.abs(this._zTime)===We||!e&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=e),w(this,e,t)),this},Lt.time=function(e,t){return arguments.length?this.totalTime(Math.min(this.totalDuration(),e+D(this))%(this._dur+this._rDelay)||(e?this._dur:0),t):this._time},Lt.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},Lt.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?e:1-e)+D(this),t):this.duration()?Math.min(1,this._time/this._dur):this.ratio},Lt.iteration=function(e,t){var r=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(e-1)*r,t):this._repeat?pt(this._tTime,r)+1:1},Lt.timeScale=function(e){if(!arguments.length)return this._rts===-We?0:this._rts;if(this._rts===e)return this;var t=this.parent&&this._ts?z(this.parent._time,this):this._tTime;return this._rts=+e||0,this._ts=this._ps||e===-We?0:this._rts,function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e}(this.totalTime(vt(-this._delay,this._tDur,t),!0))},Lt.paused=function(e){return arguments.length?(this._ps!==e&&((this._ps=e)?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Ct(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==We&&(this._tTime-=We)))),this):this._ps},Lt.startTime=function(e){if(arguments.length){this._start=e;var t=this.parent||this._dp;return!t||!t._sort&&this.parent||B(t,this,e-this._delay),this}return this._start},Lt.endTime=function(e){return this._start+(h(e)?this.totalDuration():this.duration())/Math.abs(this._ts)},Lt.rawTime=function(e){var t=this.parent||this._dp;return t?e&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?z(t.rawTime(e),this):this._tTime:this._tTime},Lt.globalTime=function(e){for(var t=this,r=arguments.length?e:t.rawTime();t;)r=t._start+r/(t._ts||1),t=t._dp;return r},Lt.repeat=function(e){return arguments.length?(this._repeat=e===1/0?-2:e,X(this)):-2===this._repeat?1/0:this._repeat},Lt.repeatDelay=function(e){if(arguments.length){var t=this._time;return this._rDelay=e,X(this),t?this.time(t):this}return this._rDelay},Lt.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},Lt.seek=function(e,t){return this.totalTime(mt(this,e),h(t))},Lt.restart=function(e,t){return this.play().totalTime(e?-this._delay:0,h(t))},Lt.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},Lt.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},Lt.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},Lt.resume=function(){return this.paused(!1)},Lt.reversed=function(e){return arguments.length?(!!e!==this.reversed()&&this.timeScale(-this._rts||(e?-We:0)),this):this._rts<0},Lt.invalidate=function(){return this._initted=this._act=0,this._zTime=-We,this},Lt.isActive=function(){var e,t=this.parent||this._dp,r=this._start;return!(t&&!(this._ts&&this._initted&&t.isActive()&&(e=t.rawTime(!0))>=r&&e<this.endTime(!0)-We))},Lt.eventCallback=function(e,t,r){var i=this.vars;return 1<arguments.length?(t?(i[e]=t,r&&(i[e+"Params"]=r),"onUpdate"===e&&(this._onUpdate=t)):delete i[e],this):i[e]},Lt.then=function(e){var t=this;return new Promise((function(r){function i(){var e=t.then;t.then=null,n(s)&&(s=s(t))&&(s.then||s===t)&&(t.then=e),r(s),t.then=e}var s=n(e)?e:P;t._initted&&1===t.totalProgress()&&0<=t._ts||!t._tTime&&t._ts<0?i():t._prom=i}))},Lt.kill=function(){re(this)},Bt);function Bt(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,W(this,+e.duration,1,1),this.data=e.data,ke||St.wake()}R(Ut.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-We,_prom:0,_ps:!1,_rts:1});var Nt=function(e){function a(t,i){var n;return void 0===t&&(t={}),(n=e.call(this,t)||this).labels={},n.smoothChildTiming=!!t.smoothChildTiming,n.autoRemoveChildren=!!t.autoRemoveChildren,n._sort=h(t.sortChildren),pe&&B(t.parent||pe,r(n),i),t.reversed&&n.reverse(),t.paused&&n.paused(!0),t.scrollTrigger&&N(r(n),t.scrollTrigger),n}t(a,e);var o=a.prototype;return o.to=function(e,t,r){return G(0,arguments,this),this},o.from=function(e,t,r){return G(1,arguments,this),this},o.fromTo=function(e,t,r,i){return G(2,arguments,this),this},o.set=function(e,t,r){return t.duration=0,t.parent=this,M(t).repeatDelay||(t.repeat=0),t.immediateRender=!!t.immediateRender,new qt(e,t,mt(this,r),1),this},o.call=function(e,t,r){return B(this,qt.delayedCall(0,e,t),r)},o.staggerTo=function(e,t,r,i,n,s,a){return r.duration=t,r.stagger=r.stagger||i,r.onComplete=s,r.onCompleteParams=a,r.parent=this,new qt(e,r,mt(this,n)),this},o.staggerFrom=function(e,t,r,i,n,s,a){return r.runBackwards=1,M(r).immediateRender=h(r.immediateRender),this.staggerTo(e,t,r,i,n,s,a)},o.staggerFromTo=function(e,t,r,i,n,s,a,o){return i.startAt=r,M(i).immediateRender=h(i.immediateRender),this.staggerTo(e,t,i,n,s,a,o)},o.render=function(e,t,r){var i,n,s,a,o,h,l,u,d,c,f,p,_=this._time,g=this._dirty?this.totalDuration():this._tDur,m=this._dur,v=this!==pe&&g-We<e&&0<=e?g:e<We?0:e,y=this._zTime<0!=e<0&&(this._initted||!m);if(v!==this._tTime||r||y){if(_!==this._time&&m&&(v+=this._time-_,e+=this._time-_),i=v,d=this._start,h=!(u=this._ts),y&&(m||(_=this._zTime),!e&&t||(this._zTime=e)),this._repeat){if(f=this._yoyo,o=m+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*o+e,t,r);if(i=x(v%o),v===g?(a=this._repeat,i=m):((a=~~(v/o))&&a===v/o&&(i=m,a--),m<i&&(i=m)),c=pt(this._tTime,o),!_&&this._tTime&&c!==a&&(c=a),f&&1&a&&(i=m-i,p=1),a!==c&&!this._lock){var b=f&&1&c,k=b===(f&&1&a);if(a<c&&(b=!b),_=b?0:m,this._lock=1,this.render(_||(p?0:x(a*o)),t,!m)._lock=0,this._tTime=v,!t&&this.parent&&kt(this,"onRepeat"),this.vars.repeatRefresh&&!p&&(this.invalidate()._lock=1),_&&_!==this._time||h!=!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(m=this._dur,g=this._tDur,k&&(this._lock=2,_=b?m:-1e-4,this.render(_,!0),this.vars.repeatRefresh&&!p&&this.invalidate()),this._lock=0,!this._ts&&!h)return this;he(this,p)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(l=function(e,t,r){var i;if(t<r)for(i=e._first;i&&i._start<=r;){if(!i._dur&&"isPause"===i.data&&i._start>t)return i;i=i._next}else for(i=e._last;i&&i._start>=r;){if(!i._dur&&"isPause"===i.data&&i._start<t)return i;i=i._prev}}(this,x(_),x(i)))&&(v-=i-(i=l._start)),this._tTime=v,this._time=i,this._act=!u,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=e,_=0),!_&&i&&!t&&(kt(this,"onStart"),this._tTime!==v))return this;if(_<=i&&0<=e)for(n=this._first;n;){if(s=n._next,(n._act||i>=n._start)&&n._ts&&l!==n){if(n.parent!==this)return this.render(e,t,r);if(n.render(0<n._ts?(i-n._start)*n._ts:(n._dirty?n.totalDuration():n._tDur)+(i-n._start)*n._ts,t,r),i!==this._time||!this._ts&&!h){l=0,s&&(v+=this._zTime=-We);break}}n=s}else{n=this._last;for(var w=e<0?e:i;n;){if(s=n._prev,(n._act||w<=n._end)&&n._ts&&l!==n){if(n.parent!==this)return this.render(e,t,r);if(n.render(0<n._ts?(w-n._start)*n._ts:(n._dirty?n.totalDuration():n._tDur)+(w-n._start)*n._ts,t,r),i!==this._time||!this._ts&&!h){l=0,s&&(v+=this._zTime=w?-We:We);break}}n=s}}if(l&&!t&&(this.pause(),l.render(_<=i?0:-We)._zTime=_<=i?1:-1,this._ts))return this._start=d,L(this),this.render(e,t,r);this._onUpdate&&!t&&kt(this,"onUpdate",!0),(v===g&&g>=this.totalDuration()||!v&&_)&&(d!==this._start&&Math.abs(u)===Math.abs(this._ts)||this._lock||(!e&&m||!(v===g&&0<this._ts||!v&&this._ts<0)||O(this,1),t||e<0&&!_||!v&&!_&&g||(kt(this,v===g&&0<=e?"onComplete":"onReverseComplete",!0),!this._prom||v<g&&0<this.timeScale()||this._prom())))}return this},o.add=function(e,t){var r=this;if(s(t)||(t=mt(this,t,e)),!(e instanceof Ut)){if(Ze(e))return e.forEach((function(e){return r.add(e,t)})),this;if(i(e))return this.addLabel(e,t);if(!n(e))return this;e=qt.delayedCall(0,e)}return this!==e?B(this,e,t):this},o.getChildren=function(e,t,r,i){void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===r&&(r=!0),void 0===i&&(i=-Ve);for(var n=[],s=this._first;s;)s._start>=i&&(s instanceof qt?t&&n.push(s):(r&&n.push(s),e&&n.push.apply(n,s.getChildren(!0,t,r)))),s=s._next;return n},o.getById=function(e){for(var t=this.getChildren(1,1,1),r=t.length;r--;)if(t[r].vars.id===e)return t[r]},o.remove=function(e){return i(e)?this.removeLabel(e):n(e)?this.killTweensOf(e):(A(this,e),e===this._recent&&(this._recent=this._last),F(this))},o.totalTime=function(t,r){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=x(St.time-(0<this._ts?t/this._ts:(this.totalDuration()-t)/-this._ts))),e.prototype.totalTime.call(this,t,r),this._forcing=0,this):this._tTime},o.addLabel=function(e,t){return this.labels[e]=mt(this,t),this},o.removeLabel=function(e){return delete this.labels[e],this},o.addPause=function(e,t,r){var i=qt.delayedCall(0,t||_,r);return i.data="isPause",this._hasPause=1,B(this,i,mt(this,e))},o.removePause=function(e){var t=this._first;for(e=mt(this,e);t;)t._start===e&&"isPause"===t.data&&O(t),t=t._next},o.killTweensOf=function(e,t,r){for(var i=this.getTweensOf(e,r),n=i.length;n--;)Wt!==i[n]&&i[n].kill(e,t);return this},o.getTweensOf=function(e,t){for(var r,i=[],n=xt(e),a=this._first,o=s(t);a;)a instanceof qt?b(a._targets,n)&&(o?(!Wt||a._initted&&a._ts)&&a.globalTime(0)<=t&&a.globalTime(a.totalDuration())>t:!t||a.isActive())&&i.push(a):(r=a.getTweensOf(n,t)).length&&i.push.apply(i,r),a=a._next;return i},o.tweenTo=function(e,t){t=t||{};var r,i=this,n=mt(i,e),s=t.startAt,a=t.onStart,o=t.onStartParams,h=t.immediateRender,l=qt.to(i,R({ease:t.ease||"none",lazy:!1,immediateRender:!1,time:n,overwrite:"auto",duration:t.duration||Math.abs((n-(s&&"time"in s?s.time:i._time))/i.timeScale())||We,onStart:function(){if(i.pause(),!r){var e=t.duration||Math.abs((n-(s&&"time"in s?s.time:i._time))/i.timeScale());l._dur!==e&&W(l,e,0,1).render(l._time,!0,!0),r=1}a&&a.apply(l,o||[])}},t));return h?l.render(0):l},o.tweenFromTo=function(e,t,r){return this.tweenTo(t,R({startAt:{time:mt(this,e)}},r))},o.recent=function(){return this._recent},o.nextLabel=function(e){return void 0===e&&(e=this._time),te(this,mt(this,e))},o.previousLabel=function(e){return void 0===e&&(e=this._time),te(this,mt(this,e),1)},o.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.previousLabel(this._time+We)},o.shiftChildren=function(e,t,r){void 0===r&&(r=0);for(var i,n=this._first,s=this.labels;n;)n._start>=r&&(n._start+=e,n._end+=e),n=n._next;if(t)for(i in s)s[i]>=r&&(s[i]+=e);return F(this)},o.invalidate=function(){var t=this._first;for(this._lock=0;t;)t.invalidate(),t=t._next;return e.prototype.invalidate.call(this)},o.clear=function(e){void 0===e&&(e=!0);for(var t,r=this._first;r;)t=r._next,this.remove(r),r=t;return this._dp&&(this._time=this._tTime=this._pTime=0),e&&(this.labels={}),F(this)},o.totalDuration=function(e){var t,r,i,n=0,s=this,a=s._last,o=Ve;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-e:e));if(s._dirty){for(i=s.parent;a;)t=a._prev,a._dirty&&a.totalDuration(),o<(r=a._start)&&s._sort&&a._ts&&!s._lock?(s._lock=1,B(s,a,r-a._delay,1)._lock=0):o=r,r<0&&a._ts&&(n-=r,(!i&&!s._dp||i&&i.smoothChildTiming)&&(s._start+=r/s._ts,s._time-=r,s._tTime-=r),s.shiftChildren(-r,!1,-1/0),o=0),a._end>n&&a._ts&&(n=a._end),a=t;W(s,s===pe&&s._time>n?s._time:n,1,1),s._dirty=0}return s._tDur},a.updateRoot=function(e){if(pe._ts&&(w(pe,z(e,pe)),xe=St.frame),St.frame>=ut){ut+=Be.autoSleep||120;var t=pe._first;if((!t||!t._ts)&&Be.autoSleep&&St._listeners.length<2){for(;t&&!t._ts;)t=t._next;t||St.sleep()}}},a}(Ut);function Vt(e,t,r,s,a,h){var l,u,d,c;if(ht[e]&&!1!==(l=new ht[e]).init(a,l.rawVars?t[e]:function(e,t,r,s,a){if(n(e)&&(e=Yt(e,a,t,r,s)),!o(e)||e.style&&e.nodeType||Ze(e)||Qe(e))return i(e)?Yt(e,a,t,r,s):e;var h,l={};for(h in e)l[h]=Yt(e[h],a,t,r,s);return l}(t[e],s,a,h,r),r,s,h)&&(r._pt=u=new hr(r._pt,a,e,0,1,l.render,l,0,l.priority),r!==be))for(d=r._ptLookup[r._targets.indexOf(a)],c=l._props.length;c--;)d[l._props[c]]=u;return l}R(Nt.prototype,{_lock:0,_hasPause:0,_forcing:0});var Wt,Xt=function(e,t,r,s,a,o,h,l,u){n(s)&&(s=s(a||0,e,o));var d,f=e[t],p="get"!==r?r:n(f)?u?e[t.indexOf("set")||!n(e["get"+t.substr(3)])?t:"get"+t.substr(3)](u):e[t]():f,_=n(f)?u?Jt:$t:Kt;if(i(s)&&(~s.indexOf("random(")&&(s=ee(s)),"="===s.charAt(1)&&(!(d=parseFloat(p)+parseFloat(s.substr(2))*("-"===s.charAt(0)?-1:1)+(j(p)||0))&&0!==d||(s=d))),p!==s)return isNaN(p*s)||""===s?(f||t in e||c(t,s),function(e,t,r,i,n,s,a){var o,h,l,u,d,c,f,p,_=new hr(this._pt,e,t,0,1,ir,null,n),g=0,m=0;for(_.b=r,_.e=i,r+="",(f=~(i+="").indexOf("random("))&&(i=ee(i)),s&&(s(p=[r,i],e,t),r=p[0],i=p[1]),h=r.match(et)||[];o=et.exec(i);)u=o[0],d=i.substring(g,o.index),l?l=(l+1)%5:"rgba("===d.substr(-5)&&(l=1),u!==h[m++]&&(c=parseFloat(h[m-1])||0,_._pt={_next:_._pt,p:d||1===m?d:",",s:c,c:"="===u.charAt(1)?parseFloat(u.substr(2))*("-"===u.charAt(0)?-1:1):parseFloat(u)-c,m:l&&l<4?Math.round:0},g=et.lastIndex);return _.c=g<i.length?i.substring(g,i.length):"",_.fp=a,(tt.test(i)||f)&&(_.e=0),this._pt=_}.call(this,e,t,p,s,_,l||Be.stringFilter,u)):(d=new hr(this._pt,e,t,+p||0,s-(p||0),"boolean"==typeof f?rr:tr,0,_),u&&(d.fp=u),h&&d.modifier(h,this,e),this._pt=d)},Gt=function e(t,r){var i,n,s,a,o,l,u,d,c,f,p,_,v,y=t.vars,x=y.ease,b=y.startAt,w=y.immediateRender,T=y.lazy,P=y.onUpdate,S=y.onUpdateParams,C=y.callbackScope,M=y.runBackwards,A=y.yoyoEase,F=y.keyframes,D=y.autoRevert,z=t._dur,L=t._startAt,I=t._targets,U=t.parent,B=U&&"nested"===U.data?U.parent._targets:I,N="auto"===t._overwrite&&!fe,V=t.timeline;if(!V||F&&x||(x="none"),t._ease=Ft(x,Ne.ease),t._yEase=A?Ot(Ft(!0===A?x:A,Ne.ease)):0,A&&t._yoyo&&!t._repeat&&(A=t._yEase,t._yEase=t._ease,t._ease=A),t._from=!V&&!!y.runBackwards,!V){if(_=(d=I[0]?m(I[0]).harness:0)&&y[d.prop],i=E(y,st),L&&L.render(-1,!0).kill(),b)if(O(t._startAt=qt.set(I,R({data:"isStart",overwrite:!1,parent:U,immediateRender:!0,lazy:h(T),startAt:null,delay:0,onUpdate:P,onUpdateParams:S,callbackScope:C,stagger:0},b))),r<0&&!w&&!D&&t._startAt.render(-1,!0),w){if(0<r&&!D&&(t._startAt=0),z&&r<=0)return void(r&&(t._zTime=r))}else!1===D&&(t._startAt=0);else if(M&&z)if(L)D||(t._startAt=0);else if(r&&(w=!1),s=R({overwrite:!1,data:"isFromStart",lazy:w&&h(T),immediateRender:w,stagger:0,parent:U},i),_&&(s[d.prop]=_),O(t._startAt=qt.set(I,s)),r<0&&t._startAt.render(-1,!0),w){if(!r)return}else e(t._startAt,We);for(t._pt=0,T=z&&h(T)||T&&!z,n=0;n<I.length;n++){if(u=(o=I[n])._gsap||g(I)[n]._gsap,t._ptLookup[n]=f={},ot[u.id]&&at.length&&k(),p=B===I?n:B.indexOf(o),d&&!1!==(c=new d).init(o,_||i,t,p,B)&&(t._pt=a=new hr(t._pt,o,c.name,0,1,c.render,c,0,c.priority),c._props.forEach((function(e){f[e]=a})),c.priority&&(l=1)),!d||_)for(s in i)ht[s]&&(c=Vt(s,i,t,p,o,B))?c.priority&&(l=1):f[s]=a=Xt.call(t,o,s,"get",i[s],p,B,0,y.stringFilter);t._op&&t._op[n]&&t.kill(o,t._op[n]),N&&t._pt&&(Wt=t,pe.killTweensOf(o,f,t.globalTime(0)),v=!t.parent,Wt=0),t._pt&&T&&(ot[u.id]=1)}l&&or(t),t._onInit&&t._onInit(t)}t._onUpdate=P,t._initted=(!t._op||t._pt)&&!v},Yt=function(e,t,r,s,a){return n(e)?e.call(t,r,s,a):i(e)&&~e.indexOf("random(")?ee(e):e},jt=ct+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",Ht=(jt+",id,stagger,delay,duration,paused,scrollTrigger").split(","),qt=function(e){function n(t,i,n,a){var l;"number"==typeof i&&(n.duration=i,i=n,n=null);var d,c,p,m,v,y,b,k,w=(l=e.call(this,a?i:M(i))||this).vars,T=w.duration,P=w.delay,S=w.immediateRender,C=w.stagger,E=w.overwrite,A=w.keyframes,O=w.defaults,F=w.scrollTrigger,D=w.yoyoEase,z=i.parent||pe,L=(Ze(t)||Qe(t)?s(t[0]):"length"in i)?[t]:xt(t);if(l._targets=L.length?g(L):f("GSAP target "+t+" not found. https://greensock.com",!Be.nullTargetWarn)||[],l._ptLookup=[],l._overwrite=E,A||C||u(T)||u(P)){if(i=l.vars,(d=l.timeline=new Nt({data:"nested",defaults:O||{}})).kill(),d.parent=d._dp=r(l),d._start=0,A)R(d.vars.defaults,{ease:"none"}),C?L.forEach((function(e,t){return A.forEach((function(r,i){return d.to(e,r,i?">":t*C)}))})):A.forEach((function(e){return d.to(L,e,">")}));else{if(m=L.length,b=C?Q(C):_,o(C))for(v in C)~jt.indexOf(v)&&((k=k||{})[v]=C[v]);for(c=0;c<m;c++){for(v in p={},i)Ht.indexOf(v)<0&&(p[v]=i[v]);p.stagger=0,D&&(p.yoyoEase=D),k&&ft(p,k),y=L[c],p.duration=+Yt(T,r(l),c,y,L),p.delay=(+Yt(P,r(l),c,y,L)||0)-l._delay,!C&&1===m&&p.delay&&(l._delay=P=p.delay,l._start+=P,p.delay=0),d.to(y,p,b(c,y,L))}d.duration()?T=P=0:l.timeline=0}T||l.duration(T=d.duration())}else l.timeline=0;return!0!==E||fe||(Wt=r(l),pe.killTweensOf(L),Wt=0),B(z,r(l),n),i.reversed&&l.reverse(),i.paused&&l.paused(!0),(S||!T&&!A&&l._start===x(z._time)&&h(S)&&function e(t){return!t||t._ts&&e(t.parent)}(r(l))&&"nested"!==z.data)&&(l._tTime=-We,l.render(Math.max(0,-P))),F&&N(r(l),F),l}t(n,e);var a=n.prototype;return a.render=function(e,t,r){var i,n,s,a,o,h,l,u,d,c=this._time,f=this._tDur,p=this._dur,_=f-We<e&&0<=e?f:e<We?0:e;if(p){if(_!==this._tTime||!e||r||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=e<0){if(i=_,u=this.timeline,this._repeat){if(a=p+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*a+e,t,r);if(i=x(_%a),_===f?(s=this._repeat,i=p):((s=~~(_/a))&&s===_/a&&(i=p,s--),p<i&&(i=p)),(h=this._yoyo&&1&s)&&(d=this._yEase,i=p-i),o=pt(this._tTime,a),i===c&&!r&&this._initted)return this;s!==o&&(u&&this._yEase&&he(u,h),!this.vars.repeatRefresh||h||this._lock||(this._lock=r=1,this.render(x(a*s),!0).invalidate()._lock=0))}if(!this._initted){if(V(this,e<0?e:i,r,t))return this._tTime=0,this;if(p!==this._dur)return this.render(e,t,r)}if(this._tTime=_,this._time=i,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=l=(d||this._ease)(i/p),this._from&&(this.ratio=l=1-l),i&&!c&&!t&&(kt(this,"onStart"),this._tTime!==_))return this;for(n=this._pt;n;)n.r(l,n.d),n=n._next;u&&u.render(e<0?e:!i&&h?-We:u._dur*l,t,r)||this._startAt&&(this._zTime=e),this._onUpdate&&!t&&(e<0&&this._startAt&&this._startAt.render(e,!0,r),kt(this,"onUpdate")),this._repeat&&s!==o&&this.vars.onRepeat&&!t&&this.parent&&kt(this,"onRepeat"),_!==this._tDur&&_||this._tTime!==_||(e<0&&this._startAt&&!this._onUpdate&&this._startAt.render(e,!0,!0),!e&&p||!(_===this._tDur&&0<this._ts||!_&&this._ts<0)||O(this,1),t||e<0&&!c||!_&&!c||(kt(this,_===f?"onComplete":"onReverseComplete",!0),!this._prom||_<f&&0<this.timeScale()||this._prom()))}}else!function(e,t,r,i){var n,s,a,o=e.ratio,h=t<0||!t&&(!e._start&&function e(t){var r=t.parent;return r&&r._ts&&r._initted&&!r._lock&&(r.rawTime()<0||e(r))}(e)&&(e._initted||!_t(e))||(e._ts<0||e._dp._ts<0)&&!_t(e))?0:1,l=e._rDelay,u=0;if(l&&e._repeat&&(u=vt(0,e._tDur,t),s=pt(u,l),a=pt(e._tTime,l),e._yoyo&&1&s&&(h=1-h),s!==a&&(o=1-h,e.vars.repeatRefresh&&e._initted&&e.invalidate())),h!==o||i||e._zTime===We||!t&&e._zTime){if(!e._initted&&V(e,t,i,r))return;for(a=e._zTime,e._zTime=t||(r?We:0),r=r||t&&!a,e.ratio=h,e._from&&(h=1-h),e._time=0,e._tTime=u,n=e._pt;n;)n.r(h,n.d),n=n._next;e._startAt&&t<0&&e._startAt.render(t,!0,!0),e._onUpdate&&!r&&kt(e,"onUpdate"),u&&e._repeat&&!r&&e.parent&&kt(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===h&&(h&&O(e,1),r||(kt(e,h?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)}(this,e,t,r);return this},a.targets=function(){return this._targets},a.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),e.prototype.invalidate.call(this)},a.kill=function(e,t){if(void 0===t&&(t="all"),!(e||t&&"all"!==t))return this._lazy=this._pt=0,this.parent?re(this):this;if(this.timeline){var r=this.timeline.totalDuration();return this.timeline.killTweensOf(e,t,Wt&&!0!==Wt.vars.overwrite)._first||re(this),this.parent&&r!==this.timeline.totalDuration()&&W(this,this._dur*this.timeline._tDur/r,0,1),this}var n,s,a,o,h,l,u,d=this._targets,c=e?xt(e):d,f=this._ptLookup,p=this._pt;if((!t||"all"===t)&&function(e,t){for(var r=e.length,i=r===t.length;i&&r--&&e[r]===t[r];);return r<0}(d,c))return"all"===t&&(this._pt=0),re(this);for(n=this._op=this._op||[],"all"!==t&&(i(t)&&(h={},y(t,(function(e){return h[e]=1})),t=h),t=function(e,t){var r,i,n,s,a=e[0]?m(e[0]).harness:0,o=a&&a.aliases;if(!o)return t;for(i in r=ft({},t),o)if(i in r)for(n=(s=o[i].split(",")).length;n--;)r[s[n]]=r[i];return r}(d,t)),u=d.length;u--;)if(~c.indexOf(d[u]))for(h in s=f[u],"all"===t?(n[u]=t,o=s,a={}):(a=n[u]=n[u]||{},o=t),o)(l=s&&s[h])&&("kill"in l.d&&!0!==l.d.kill(h)||A(this,l,"_pt"),delete s[h]),"all"!==a&&(a[h]=1);return this._initted&&!this._pt&&p&&re(this),this},n.to=function(e,t,r){return new n(e,t,r)},n.from=function(e,t){return G(1,arguments)},n.delayedCall=function(e,t,r,i){return new n(t,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:e,onComplete:t,onReverseComplete:t,onCompleteParams:r,onReverseCompleteParams:r,callbackScope:i})},n.fromTo=function(e,t,r){return G(2,arguments)},n.set=function(e,t){return t.duration=0,t.repeatDelay||(t.repeat=0),new n(e,t)},n.killTweensOf=function(e,t,r){return pe.killTweensOf(e,t,r)},n}(Ut);function Qt(e,t,r){return e.setAttribute(t,r)}function Zt(e,t,r,i){i.mSet(e,t,i.m.call(i.tween,r,i.mt),i)}R(qt.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),y("staggerTo,staggerFrom,staggerFromTo",(function(e){qt[e]=function(){var t=new Nt,r=yt.call(arguments,0);return r.splice("staggerFromTo"===e?5:4,0,0),t[e].apply(t,r)}}));var Kt=function(e,t,r){return e[t]=r},$t=function(e,t,r){return e[t](r)},Jt=function(e,t,r,i){return e[t](i.fp,r)},er=function(e,t){return n(e[t])?$t:a(e[t])&&e.setAttribute?Qt:Kt},tr=function(e,t){return t.set(t.t,t.p,Math.round(1e6*(t.s+t.c*e))/1e6,t)},rr=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},ir=function(e,t){var r=t._pt,i="";if(!e&&t.b)i=t.b;else if(1===e&&t.e)i=t.e;else{for(;r;)i=r.p+(r.m?r.m(r.s+r.c*e):Math.round(1e4*(r.s+r.c*e))/1e4)+i,r=r._next;i+=t.c}t.set(t.t,t.p,i,t)},nr=function(e,t){for(var r=t._pt;r;)r.r(e,r.d),r=r._next},sr=function(e,t,r,i){for(var n,s=this._pt;s;)n=s._next,s.p===i&&s.modifier(e,t,r),s=n},ar=function(e){for(var t,r,i=this._pt;i;)r=i._next,i.p===e&&!i.op||i.op===e?A(this,i,"_pt"):i.dep||(t=1),i=r;return!t},or=function(e){for(var t,r,i,n,s=e._pt;s;){for(t=s._next,r=i;r&&r.pr>s.pr;)r=r._next;(s._prev=r?r._prev:n)?s._prev._next=s:i=s,(s._next=r)?r._prev=s:n=s,s=t}e._pt=i},hr=(lr.prototype.modifier=function(e,t,r){this.mSet=this.mSet||this.set,this.set=Zt,this.m=e,this.mt=r,this.tween=t},lr);function lr(e,t,r,i,n,s,a,o,h){this.t=t,this.s=i,this.c=n,this.p=r,this.r=s||tr,this.d=a||this,this.set=o||Kt,this.pr=h||0,(this._next=e)&&(e._prev=this)}y(ct+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(e){return st[e]=1})),nt.TweenMax=nt.TweenLite=qt,nt.TimelineLite=nt.TimelineMax=Nt,pe=new Nt({sortChildren:!1,defaults:Ne,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),Be.stringFilter=oe;var ur={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach((function(e){return function(e){var t=(e=!e.name&&e.default||e).name,r=n(e),i=t&&!r&&e.init?function(){this._props=[]}:e,s={init:_,render:nr,add:Xt,kill:ar,modifier:sr,rawVars:0},a={targetTest:0,get:0,getSetter:er,aliases:{},register:0};if(Ct(),e!==i){if(ht[t])return;R(i,R(E(e,s),a)),ft(i.prototype,ft(s,E(e,a))),ht[i.prop=t]=i,e.targetTest&&(dt.push(i),st[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}p(t,i),e.register&&e.register(fr,i,hr)}(e)}))},timeline:function(e){return new Nt(e)},getTweensOf:function(e,t){return pe.getTweensOf(e,t)},getProperty:function(e,t,r,n){i(e)&&(e=xt(e)[0]);var s=m(e||{}).get,a=r?P:T;return"native"===r&&(r=""),e?t?a((ht[t]&&ht[t].get||s)(e,t,r,n)):function(t,r,i){return a((ht[t]&&ht[t].get||s)(e,t,r,i))}:e},quickSetter:function(e,t,r){if(1<(e=xt(e)).length){var i=e.map((function(e){return fr.quickSetter(e,t,r)})),n=i.length;return function(e){for(var t=n;t--;)i[t](e)}}e=e[0]||{};var s=ht[t],a=m(e),o=a.harness&&(a.harness.aliases||{})[t]||t,h=s?function(t){var i=new s;be._pt=0,i.init(e,r?t+r:t,be,0,[e]),i.render(1,i),be._pt&&nr(1,be)}:a.set(e,o);return s?h:function(t){return h(e,o,r?t+r:t,a,1)}},isTweening:function(e){return 0<pe.getTweensOf(e,!0).length},defaults:function(e){return e&&e.ease&&(e.ease=Ft(e.ease,Ne.ease)),C(Ne,e||{})},config:function(e){return C(Be,e||{})},registerEffect:function(e){var t=e.name,r=e.effect,i=e.plugins,n=e.defaults,s=e.extendTimeline;(i||"").split(",").forEach((function(e){return e&&!ht[e]&&!nt[e]&&f(t+" effect requires "+e+" plugin.")})),lt[t]=function(e,t,i){return r(xt(e),R(t||{},n),i)},s&&(Nt.prototype[t]=function(e,r,i){return this.add(lt[t](e,o(r)?r:(i=r)&&{},this),i)})},registerEase:function(e,t){Et[e]=Ft(t)},parseEase:function(e,t){return arguments.length?Ft(e,t):Et},getById:function(e){return pe.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var r,i,n=new Nt(e);for(n.smoothChildTiming=h(e.smoothChildTiming),pe.remove(n),n._dp=0,n._time=n._tTime=pe._time,r=pe._first;r;)i=r._next,!t&&!r._dur&&r instanceof qt&&r.vars.onComplete===r._targets[0]||B(n,r,r._start-r._delay),r=i;return B(pe,n,0),n},utils:{wrap:function e(t,r,i){var n=r-t;return Ze(t)?J(t,e(0,t.length),r):Y(i,(function(e){return(n+(e-t)%n)%n+t}))},wrapYoyo:function e(t,r,i){var n=r-t,s=2*n;return Ze(t)?J(t,e(0,t.length-1),r):Y(i,(function(e){return t+(n<(e=(s+(e-t)%s)%s||0)?s-e:e)}))},distribute:Q,random:$,snap:K,normalize:function(e,t,r){return bt(e,t,0,1,r)},getUnit:j,clamp:function(e,t,r){return Y(r,(function(r){return vt(e,t,r)}))},splitColor:ne,toArray:xt,selector:function(e){return e=xt(e)[0]||f("Invalid scope")||{},function(t){var r=e.current||e.nativeElement||e;return xt(t,r.querySelectorAll?r:r===e?f("Invalid scope")||me.createElement("div"):e)}},mapRange:bt,pipe:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return t.reduce((function(e,t){return t(e)}),e)}},unitize:function(e,t){return function(r){return e(parseFloat(r))+(t||j(r))}},interpolate:function e(t,r,n,s){var a=isNaN(t+r)?0:function(e){return(1-e)*t+e*r};if(!a){var o,h,l,u,d,c=i(t),f={};if(!0===n&&(s=1)&&(n=null),c)t={p:t},r={p:r};else if(Ze(t)&&!Ze(r)){for(l=[],u=t.length,d=u-2,h=1;h<u;h++)l.push(e(t[h-1],t[h]));u--,a=function(e){e*=u;var t=Math.min(d,~~e);return l[t](e-t)},n=r}else s||(t=ft(Ze(t)?[]:{},t));if(!l){for(o in r)Xt.call(f,t,o,"get",r[o]);a=function(e){return nr(e,f)||(c?t.p:t)}}}return Y(n,a)},shuffle:q},install:d,effects:lt,ticker:St,updateRoot:Nt.updateRoot,plugins:ht,globalTimeline:pe,core:{PropTween:hr,globals:p,Tween:qt,Timeline:Nt,Animation:Ut,getCache:m,_removeLinkedListItem:A,suppressOverwrites:function(e){return fe=e}}};function dr(e,t){for(var r=e._pt;r&&r.p!==t&&r.op!==t&&r.fp!==t;)r=r._next;return r}function cr(e,t){return{name:e,rawVars:1,init:function(e,r,n){n._onInit=function(e){var n,s;if(i(r)&&(n={},y(r,(function(e){return n[e]=1})),r=n),t){for(s in n={},r)n[s]=t(r[s]);r=n}!function(e,t){var r,i,n,s=e._targets;for(r in t)for(i=s.length;i--;)(n=(n=e._ptLookup[i][r])&&n.d)&&(n._pt&&(n=dr(n,r)),n&&n.modifier&&n.modifier(t[r],e,s[i],r))}(e,r)}}}}y("to,from,fromTo,delayedCall,set,killTweensOf",(function(e){return ur[e]=qt[e]})),St.add(Nt.updateRoot),be=ur.to({},{duration:0});var fr=ur.registerPlugin({name:"attr",init:function(e,t,r,i,n){var s,a;for(s in t)(a=this.add(e,"setAttribute",(e.getAttribute(s)||0)+"",t[s],i,n,0,0,s))&&(a.op=s),this._props.push(s)}},{name:"endArray",init:function(e,t){for(var r=t.length;r--;)this.add(e,r,e[r]||0,t[r])}},cr("roundProps",Z),cr("modifiers"),cr("snap",K))||ur;function pr(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)}function _r(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)}function gr(e,t){return t.set(t.t,t.p,e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)}function mr(e,t){var r=t.s+t.c*e;t.set(t.t,t.p,~~(r+(r<0?-.5:.5))+t.u,t)}function vr(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)}function yr(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)}function xr(e,t,r){return e.style[t]=r}function br(e,t,r){return e.style.setProperty(t,r)}function kr(e,t,r){return e._gsap[t]=r}function wr(e,t,r){return e._gsap.scaleX=e._gsap.scaleY=r}function Tr(e,t,r,i,n){var s=e._gsap;s.scaleX=s.scaleY=r,s.renderTransform(n,s)}function Pr(e,t,r,i,n){var s=e._gsap;s[t]=r,s.renderTransform(n,s)}function Rr(e,t){var r=Qr.createElementNS?Qr.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Qr.createElement(e);return r.style?r:Qr.createElement(e)}function Sr(e,t,r){var i=getComputedStyle(e);return i[t]||i.getPropertyValue(t.replace(wi,"-$1").toLowerCase())||i.getPropertyValue(t)||!r&&Sr(e,Mi(t)||t,1)||""}function Cr(){"undefined"!=typeof window&&window.document&&(qr=window,Qr=qr.document,Zr=Qr.documentElement,$r=Rr("div")||{style:{}},Rr("div"),Si=Mi(Si),Ci=Si+"Origin",$r.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",ei=!!Mi("perspective"),Kr=1)}function Er(e){var t,r=Rr("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,n=this.nextSibling,s=this.style.cssText;if(Zr.appendChild(r),r.appendChild(this),this.style.display="block",e)try{t=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=Er}catch(e){}else this._gsapBBox&&(t=this._gsapBBox());return i&&(n?i.insertBefore(this,n):i.appendChild(this)),Zr.removeChild(r),this.style.cssText=s,t}function Mr(e,t){for(var r=t.length;r--;)if(e.hasAttribute(t[r]))return e.getAttribute(t[r])}function Ar(e){var t;try{t=e.getBBox()}catch(r){t=Er.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===Er||(t=Er.call(e,!0)),!t||t.width||t.x||t.y?t:{x:+Mr(e,["x","cx","x1"])||0,y:+Mr(e,["y","cy","y1"])||0,width:0,height:0}}function Or(e){return!(!e.getCTM||e.parentNode&&!e.ownerSVGElement||!Ar(e))}function Fr(e,t){if(t){var r=e.style;t in yi&&t!==Ci&&(t=Si),r.removeProperty?("ms"!==t.substr(0,2)&&"webkit"!==t.substr(0,6)||(t="-"+t),r.removeProperty(t.replace(wi,"-$1").toLowerCase())):r.removeAttribute(t)}}function Dr(e,t,r,i,n,s){var a=new hr(e._pt,t,r,0,1,s?yr:vr);return(e._pt=a).b=i,a.e=n,e._props.push(r),a}function zr(e,t,r,i){var n,s,a,o,h=parseFloat(r)||0,l=(r+"").trim().substr((h+"").length)||"px",u=$r.style,d=Ti.test(t),c="svg"===e.tagName.toLowerCase(),f=(c?"client":"offset")+(d?"Width":"Height"),p="px"===i,_="%"===i;return i===l||!h||Ai[i]||Ai[l]?h:("px"===l||p||(h=zr(e,t,r,"px")),o=e.getCTM&&Or(e),!_&&"%"!==l||!yi[t]&&!~t.indexOf("adius")?(u[d?"width":"height"]=100+(p?l:i),s=~t.indexOf("adius")||"em"===i&&e.appendChild&&!c?e:e.parentNode,o&&(s=(e.ownerSVGElement||{}).parentNode),s&&s!==Qr&&s.appendChild||(s=Qr.body),(a=s._gsap)&&_&&a.width&&d&&a.time===St.time?x(h/a.width*100):(!_&&"%"!==l||(u.position=Sr(e,"position")),s===e&&(u.position="static"),s.appendChild($r),n=$r[f],s.removeChild($r),u.position="absolute",d&&_&&((a=m(s)).time=St.time,a.width=s[f]),x(p?n*h/100:n&&h?100/n*h:0))):(n=o?e.getBBox()[d?"width":"height"]:e[f],x(_?h/n*100:h/100*n)))}function Lr(e,t,r,i){var n;return Kr||Cr(),t in Ri&&"transform"!==t&&~(t=Ri[t]).indexOf(",")&&(t=t.split(",")[0]),yi[t]&&"transform"!==t?(n=Li(e,i),n="transformOrigin"!==t?n[t]:n.svg?n.origin:Ii(Sr(e,Ci))+" "+n.zOrigin+"px"):(n=e.style[t])&&"auto"!==n&&!i&&!~(n+"").indexOf("calc(")||(n=Fi[t]&&Fi[t](e,t,r)||Sr(e,t)||v(e,t)||("opacity"===t?1:0)),r&&!~(n+"").trim().indexOf(" ")?zr(e,t,n,r)+r:n}function Ir(e,t,r,i){if(!r||"none"===r){var n=Mi(t,e,1),s=n&&Sr(e,n,1);s&&s!==r?(t=n,r=s):"borderColor"===t&&(r=Sr(e,"borderTopColor"))}var a,o,h,l,u,d,c,f,p,_,g,m,v=new hr(this._pt,e.style,t,0,1,ir),y=0,x=0;if(v.b=r,v.e=i,r+="","auto"==(i+="")&&(e.style[t]=i,i=Sr(e,t)||i,e.style[t]=r),oe(a=[r,i]),i=a[1],h=(r=a[0]).match(Je)||[],(i.match(Je)||[]).length){for(;o=Je.exec(i);)c=o[0],p=i.substring(y,o.index),u?u=(u+1)%5:"rgba("!==p.substr(-5)&&"hsla("!==p.substr(-5)||(u=1),c!==(d=h[x++]||"")&&(l=parseFloat(d)||0,g=d.substr((l+"").length),(m="="===c.charAt(1)?+(c.charAt(0)+"1"):0)&&(c=c.substr(2)),f=parseFloat(c),_=c.substr((f+"").length),y=Je.lastIndex-_.length,_||(_=_||Be.units[t]||g,y===i.length&&(i+=_,v.e+=_)),g!==_&&(l=zr(e,t,d,_)||0),v._pt={_next:v._pt,p:p||1===x?p:",",s:l,c:m?m*f:f-l,m:u&&u<4||"zIndex"===t?Math.round:0});v.c=y<i.length?i.substring(y,i.length):""}else v.r="display"===t&&"none"===i?yr:vr;return tt.test(i)&&(v.e=0),this._pt=v}function Ur(e){var t=e.split(" "),r=t[0],i=t[1]||"50%";return"top"!==r&&"bottom"!==r&&"left"!==i&&"right"!==i||(e=r,r=i,i=e),t[0]=Oi[r]||r,t[1]=Oi[i]||i,t.join(" ")}function Br(e,t){if(t.tween&&t.tween._time===t.tween._dur){var r,i,n,s=t.t,a=s.style,o=t.u,h=s._gsap;if("all"===o||!0===o)a.cssText="",i=1;else for(n=(o=o.split(",")).length;-1<--n;)r=o[n],yi[r]&&(i=1,r="transformOrigin"===r?Ci:Si),Fr(s,r);i&&(Fr(s,Si),h&&(h.svg&&s.removeAttribute("transform"),Li(s,1),h.uncache=1))}}function Nr(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e}function Vr(e){var t=Sr(e,Si);return Nr(t)?Di:t.substr(7).match($e).map(x)}function Wr(e,t){var r,i,n,s,a=e._gsap||m(e),o=e.style,h=Vr(e);return a.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(h=[(n=e.transform.baseVal.consolidate().matrix).a,n.b,n.c,n.d,n.e,n.f]).join(",")?Di:h:(h!==Di||e.offsetParent||e===Zr||a.svg||(n=o.display,o.display="block",(r=e.parentNode)&&e.offsetParent||(s=1,i=e.nextSibling,Zr.appendChild(e)),h=Vr(e),n?o.display=n:Fr(e,"display"),s&&(i?r.insertBefore(e,i):r?r.appendChild(e):Zr.removeChild(e))),t&&6<h.length?[h[0],h[1],h[4],h[5],h[12],h[13]]:h)}function Xr(e,t,r,i,n,s){var a,o,h,l=e._gsap,u=n||Wr(e,!0),d=l.xOrigin||0,c=l.yOrigin||0,f=l.xOffset||0,p=l.yOffset||0,_=u[0],g=u[1],m=u[2],v=u[3],y=u[4],x=u[5],b=t.split(" "),k=parseFloat(b[0])||0,w=parseFloat(b[1])||0;r?u!==Di&&(o=_*v-g*m)&&(h=k*(-g/o)+w*(_/o)-(_*x-g*y)/o,k=k*(v/o)+w*(-m/o)+(m*x-v*y)/o,w=h):(k=(a=Ar(e)).x+(~b[0].indexOf("%")?k/100*a.width:k),w=a.y+(~(b[1]||b[0]).indexOf("%")?w/100*a.height:w)),i||!1!==i&&l.smooth?(y=k-d,x=w-c,l.xOffset=f+(y*_+x*m)-y,l.yOffset=p+(y*g+x*v)-x):l.xOffset=l.yOffset=0,l.xOrigin=k,l.yOrigin=w,l.smooth=!!i,l.origin=t,l.originIsAbsolute=!!r,e.style[Ci]="0px 0px",s&&(Dr(s,l,"xOrigin",d,k),Dr(s,l,"yOrigin",c,w),Dr(s,l,"xOffset",f,l.xOffset),Dr(s,l,"yOffset",p,l.yOffset)),e.setAttribute("data-svg-origin",k+" "+w)}function Gr(e,t,r){var i=j(t);return x(parseFloat(t)+parseFloat(zr(e,"x",r+"px",i)))+i}function Yr(e,t,r,n,s,a){var o,h,l=360,u=i(s),d=parseFloat(s)*(u&&~s.indexOf("rad")?xi:1),c=a?d*a:d-n,f=n+c+"deg";return u&&("short"===(o=s.split("_")[1])&&(c%=l)!=c%180&&(c+=c<0?l:-l),"cw"===o&&c<0?c=(c+36e9)%l-~~(c/l)*l:"ccw"===o&&0<c&&(c=(c-36e9)%l-~~(c/l)*l)),e._pt=h=new hr(e._pt,t,r,n,c,_r),h.e=f,h.u="deg",e._props.push(r),h}function jr(e,t){for(var r in t)e[r]=t[r];return e}function Hr(e,t,r){var i,n,s,a,o,h,l,u=jr({},r._gsap),d=r.style;for(n in u.svg?(s=r.getAttribute("transform"),r.setAttribute("transform",""),d[Si]=t,i=Li(r,1),Fr(r,Si),r.setAttribute("transform",s)):(s=getComputedStyle(r)[Si],d[Si]=t,i=Li(r,1),d[Si]=s),yi)(s=u[n])!==(a=i[n])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(n)<0&&(o=j(s)!==(l=j(a))?zr(r,n,s,l):parseFloat(s),h=parseFloat(a),e._pt=new hr(e._pt,i,n,o,h-o,pr),e._pt.u=l||0,e._props.push(n));jr(i,u)}qt.version=Nt.version=fr.version="3.7.1",ye=1,l()&&Ct();var qr,Qr,Zr,Kr,$r,Jr,ei,ti=Et.Power0,ri=Et.Power1,ii=Et.Power2,ni=Et.Power3,si=Et.Power4,ai=Et.Linear,oi=Et.Quad,hi=Et.Cubic,li=Et.Quart,ui=Et.Quint,di=Et.Strong,ci=Et.Elastic,fi=Et.Back,pi=Et.SteppedEase,_i=Et.Bounce,gi=Et.Sine,mi=Et.Expo,vi=Et.Circ,yi={},xi=180/Math.PI,bi=Math.PI/180,ki=Math.atan2,wi=/([A-Z])/g,Ti=/(?:left|right|width|margin|padding|x)/i,Pi=/[\s,\(]\S/,Ri={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Si="transform",Ci=Si+"Origin",Ei="O,Moz,ms,Ms,Webkit".split(","),Mi=function(e,t,r){var i=(t||$r).style,n=5;if(e in i&&!r)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);n--&&!(Ei[n]+e in i););return n<0?null:(3===n?"ms":0<=n?Ei[n]:"")+e},Ai={deg:1,rad:1,turn:1},Oi={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Fi={clearProps:function(e,t,r,i,n){if("isFromStart"!==n.data){var s=e._pt=new hr(e._pt,t,r,0,0,Br);return s.u=i,s.pr=-10,s.tween=n,e._props.push(r),1}}},Di=[1,0,0,1,0,0],zi={},Li=function(e,t){var r=e._gsap||new It(e);if("x"in r&&!t&&!r.uncache)return r;var i,n,s,a,o,h,l,u,d,c,f,p,_,g,m,v,y,b,k,w,T,P,R,S,C,E,M,A,O,F,D,z,L=e.style,I=r.scaleX<0,U="deg",B=Sr(e,Ci)||"0";return i=n=s=h=l=u=d=c=f=0,a=o=1,r.svg=!(!e.getCTM||!Or(e)),g=Wr(e,r.svg),r.svg&&(S=(!r.uncache||"0px 0px"===B)&&!t&&e.getAttribute("data-svg-origin"),Xr(e,S||B,!!S||r.originIsAbsolute,!1!==r.smooth,g)),p=r.xOrigin||0,_=r.yOrigin||0,g!==Di&&(b=g[0],k=g[1],w=g[2],T=g[3],i=P=g[4],n=R=g[5],6===g.length?(a=Math.sqrt(b*b+k*k),o=Math.sqrt(T*T+w*w),h=b||k?ki(k,b)*xi:0,(d=w||T?ki(w,T)*xi+h:0)&&(o*=Math.abs(Math.cos(d*bi))),r.svg&&(i-=p-(p*b+_*w),n-=_-(p*k+_*T))):(z=g[6],F=g[7],M=g[8],A=g[9],O=g[10],D=g[11],i=g[12],n=g[13],s=g[14],l=(m=ki(z,O))*xi,m&&(S=P*(v=Math.cos(-m))+M*(y=Math.sin(-m)),C=R*v+A*y,E=z*v+O*y,M=P*-y+M*v,A=R*-y+A*v,O=z*-y+O*v,D=F*-y+D*v,P=S,R=C,z=E),u=(m=ki(-w,O))*xi,m&&(v=Math.cos(-m),D=T*(y=Math.sin(-m))+D*v,b=S=b*v-M*y,k=C=k*v-A*y,w=E=w*v-O*y),h=(m=ki(k,b))*xi,m&&(S=b*(v=Math.cos(m))+k*(y=Math.sin(m)),C=P*v+R*y,k=k*v-b*y,R=R*v-P*y,b=S,P=C),l&&359.9<Math.abs(l)+Math.abs(h)&&(l=h=0,u=180-u),a=x(Math.sqrt(b*b+k*k+w*w)),o=x(Math.sqrt(R*R+z*z)),m=ki(P,R),d=2e-4<Math.abs(m)?m*xi:0,f=D?1/(D<0?-D:D):0),r.svg&&(S=e.getAttribute("transform"),r.forceCSS=e.setAttribute("transform","")||!Nr(Sr(e,Si)),S&&e.setAttribute("transform",S))),90<Math.abs(d)&&Math.abs(d)<270&&(I?(a*=-1,d+=h<=0?180:-180,h+=h<=0?180:-180):(o*=-1,d+=d<=0?180:-180)),r.x=i-((r.xPercent=i&&(r.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-i)?-50:0)))?e.offsetWidth*r.xPercent/100:0)+"px",r.y=n-((r.yPercent=n&&(r.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-n)?-50:0)))?e.offsetHeight*r.yPercent/100:0)+"px",r.z=s+"px",r.scaleX=x(a),r.scaleY=x(o),r.rotation=x(h)+U,r.rotationX=x(l)+U,r.rotationY=x(u)+U,r.skewX=d+U,r.skewY=c+U,r.transformPerspective=f+"px",(r.zOrigin=parseFloat(B.split(" ")[2])||0)&&(L[Ci]=Ii(B)),r.xOffset=r.yOffset=0,r.force3D=Be.force3D,r.renderTransform=r.svg?Xi:ei?Wi:Ui,r.uncache=0,r},Ii=function(e){return(e=e.split(" "))[0]+" "+e[1]},Ui=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,Wi(e,t)},Bi="0deg",Ni="0px",Vi=") ",Wi=function(e,t){var r=t||this,i=r.xPercent,n=r.yPercent,s=r.x,a=r.y,o=r.z,h=r.rotation,l=r.rotationY,u=r.rotationX,d=r.skewX,c=r.skewY,f=r.scaleX,p=r.scaleY,_=r.transformPerspective,g=r.force3D,m=r.target,v=r.zOrigin,y="",x="auto"===g&&e&&1!==e||!0===g;if(v&&(u!==Bi||l!==Bi)){var b,k=parseFloat(l)*bi,w=Math.sin(k),T=Math.cos(k);k=parseFloat(u)*bi,s=Gr(m,s,w*(b=Math.cos(k))*-v),a=Gr(m,a,-Math.sin(k)*-v),o=Gr(m,o,T*b*-v+v)}_!==Ni&&(y+="perspective("+_+Vi),(i||n)&&(y+="translate("+i+"%, "+n+"%) "),!x&&s===Ni&&a===Ni&&o===Ni||(y+=o!==Ni||x?"translate3d("+s+", "+a+", "+o+") ":"translate("+s+", "+a+Vi),h!==Bi&&(y+="rotate("+h+Vi),l!==Bi&&(y+="rotateY("+l+Vi),u!==Bi&&(y+="rotateX("+u+Vi),d===Bi&&c===Bi||(y+="skew("+d+", "+c+Vi),1===f&&1===p||(y+="scale("+f+", "+p+Vi),m.style[Si]=y||"translate(0, 0)"},Xi=function(e,t){var r,i,n,s,a,o=t||this,h=o.xPercent,l=o.yPercent,u=o.x,d=o.y,c=o.rotation,f=o.skewX,p=o.skewY,_=o.scaleX,g=o.scaleY,m=o.target,v=o.xOrigin,y=o.yOrigin,b=o.xOffset,k=o.yOffset,w=o.forceCSS,T=parseFloat(u),P=parseFloat(d);c=parseFloat(c),f=parseFloat(f),(p=parseFloat(p))&&(f+=p=parseFloat(p),c+=p),c||f?(c*=bi,f*=bi,r=Math.cos(c)*_,i=Math.sin(c)*_,n=Math.sin(c-f)*-g,s=Math.cos(c-f)*g,f&&(p*=bi,a=Math.tan(f-p),n*=a=Math.sqrt(1+a*a),s*=a,p&&(a=Math.tan(p),r*=a=Math.sqrt(1+a*a),i*=a)),r=x(r),i=x(i),n=x(n),s=x(s)):(r=_,s=g,i=n=0),(T&&!~(u+"").indexOf("px")||P&&!~(d+"").indexOf("px"))&&(T=zr(m,"x",u,"px"),P=zr(m,"y",d,"px")),(v||y||b||k)&&(T=x(T+v-(v*r+y*n)+b),P=x(P+y-(v*i+y*s)+k)),(h||l)&&(T=x(T+h/100*(a=m.getBBox()).width),P=x(P+l/100*a.height)),a="matrix("+r+","+i+","+n+","+s+","+T+","+P+")",m.setAttribute("transform",a),w&&(m.style[Si]=a)};y("padding,margin,Width,Radius",(function(e,t){var r="Right",i="Bottom",n="Left",s=(t<3?["Top",r,i,n]:["Top"+n,"Top"+r,i+r,i+n]).map((function(r){return t<2?e+r:"border"+r+e}));Fi[1<t?"border"+e:e]=function(e,t,r,i,n){var a,o;if(arguments.length<4)return a=s.map((function(t){return Lr(e,t,r)})),5===(o=a.join(" ")).split(a[0]).length?a[0]:o;a=(i+"").split(" "),o={},s.forEach((function(e,t){return o[e]=a[t]=a[t]||a[(t-1)/2|0]})),e.init(t,o,n)}}));var Gi,Yi,ji={name:"css",register:Cr,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,r,i,n){var s,a,o,h,l,u,d,f,p,_,g,m,v,y,x,b=this._props,k=e.style,w=r.vars.startAt;for(d in Kr||Cr(),t)if("autoRound"!==d&&(a=t[d],!ht[d]||!Vt(d,t,r,i,e,n)))if(l=typeof a,u=Fi[d],"function"===l&&(l=typeof(a=a.call(r,i,e,n))),"string"===l&&~a.indexOf("random(")&&(a=ee(a)),u)u(this,e,d,a,r)&&(x=1);else if("--"===d.substr(0,2))s=(getComputedStyle(e).getPropertyValue(d)+"").trim(),a+="",Pt.lastIndex=0,Pt.test(s)||(f=j(s),p=j(a)),p?f!==p&&(s=zr(e,d,s,p)+p):f&&(a+=f),this.add(k,"setProperty",s,a,i,n,0,0,d),b.push(d);else if("undefined"!==l){if(w&&d in w?(s="function"==typeof w[d]?w[d].call(r,i,e,n):w[d],d in Be.units&&!j(s)&&(s+=Be.units[d]),"="===(s+"").charAt(1)&&(s=Lr(e,d))):s=Lr(e,d),h=parseFloat(s),(_="string"===l&&"="===a.charAt(1)?+(a.charAt(0)+"1"):0)&&(a=a.substr(2)),o=parseFloat(a),d in Ri&&("autoAlpha"===d&&(1===h&&"hidden"===Lr(e,"visibility")&&o&&(h=0),Dr(this,k,"visibility",h?"inherit":"hidden",o?"inherit":"hidden",!o)),"scale"!==d&&"transform"!==d&&~(d=Ri[d]).indexOf(",")&&(d=d.split(",")[0])),g=d in yi)if(m||((v=e._gsap).renderTransform&&!t.parseTransform||Li(e,t.parseTransform),y=!1!==t.smoothOrigin&&v.smooth,(m=this._pt=new hr(this._pt,k,Si,0,1,v.renderTransform,v,0,-1)).dep=1),"scale"===d)this._pt=new hr(this._pt,v,"scaleY",v.scaleY,(_?_*o:o-v.scaleY)||0),b.push("scaleY",d),d+="X";else{if("transformOrigin"===d){a=Ur(a),v.svg?Xr(e,a,0,y,0,this):((p=parseFloat(a.split(" ")[2])||0)!==v.zOrigin&&Dr(this,v,"zOrigin",v.zOrigin,p),Dr(this,k,d,Ii(s),Ii(a)));continue}if("svgOrigin"===d){Xr(e,a,1,y,0,this);continue}if(d in zi){Yr(this,v,d,h,a,_);continue}if("smoothOrigin"===d){Dr(this,v,"smooth",v.smooth,a);continue}if("force3D"===d){v[d]=a;continue}if("transform"===d){Hr(this,a,e);continue}}else d in k||(d=Mi(d)||d);if(g||(o||0===o)&&(h||0===h)&&!Pi.test(a)&&d in k)o=o||0,(f=(s+"").substr((h+"").length))!==(p=j(a)||(d in Be.units?Be.units[d]:f))&&(h=zr(e,d,s,p)),this._pt=new hr(this._pt,g?v:k,d,h,_?_*o:o-h,g||"px"!==p&&"zIndex"!==d||!1===t.autoRound?pr:mr),this._pt.u=p||0,f!==p&&(this._pt.b=s,this._pt.r=gr);else if(d in k)Ir.call(this,e,d,s,a);else{if(!(d in e)){c(d,a);continue}this.add(e,d,s||e[d],a,i,n)}b.push(d)}x&&or(this)},get:Lr,aliases:Ri,getSetter:function(e,t,r){var i=Ri[t];return i&&i.indexOf(",")<0&&(t=i),t in yi&&t!==Ci&&(e._gsap.x||Lr(e,"x"))?r&&Jr===r?"scale"===t?wr:kr:(Jr=r||{})&&("scale"===t?Tr:Pr):e.style&&!a(e.style[t])?xr:~t.indexOf("-")?br:er(e,t)},core:{_removeProperty:Fr,_getMatrix:Wr}};fr.utils.checkPrefix=Mi,Yi=y("x,y,z,scale,scaleX,scaleY,xPercent,yPercent"+","+(Gi="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(e){yi[e]=1})),y(Gi,(function(e){Be.units[e]="deg",zi[e]=1})),Ri[Yi[13]]="x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+Gi,y("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(e){var t=e.split(":");Ri[t[1]]=Yi[t[0]]})),y("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(e){Be.units[e]="px"})),fr.registerPlugin(ji);var Hi=fr.registerPlugin(ji)||fr,qi=Hi.core.Tween;e.Back=fi,e.Bounce=_i,e.CSSPlugin=ji,e.Circ=vi,e.Cubic=hi,e.Elastic=ci,e.Expo=mi,e.Linear=ai,e.Power0=ti,e.Power1=ri,e.Power2=ii,e.Power3=ni,e.Power4=si,e.Quad=oi,e.Quart=li,e.Quint=ui,e.Sine=gi,e.SteppedEase=pi,e.Strong=di,e.TimelineLite=Nt,e.TimelineMax=Nt,e.TweenLite=qt,e.TweenMax=qi,e.default=Hi,e.gsap=Hi,"undefined"==typeof window||window!==e?Object.defineProperty(e,"__esModule",{value:!0}):delete e.default})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).window=e.window||{})}(this,(function(e){function t(){return"undefined"!=typeof window}function r(){return u||t()&&(u=window.gsap)&&u.registerPlugin&&u}function i(e){return"string"==typeof e}function n(e){return"function"==typeof e}function s(e,t){var r="x"===t?"Width":"Height",i="scroll"+r,n="client"+r;return e===c||e===f||e===p?Math.max(f[i],p[i])-(c["inner"+r]||f[n]||p[n]):e[i]-e["offset"+r]}function a(e,t){var r="scroll"+("x"===t?"Left":"Top");return e===c&&(null!=e.pageXOffset?r="page"+t.toUpperCase()+"Offset":e=null!=f[r]?f:p),function(){return e[r]}}function o(e,t){if(!(e=_(e)[0])||!e.getBoundingClientRect)return console.warn("scrollTo target doesn't exist. Using 0")||{x:0,y:0};var r=e.getBoundingClientRect(),i=!t||t===c||t===p,n=i?{top:f.clientTop-(c.pageYOffset||f.scrollTop||p.scrollTop||0),left:f.clientLeft-(c.pageXOffset||f.scrollLeft||p.scrollLeft||0)}:t.getBoundingClientRect(),s={x:r.left-n.left,y:r.top-n.top};return!i&&t&&(s.x+=a(t,"x")(),s.y+=a(t,"y")()),s}function h(e,t,r,n,a){return isNaN(e)||"object"==typeof e?i(e)&&"="===e.charAt(1)?parseFloat(e.substr(2))*("-"===e.charAt(0)?-1:1)+n-a:"max"===e?s(t,r)-a:Math.min(s(t,r),o(e,t)[r]-a):parseFloat(e)-a}function l(){u=r(),t()&&u&&document.body&&(c=window,p=document.body,f=document.documentElement,_=u.utils.toArray,u.config({autoKillThreshold:7}),g=u.config(),d=1)}var u,d,c,f,p,_,g,m={version:"3.7.1",name:"scrollTo",rawVars:1,register:function(e){u=e,l()},init:function(e,t,r,s,o){d||l();var f=this,p=u.getProperty(e,"scrollSnapType");f.isWin=e===c,f.target=e,f.tween=r,t=function(e,t,r,s){if(n(e)&&(e=e(t,r,s)),"object"!=typeof e)return i(e)&&"max"!==e&&"="!==e.charAt(1)?{x:e,y:e}:{y:e};if(e.nodeType)return{y:e,x:e};var a,o={};for(a in e)o[a]="onAutoKill"!==a&&n(e[a])?e[a](t,r,s):e[a];return o}(t,s,e,o),f.vars=t,f.autoKill=!!t.autoKill,f.getX=a(e,"x"),f.getY=a(e,"y"),f.x=f.xPrev=f.getX(),f.y=f.yPrev=f.getY(),p&&"none"!==p&&(f.snap=1,f.snapInline=e.style.scrollSnapType,e.style.scrollSnapType="none"),null!=t.x?(f.add(f,"x",f.x,h(t.x,e,"x",f.x,t.offsetX||0),s,o),f._props.push("scrollTo_x")):f.skipX=1,null!=t.y?(f.add(f,"y",f.y,h(t.y,e,"y",f.y,t.offsetY||0),s,o),f._props.push("scrollTo_y")):f.skipY=1},render:function(e,t){for(var r,i,n,a,o,h=t._pt,l=t.target,u=t.tween,d=t.autoKill,f=t.xPrev,p=t.yPrev,_=t.isWin,m=t.snap,v=t.snapInline;h;)h.r(e,h.d),h=h._next;r=_||!t.skipX?t.getX():f,n=(i=_||!t.skipY?t.getY():p)-p,a=r-f,o=g.autoKillThreshold,t.x<0&&(t.x=0),t.y<0&&(t.y=0),d&&(!t.skipX&&(o<a||a<-o)&&r<s(l,"x")&&(t.skipX=1),!t.skipY&&(o<n||n<-o)&&i<s(l,"y")&&(t.skipY=1),t.skipX&&t.skipY&&(u.kill(),t.vars.onAutoKill&&t.vars.onAutoKill.apply(u,t.vars.onAutoKillParams||[]))),_?c.scrollTo(t.skipX?r:t.x,t.skipY?i:t.y):(t.skipY||(l.scrollTop=t.y),t.skipX||(l.scrollLeft=t.x)),!m||1!==e&&0!==e||(i=l.scrollTop,r=l.scrollLeft,v?l.style.scrollSnapType=v:l.style.removeProperty("scroll-snap-type"),l.scrollTop=i+1,l.scrollLeft=r+1,l.scrollTop=i,l.scrollLeft=r),t.xPrev=t.x,t.yPrev=t.y},kill:function(e){var t="scrollTo"===e;!t&&"scrollTo_x"!==e||(this.skipX=1),!t&&"scrollTo_y"!==e||(this.skipY=1)}};m.max=s,m.getOffset=o,m.buildGetter=a,r()&&u.registerPlugin(m),e.ScrollToPlugin=m,e.default=m,"undefined"==typeof window||window!==e?Object.defineProperty(e,"__esModule",{value:!0}):delete e.default})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).window=e.window||{})}(this,(function(e){var t,r,i,n,s,a,o,h,l,u,d,c,f,p,_,g,m,v,y,x,b,k,w,T,P,R,S,C,E=1,M=[],A=[],O=Date.now,F=O(),D=0,z=1,L=function(e){return e},I=function(e){return Math.round(1e5*e)/1e5||0},U=function(){return"undefined"!=typeof window},B=function(){return t||U()&&(t=window.gsap)&&t.registerPlugin&&t},N=function(e){return!!~o.indexOf(e)},V=function(e,t){return~M.indexOf(e)&&M[M.indexOf(e)+1][t]},W=function(e,t){var r=t.s,i=t.sc,n=A.indexOf(e),s=i===me.sc?1:2;return!~n&&(n=A.push(e)-1),A[n+s]||(A[n+s]=V(e,r)||(N(e)?i:function(t){return arguments.length?e[r]=t:e[r]}))},X=function(e){return V(e,"getBoundingClientRect")||(N(e)?function(){return rt.width=i.innerWidth,rt.height=i.innerHeight,rt}:function(){return xe(e)})},G=function(e,t){var r=t.s,n=t.d2,o=t.d,h=t.a;return(r="scroll"+n)&&(h=V(e,r))?h()-X(e)()[o]:N(e)?Math.max(s[r],a[r])-(i["inner"+n]||s["client"+n]||a["client"+n]):e[r]-e["offset"+n]},Y=function(e,t){for(var r=0;r<b.length;r+=3)(!t||~t.indexOf(b[r+1]))&&e(b[r],b[r+1],b[r+2])},j=function(e){return"string"==typeof e},H=function(e){return"function"==typeof e},q=function(e){return"number"==typeof e},Q=function(e){return"object"==typeof e},Z=function(e){return H(e)&&e()},K=function(e,t){return function(){var r=Z(e),i=Z(t);return function(){Z(r),Z(i)}}},$=Math.abs,J="scrollLeft",ee="scrollTop",te="left",re="top",ie="right",ne="bottom",se="width",ae="height",oe="Right",he="Left",le="Top",ue="Bottom",de="padding",ce="margin",fe="Width",pe="Height",_e="px",ge={s:J,p:te,p2:he,os:ie,os2:oe,d:se,d2:fe,a:"x",sc:function(e){return arguments.length?i.scrollTo(e,me.sc()):i.pageXOffset||n.scrollLeft||s.scrollLeft||a.scrollLeft||0}},me={s:ee,p:re,p2:le,os:ne,os2:ue,d:ae,d2:pe,a:"y",op:ge,sc:function(e){return arguments.length?i.scrollTo(ge.sc(),e):i.pageYOffset||n.scrollTop||s.scrollTop||a.scrollTop||0}},ve=function(e){return i.getComputedStyle(e)},ye=function(e,t){for(var r in t)r in e||(e[r]=t[r]);return e},xe=function(e,r){var i=r&&"matrix(1, 0, 0, 1, 0, 0)"!==ve(e)[m]&&t.to(e,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),n=e.getBoundingClientRect();return i&&i.progress(0).kill(),n},be=function(e,t){var r=t.d2;return e["offset"+r]||e["client"+r]||0},ke=function(e){var t,r=[],i=e.labels,n=e.duration();for(t in i)r.push(i[t]/n);return r},we=function(e,t,r,i){return r.split(",").forEach((function(r){return e(t,r,i)}))},Te=function(e,t,r){return e.addEventListener(t,r,{passive:!0})},Pe=function(e,t,r){return e.removeEventListener(t,r)},Re={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},Se={toggleActions:"play",anticipatePin:0},Ce={top:0,left:0,center:.5,bottom:1,right:1},Ee=function(e,t){if(j(e)){var r=e.indexOf("="),i=~r?+(e.charAt(r-1)+1)*parseFloat(e.substr(r+1)):0;~r&&(e.indexOf("%")>r&&(i*=t/100),e=e.substr(0,r-1)),e=i+(e in Ce?Ce[e]*t:~e.indexOf("%")?parseFloat(e)*t/100:parseFloat(e)||0)}return e},Me=function(e,t,r,i,s,o,h){var l=s.startColor,u=s.endColor,d=s.fontSize,c=s.indent,f=s.fontWeight,p=n.createElement("div"),_=N(r)||"fixed"===V(r,"pinType"),g=-1!==e.indexOf("scroller"),m=_?a:r,v=-1!==e.indexOf("start"),y=v?l:u,x="border-color:"+y+";font-size:"+d+";color:"+y+";font-weight:"+f+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return x+="position:"+(g&&_?"fixed;":"absolute;"),(g||!_)&&(x+=(i===me?ie:ne)+":"+(o+parseFloat(c))+"px;"),h&&(x+="box-sizing:border-box;text-align:left;width:"+h.offsetWidth+"px;"),p._isStart=v,p.setAttribute("class","gsap-marker-"+e),p.style.cssText=x,p.innerText=t||0===t?e+"-"+t:e,m.children[0]?m.insertBefore(p,m.children[0]):m.appendChild(p),p._offset=p["offset"+i.op.d2],Ae(p,0,i,v),p},Ae=function(e,r,i,n){var s={display:"block"},a=i[n?"os2":"p2"],o=i[n?"p2":"os2"];e._isFlipped=n,s[i.a+"Percent"]=n?-100:0,s[i.a]=n?"1px":0,s["border"+a+fe]=1,s["border"+o+fe]=0,s[i.p]=r+"px",t.set(e,s)},Oe=[],Fe={},De=function(){return u||(u=l(Qe))},ze=function(){u||(u=l(Qe),D||We("scrollStart"),D=O())},Le=function(){return!_&&!T&&!n.fullscreenElement&&h.restart(!0)},Ie={},Ue=[],Be=[],Ne=function(e){var n,s=t.ticker.frame,a=[],o=0;if(S!==s||E){for(Ye();o<Be.length;o+=4)(n=i.matchMedia(Be[o]).matches)!==Be[o+3]&&(Be[o+3]=n,n?a.push(o):Ye(1,Be[o])||H(Be[o+2])&&Be[o+2]());for(Ge(),o=0;o<a.length;o++)n=a[o],R=Be[n],Be[n+2]=Be[n+1](e);R=0,r&&je(0,1),S=s,We("matchMedia")}},Ve=function e(){return Pe(ot,"scrollEnd",e)||je(!0)},We=function(e){return Ie[e]&&Ie[e].map((function(e){return e()}))||Ue},Xe=[],Ge=function(e){for(var t=0;t<Xe.length;t+=5)e&&Xe[t+4]!==e||(Xe[t].style.cssText=Xe[t+1],Xe[t].getBBox&&Xe[t].setAttribute("transform",Xe[t+2]||""),Xe[t+3].uncache=1)},Ye=function(e,t){var r;for(v=0;v<Oe.length;v++)r=Oe[v],t&&r.media!==t||(e?r.kill(1):r.revert());t&&Ge(t),t||We("revert")},je=function(e,t){if(!D||e){C=!0;var r=We("refreshInit");k&&ot.sort(),t||Ye(),Oe.forEach((function(e){return e.refresh()})),r.forEach((function(e){return e&&e.render&&e.render(-1)})),A.forEach((function(e){return"function"==typeof e&&(e.rec=0)})),h.pause(),C=!1,We("refresh")}else Te(ot,"scrollEnd",Ve)},He=0,qe=1,Qe=function(){if(!C){var e=Oe.length,t=O(),r=t-F>=50,i=e&&Oe[0].scroll();if(qe=He>i?-1:1,He=i,r&&(D&&t-D>200&&(D=0,We("scrollEnd")),f=F,F=t),qe<0){for(v=e;v-- >0;)Oe[v]&&Oe[v].update(0,r);qe=1}else for(v=0;v<e;v++)Oe[v]&&Oe[v].update(0,r);u=0}},Ze=[te,re,ne,ie,"marginBottom","marginRight","marginTop","marginLeft","display","flexShrink","float","zIndex","grid-column-start","grid-column-end","grid-row-start","grid-row-end","grid-area","justify-self","align-self","place-self"],Ke=Ze.concat([se,ae,"boxSizing","maxWidth","maxHeight","position",ce,de,"paddingTop","paddingRight","paddingBottom","paddingLeft"]),$e=function(e,t,r,i){if(e.parentNode!==t){for(var n,s=Ze.length,a=t.style,o=e.style;s--;)a[n=Ze[s]]=r[n];a.position="absolute"===r.position?"absolute":"relative","inline"===r.display&&(a.display="inline-block"),o.bottom=o.right="auto",a.overflow="visible",a.boxSizing="border-box",a.width=be(e,ge)+_e,a.height=be(e,me)+_e,a.padding=o.margin=o.top=o.left="0",et(i),o.width=o.maxWidth=r.width,o.height=o.maxHeight=r.height,o.padding=r.padding,e.parentNode.insertBefore(t,e),t.appendChild(e)}},Je=/([A-Z])/g,et=function(e){if(e){var r,i,n=e.t.style,s=e.length,a=0;for((e.t._gsap||t.core.getCache(e.t)).uncache=1;a<s;a+=2)i=e[a+1],r=e[a],i?n[r]=i:n[r]&&n.removeProperty(r.replace(Je,"-$1").toLowerCase())}},tt=function(e){for(var t=Ke.length,r=e.style,i=[],n=0;n<t;n++)i.push(Ke[n],r[Ke[n]]);return i.t=e,i},rt={left:0,top:0},it=function(e,t,r,i,n,o,h,l,u,c,f,p){if(H(e)&&(e=e(l)),j(e)&&"max"===e.substr(0,3)&&(e=p+("="===e.charAt(4)?Ee("0"+e.substr(3),r):0)),q(e))h&&Ae(h,r,i,!0);else{H(t)&&(t=t(l));var _,g,m,v=d(t)[0]||a,y=xe(v)||{},x=e.split(" ");y&&(y.left||y.top)||"none"!==ve(v).display||(m=v.style.display,v.style.display="block",y=xe(v),m?v.style.display=m:v.style.removeProperty("display")),_=Ee(x[0],y[i.d]),g=Ee(x[1]||"0",r),e=y[i.p]-u[i.p]-c+_+n-g,h&&Ae(h,g,i,r-g<20||h._isStart&&g>20),r-=r-g}if(o){var b=e+r,k=o._isStart;p="scroll"+i.d2,Ae(o,b,i,k&&b>20||!k&&(f?Math.max(a[p],s[p]):o.parentNode[p])<=b+1),f&&(u=xe(h),f&&(o.style[i.op.p]=u[i.op.p]-i.op.m-o._offset+_e))}return Math.round(e)},nt=/(?:webkit|moz|length|cssText|inset)/i,st=function(e,r,i,n){if(e.parentNode!==r){var s,o,h=e.style;if(r===a){for(s in e._stOrig=h.cssText,o=ve(e))+s||nt.test(s)||!o[s]||"string"!=typeof h[s]||"0"===s||(h[s]=o[s]);h.top=i,h.left=n}else h.cssText=e._stOrig;t.core.getCache(e).uncache=1,r.appendChild(e)}},at=function(e,r){var i,n,s=W(e,r),a="_scroll"+r.p2,o=function r(o,h,l,u,d){var c=r.tween,f=h.onComplete,p={};return c&&c.kill(),i=Math.round(l),h[a]=o,h.modifiers=p,p[a]=function(e){return(e=I(s()))!==i&&e!==n&&Math.abs(e-i)>2?(c.kill(),r.tween=0):e=l+u*c.ratio+d*c.ratio*c.ratio,n=i,i=I(e)},h.onComplete=function(){r.tween=0,f&&f.call(c)},c=r.tween=t.to(e,h)};return e[a]=s,e.addEventListener("wheel",(function(){return o.tween&&o.tween.kill()&&(o.tween=0)}),{passive:!0}),o};ge.op=me;var ot=function(){function e(i,n){r||e.register(t)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),this.init(i,n)}return e.prototype.init=function(r,o){if(this.progress=this.start=0,this.vars&&this.kill(1),z){var h,l,u,p,m,y,x,b,T,S,C,A,F,I,U,B,Y,Z,K,J,ee,te,re,ie,ne,se,ae,oe,he,le,ue,pe,we,Ce,Ae,De,Ie,Ue,Be,Ne=(r=ye(j(r)||q(r)||r.nodeType?{trigger:r}:r,Se)).horizontal?ge:me,We=r,Xe=We.onUpdate,Ge=We.toggleClass,Ye=We.id,je=We.onToggle,He=We.onRefresh,Qe=We.scrub,Ze=We.trigger,Ke=We.pin,Je=We.pinSpacing,nt=We.invalidateOnRefresh,ot=We.anticipatePin,ht=We.onScrubComplete,lt=We.onSnapComplete,ut=We.once,dt=We.snap,ct=We.pinReparent,ft=!Qe&&0!==Qe,pt=d(r.scroller||i)[0],_t=t.core.getCache(pt),gt=N(pt),mt="pinType"in r?"fixed"===r.pinType:gt||"fixed"===V(pt,"pinType"),vt=[r.onEnter,r.onLeave,r.onEnterBack,r.onLeaveBack],yt=ft&&r.toggleActions.split(" "),xt="markers"in r?r.markers:Se.markers,bt=gt?0:parseFloat(ve(pt)["border"+Ne.p2+fe])||0,kt=this,wt=r.onRefreshInit&&function(){return r.onRefreshInit(kt)},Tt=function(e,t,r){var n=r.d,s=r.d2,a=r.a;return(a=V(e,"getBoundingClientRect"))?function(){return a()[n]}:function(){return(t?i["inner"+s]:e["client"+s])||0}}(pt,gt,Ne),Pt=function(e,t){return!t||~M.indexOf(e)?X(e):function(){return rt}}(pt,gt),Rt=0;kt.media=R,ot*=45,kt.scroller=pt,kt.scroll=W(pt,Ne),p=kt.scroll(),kt.vars=r,o=o||r.animation,"refreshPriority"in r&&(k=1),_t.tweenScroll=_t.tweenScroll||{top:at(pt,me),left:at(pt,ge)},kt.tweenTo=h=_t.tweenScroll[Ne.p],o&&(o.vars.lazy=!1,o._initted||!1!==o.vars.immediateRender&&!1!==r.immediateRender&&o.render(0,!0,!0),kt.animation=o.pause(),o.scrollTrigger=kt,(ue=q(Qe)&&Qe)&&(le=t.to(o,{ease:"power3",duration:ue,onComplete:function(){return ht&&ht(kt)}})),oe=0,Ye||(Ye=o.vars.id)),Oe.push(kt),dt&&(Q(dt)&&!dt.push||(dt={snapTo:dt}),"scrollBehavior"in a.style&&t.set(gt?[a,s]:pt,{scrollBehavior:"auto"}),u=H(dt.snapTo)?dt.snapTo:"labels"===dt.snapTo?function(e){return function(r){return t.utils.snap(ke(e),r)}}(o):"labelsDirectional"===dt.snapTo?(Ie=o,function(e,t){var r,i=ke(Ie);if(i.sort((function(e,t){return e-t})),t.direction>0){for(e-=1e-4,r=0;r<i.length;r++)if(i[r]>=e)return i[r];return i.pop()}for(r=i.length,e+=1e-4;r--;)if(i[r]<=e)return i[r];return i[0]}):t.utils.snap(dt.snapTo),pe=dt.duration||{min:.1,max:2},pe=Q(pe)?c(pe.min,pe.max):c(pe,pe),we=t.delayedCall(dt.delay||ue/2||.1,(function(){if(Math.abs(kt.getVelocity())<10&&!g&&Rt!==kt.scroll()){var e=o&&!ft?o.totalProgress():kt.progress,r=(e-he)/(O()-f)*1e3||0,i=t.utils.clamp(-kt.progress,1-kt.progress,$(r/2)*r/.185),n=kt.progress+(!1===dt.inertia?0:i),s=c(0,1,u(n,kt)),a=kt.scroll(),l=Math.round(y+s*F),d=dt,p=d.onStart,_=d.onInterrupt,m=d.onComplete,v=h.tween;if(a<=x&&a>=y&&l!==a){if(v&&!v._initted&&v.data<=Math.abs(l-a))return;!1===dt.inertia&&(i=s-kt.progress),h(l,{duration:pe($(.185*Math.max($(n-e),$(s-e))/r/.05||0)),ease:dt.ease||"power3",data:Math.abs(l-a),onInterrupt:function(){return we.restart(!0)&&_&&_(kt)},onComplete:function(){Rt=kt.scroll(),oe=he=o&&!ft?o.totalProgress():kt.progress,lt&&lt(kt),m&&m(kt)}},a,i*F,l-a-i*F),p&&p(kt,h.tween)}}else kt.isActive&&we.restart(!0)})).pause()),Ye&&(Fe[Ye]=kt),Ze=kt.trigger=d(Ze||Ke)[0],Ke=!0===Ke?Ze:d(Ke)[0],j(Ge)&&(Ge={targets:Ze,className:Ge}),Ke&&(!1===Je||Je===ce||(Je=!(!Je&&"flex"===ve(Ke.parentNode).display)&&de),kt.pin=Ke,!1!==r.force3D&&t.set(Ke,{force3D:!0}),(l=t.core.getCache(Ke)).spacer?I=l.pinState:(l.spacer=Y=n.createElement("div"),Y.setAttribute("class","pin-spacer"+(Ye?" pin-spacer-"+Ye:"")),l.pinState=I=tt(Ke)),kt.spacer=Y=l.spacer,ae=ve(Ke),re=ae[Je+Ne.os2],K=t.getProperty(Ke),J=t.quickSetter(Ke,Ne.a,_e),$e(Ke,Y,ae),B=tt(Ke)),xt&&(A=Q(xt)?ye(xt,Re):Re,S=Me("scroller-start",Ye,pt,Ne,A,0),C=Me("scroller-end",Ye,pt,Ne,A,0,S),Z=S["offset"+Ne.op.d2],b=Me("start",Ye,pt,Ne,A,Z),T=Me("end",Ye,pt,Ne,A,Z),mt||M.length&&!0===V(pt,"fixedMarkers")||(Be=ve(Ue=gt?a:pt).position,Ue.style.position="absolute"===Be||"fixed"===Be?Be:"relative",t.set([S,C],{force3D:!0}),ne=t.quickSetter(S,Ne.a,_e),se=t.quickSetter(C,Ne.a,_e))),kt.revert=function(e){var t=!1!==e||!kt.enabled,r=_;t!==kt.isReverted&&(t&&(kt.scroll.rec||(kt.scroll.rec=kt.scroll()),Ae=Math.max(kt.scroll(),kt.scroll.rec||0),Ce=kt.progress,De=o&&o.progress()),b&&[b,T,S,C].forEach((function(e){return e.style.display=t?"none":"block"})),t&&(_=1),kt.update(t),_=r,Ke&&(t?function(e,t,r){if(et(r),e.parentNode===t){var i=t.parentNode;i&&(i.insertBefore(e,t),i.removeChild(t))}}(Ke,Y,I):(!ct||!kt.isActive)&&$e(Ke,Y,ve(Ke),ie)),kt.isReverted=t)},kt.refresh=function(i,n){if(!_&&kt.enabled||n)if(Ke&&i&&D)Te(e,"scrollEnd",Ve);else{_=1,le&&le.pause(),nt&&o&&o.progress(0).invalidate(),kt.isReverted||kt.revert();for(var s,h,l,u,c,f,g,v,k,P,R=Tt(),E=Pt(),M=G(pt,Ne),A=0,O=0,z=r.end,L=r.endTrigger||Ze,N=r.start||(0!==r.start&&Ze?Ke?"0 0":"0 100%":0),V=r.pinnedContainer&&d(r.pinnedContainer)[0],X=Ze&&Math.max(0,Oe.indexOf(kt))||0,q=X;q--;)(f=Oe[q]).end||f.refresh(0,1)||(_=1),!(g=f.pin)||g!==Ze&&g!==Ke||f.isReverted||(P||(P=[]),P.unshift(f),f.revert());for(y=it(N,Ze,R,Ne,kt.scroll(),b,S,kt,E,bt,mt,M)||(Ke?-.001:0),H(z)&&(z=z(kt)),j(z)&&!z.indexOf("+=")&&(~z.indexOf(" ")?z=(j(N)?N.split(" ")[0]:"")+z:(A=Ee(z.substr(2),R),z=j(N)?N:y+A,L=Ze)),x=Math.max(y,it(z||(L?"100% 0":M),L,R,Ne,kt.scroll()+A,T,C,kt,E,bt,mt,M))||-.001,F=x-y||(y-=.01)&&.001,A=0,q=X;q--;)(g=(f=Oe[q]).pin)&&f.start-f._pinPush<y&&(s=f.end-f.start,(g===Ze||g===V)&&(A+=s),g===Ke&&(O+=s));if(y+=A,x+=A,kt._pinPush=O,b&&A&&((s={})[Ne.a]="+="+A,V&&(s[Ne.p]="-="+kt.scroll()),t.set([b,T],s)),Ke)s=ve(Ke),u=Ne===me,l=kt.scroll(),ee=parseFloat(K(Ne.a))+O,!M&&x>1&&((gt?a:pt).style["overflow-"+Ne.a]="scroll"),$e(Ke,Y,s),B=tt(Ke),h=xe(Ke,!0),v=mt&&W(pt,u?ge:me)(),Je&&((ie=[Je+Ne.os2,F+O+_e]).t=Y,(q=Je===de?be(Ke,Ne)+F+O:0)&&ie.push(Ne.d,q+_e),et(ie),mt&&kt.scroll(Ae)),mt&&((c={top:h.top+(u?l-y:v)+_e,left:h.left+(u?v:l-y)+_e,boxSizing:"border-box",position:"fixed"}).width=c.maxWidth=Math.ceil(h.width)+_e,c.height=c.maxHeight=Math.ceil(h.height)+_e,c.margin=c.marginTop=c.marginRight=c.marginBottom=c.marginLeft="0",c.padding=s.padding,c.paddingTop=s.paddingTop,c.paddingRight=s.paddingRight,c.paddingBottom=s.paddingBottom,c.paddingLeft=s.paddingLeft,U=function(e,t,r){for(var i,n=[],s=e.length,a=r?8:0;a<s;a+=2)i=e[a],n.push(i,i in t?t[i]:e[a+1]);return n.t=e.t,n}(I,c,ct)),o?(k=o._initted,w(1),o.render(o.duration(),!0,!0),te=K(Ne.a)-ee+F+O,F!==te&&U.splice(U.length-2,2),o.render(0,!0,!0),k||o.invalidate(),w(0)):te=F;else if(Ze&&kt.scroll())for(h=Ze.parentNode;h&&h!==a;)h._pinOffset&&(y-=h._pinOffset,x-=h._pinOffset),h=h.parentNode;P&&P.forEach((function(e){return e.revert(!1)})),kt.start=y,kt.end=x,(p=m=kt.scroll())<Ae&&kt.scroll(Ae),kt.revert(!1),_=0,o&&ft&&o._initted&&o.progress()!==De&&o.progress(De,!0).render(o.time(),!0,!0),Ce!==kt.progress&&(le&&o.totalProgress(Ce,!0),kt.progress=Ce,kt.update()),Ke&&Je&&(Y._pinOffset=Math.round(kt.progress*te)),He&&He(kt)}},kt.getVelocity=function(){return(kt.scroll()-m)/(O()-f)*1e3||0},kt.update=function(e,t){var r,i,n,s,l,u=kt.scroll(),c=e?0:(u-y)/F,g=c<0?0:c>1?1:c||0,v=kt.progress;if(t&&(m=p,p=u,dt&&(he=oe,oe=o&&!ft?o.totalProgress():g)),ot&&!g&&Ke&&!_&&!E&&D&&y<u+(u-m)/(O()-f)*ot&&(g=1e-4),g!==v&&kt.enabled){if(s=(l=(r=kt.isActive=!!g&&g<1)!==(!!v&&v<1))||!!g!=!!v,kt.direction=g>v?1:-1,kt.progress=g,ft||(!le||_||E?o&&o.totalProgress(g,!!_):(le.vars.totalProgress=g,le.invalidate().restart())),Ke)if(e&&Je&&(Y.style[Je+Ne.os2]=re),mt){if(s){if(n=!e&&g>v&&x+1>u&&u+1>=G(pt,Ne),ct)if(e||!r&&!n)st(Ke,Y);else{var b=xe(Ke,!0),k=u-y;st(Ke,a,b.top+(Ne===me?k:0)+_e,b.left+(Ne===me?0:k)+_e)}et(r||n?U:B),te!==F&&g<1&&r||J(ee+(1!==g||n?0:te))}}else J(ee+te*g);dt&&!h.tween&&!_&&!E&&we.restart(!0),Ge&&(l||ut&&g&&(g<1||!P))&&d(Ge.targets).forEach((function(e){return e.classList[r||ut?"add":"remove"](Ge.className)})),Xe&&!ft&&!e&&Xe(kt),s&&!_?(i=g&&!v?0:1===g?1:1===v?2:3,ft&&(n=!l&&"none"!==yt[i+1]&&yt[i+1]||yt[i],o&&("complete"===n||"reset"===n||n in o)&&("complete"===n?o.pause().totalProgress(1):"reset"===n?o.restart(!0).pause():"restart"===n?o.restart(!0):o[n]()),Xe&&Xe(kt)),!l&&P||(je&&l&&je(kt),vt[i]&&vt[i](kt),ut&&(1===g?kt.kill(!1,1):vt[i]=0),l||vt[i=1===g?1:3]&&vt[i](kt))):ft&&Xe&&!_&&Xe(kt)}se&&(ne(u+(S._isFlipped?1:0)),se(u))},kt.enable=function(t,r){kt.enabled||(kt.enabled=!0,Te(pt,"resize",Le),Te(pt,"scroll",ze),wt&&Te(e,"refreshInit",wt),!1!==t&&(kt.progress=Ce=0,p=m=Rt=kt.scroll()),!1!==r&&kt.refresh())},kt.getTween=function(e){return e&&h?h.tween:le},kt.disable=function(t,r){if(kt.enabled&&(!1!==t&&kt.revert(),kt.enabled=kt.isActive=!1,r||le&&le.pause(),Ae=0,l&&(l.uncache=1),wt&&Pe(e,"refreshInit",wt),we&&(we.pause(),h.tween&&h.tween.kill()&&(h.tween=0)),!gt)){for(var i=Oe.length;i--;)if(Oe[i].scroller===pt&&Oe[i]!==kt)return;Pe(pt,"resize",Le),Pe(pt,"scroll",ze)}},kt.kill=function(e,t){kt.disable(e,t),Ye&&delete Fe[Ye];var r=Oe.indexOf(kt);Oe.splice(r,1),r===v&&qe>0&&v--,r=0,Oe.forEach((function(e){return e.scroller===kt.scroller&&(r=1)})),r||(kt.scroll.rec=0),o&&(o.scrollTrigger=null,e&&o.render(-1),t||o.kill()),b&&[b,T,S,C].forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)})),Ke&&(l&&(l.uncache=1),r=0,Oe.forEach((function(e){return e.pin===Ke&&r++})),r||(l.spacer=0))},kt.enable(!1,!1),o&&o.add&&!F?t.delayedCall(.01,(function(){return y||x||kt.refresh()}))&&(F=.01)&&(y=x=0):kt.refresh()}else this.update=this.refresh=this.kill=L},e.register=function(u){if(!r&&(t=u||B(),U()&&window.document&&(i=window,n=document,s=n.documentElement,a=n.body),t&&(d=t.utils.toArray,c=t.utils.clamp,w=t.core.suppressOverwrites||L,t.core.globals("ScrollTrigger",e),a))){l=i.requestAnimationFrame||function(e){return setTimeout(e,16)},Te(i,"wheel",ze),o=[i,n,s,a],Te(n,"scroll",ze);var f,_=a.style,v=_.borderTop;_.borderTop="1px solid #000",f=xe(a),me.m=Math.round(f.top+me.sc())||0,ge.m=Math.round(f.left+ge.sc())||0,v?_.borderTop=v:_.removeProperty("border-top"),p=setInterval(De,200),t.delayedCall(.5,(function(){return E=0})),Te(n,"touchcancel",L),Te(a,"touchstart",L),we(Te,n,"pointerdown,touchstart,mousedown",(function(){return g=1})),we(Te,n,"pointerup,touchend,mouseup",(function(){return g=0})),m=t.utils.checkPrefix("transform"),Ke.push(m),r=O(),h=t.delayedCall(.2,je).pause(),b=[n,"visibilitychange",function(){var e=i.innerWidth,t=i.innerHeight;n.hidden?(y=e,x=t):y===e&&x===t||Le()},n,"DOMContentLoaded",je,i,"load",function(){return D||je()},i,"resize",Le],Y(Te)}return r},e.defaults=function(e){for(var t in e)Se[t]=e[t]},e.kill=function(){z=0,Oe.slice(0).forEach((function(e){return e.kill(1)}))},e.config=function(e){"limitCallbacks"in e&&(P=!!e.limitCallbacks);var t=e.syncInterval;t&&clearInterval(p)||(p=t)&&setInterval(De,t),"autoRefreshEvents"in e&&(Y(Pe)||Y(Te,e.autoRefreshEvents||"none"),T=-1===(e.autoRefreshEvents+"").indexOf("resize"))},e.scrollerProxy=function(e,t){var r=d(e)[0],n=A.indexOf(r),o=N(r);~n&&A.splice(n,o?6:2),o?M.unshift(i,t,a,t,s,t):M.unshift(r,t)},e.matchMedia=function(e){var t,r,n,s,a;for(r in e)n=Be.indexOf(r),s=e[r],R=r,"all"===r?s():(t=i.matchMedia(r))&&(t.matches&&(a=s()),~n?(Be[n+1]=K(Be[n+1],s),Be[n+2]=K(Be[n+2],a)):(n=Be.length,Be.push(r,s,a),t.addListener?t.addListener(Ne):t.addEventListener("change",Ne)),Be[n+3]=t.matches),R=0;return Be},e.clearMatchMedia=function(e){e||(Be.length=0),(e=Be.indexOf(e))>=0&&Be.splice(e,4)},e}();ot.version="3.7.1",ot.saveStyles=function(e){return e?d(e).forEach((function(e){if(e&&e.style){var r=Xe.indexOf(e);r>=0&&Xe.splice(r,5),Xe.push(e,e.style.cssText,e.getBBox&&e.getAttribute("transform"),t.core.getCache(e),R)}})):Xe},ot.revert=function(e,t){return Ye(!e,t)},ot.create=function(e,t){return new ot(e,t)},ot.refresh=function(e){return e?Le():je(!0)},ot.update=Qe,ot.maxScroll=function(e,t){return G(e,t?ge:me)},ot.getScrollFunc=function(e,t){return W(d(e)[0],t?ge:me)},ot.getById=function(e){return Fe[e]},ot.getAll=function(){return Oe.slice(0)},ot.isScrolling=function(){return!!D},ot.addEventListener=function(e,t){var r=Ie[e]||(Ie[e]=[]);~r.indexOf(t)||r.push(t)},ot.removeEventListener=function(e,t){var r=Ie[e],i=r&&r.indexOf(t);i>=0&&r.splice(i,1)},ot.batch=function(e,r){var i,n=[],s={},a=r.interval||.016,o=r.batchMax||1e9,h=function(e,r){var i=[],n=[],s=t.delayedCall(a,(function(){r(i,n),i=[],n=[]})).pause();return function(e){i.length||s.restart(!0),i.push(e.trigger),n.push(e),o<=i.length&&s.progress(1)}};for(i in r)s[i]="on"===i.substr(0,2)&&H(r[i])&&"onRefreshInit"!==i?h(0,r[i]):r[i];return H(o)&&(o=o(),Te(ot,"refresh",(function(){return o=r.batchMax()}))),d(e).forEach((function(e){var t={};for(i in s)t[i]=s[i];t.trigger=e,n.push(ot.create(t))})),n},ot.sort=function(e){return Oe.sort(e||function(e,t){return-1e6*(e.vars.refreshPriority||0)+e.start-(t.start+-1e6*(t.vars.refreshPriority||0))})},B()&&t.registerPlugin(ot),e.ScrollTrigger=ot,e.default=ot,Object.defineProperty(e,"__esModule",{value:!0})})),function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).window=e.window||{})}(this,(function(e){var t=0;function r(){if(!(t>100)){if(100===t)console.warn("Curtains: too many warnings thrown, stop logging.");else{var e=Array.prototype.slice.call(arguments);console.warn.apply(console,e)}t++}}function i(){var e=Array.prototype.slice.call(arguments);console.error.apply(console,e)}function n(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16).toUpperCase()}))}function s(e){return 0==(e&e-1)}var a=function(){function e(t){if(_classCallCheck(this,e),this.type="Scene",t&&"Renderer"===t.type){if(!t.gl)return void i(this.type+": Renderer WebGL context is undefined",t)}else i(this.type+": Renderer not passed as first argument",t);this.renderer=t,this.gl=t.gl,this.initStacks()}return _createClass(e,[{key:"initStacks",value:function(){this.stacks={pingPong:[],renderTargets:[],opaque:[],transparent:[],renderPasses:[],scenePasses:[]}}},{key:"resetPlaneStacks",value:function(){this.stacks.pingPong=[],this.stacks.renderTargets=[],this.stacks.opaque=[],this.stacks.transparent=[];for(var e=0;e<this.renderer.planes.length;e++)this.addPlane(this.renderer.planes[e])}},{key:"resetShaderPassStacks",value:function(){this.stacks.scenePasses=[],this.stacks.renderPasses=[];for(var e=0;e<this.renderer.shaderPasses.length;e++)this.renderer.shaderPasses[e].index=e,this.renderer.shaderPasses[e]._isScenePass?this.stacks.scenePasses.push(this.renderer.shaderPasses[e]):this.stacks.renderPasses.push(this.renderer.shaderPasses[e]);0===this.stacks.scenePasses.length&&(this.renderer.state.scenePassIndex=null)}},{key:"addToRenderTargetsStack",value:function(e){var t=this.renderer.planes.filter((function(t){return"PingPongPlane"!==t.type&&t.target&&t.uuid!==e.uuid})),r=-1;if(e.target._depth){for(var i=t.length-1;i>=0;i--)if(t[i].target.uuid===e.target.uuid){r=i+1;break}}else r=t.findIndex((function(t){return t.target.uuid===e.target.uuid}));r=Math.max(0,r),t.splice(r,0,e),e.target._depth?(t.sort((function(e,t){return e.index-t.index})),t.sort((function(e,t){return t.renderOrder-e.renderOrder}))):(t.sort((function(e,t){return t.index-e.index})),t.sort((function(e,t){return e.renderOrder-t.renderOrder}))),t.sort((function(e,t){return e.target.index-t.target.index})),this.stacks.renderTargets=t}},{key:"addToRegularPlaneStack",value:function(e){for(var t=this.renderer.planes.filter((function(t){return"PingPongPlane"!==t.type&&!t.target&&t._transparent===e._transparent&&t.uuid!==e.uuid})),r=-1,i=t.length-1;i>=0;i--)if(t[i]._geometry.definition.id===e._geometry.definition.id){r=i+1;break}return r=Math.max(0,r),t.splice(r,0,e),t.sort((function(e,t){return e.index-t.index})),t}},{key:"addPlane",value:function(e){if("PingPongPlane"===e.type)this.stacks.pingPong.push(e);else if(e.target)this.addToRenderTargetsStack(e);else if(e._transparent){var t=this.addToRegularPlaneStack(e);t.sort((function(e,t){return t.relativeTranslation.z-e.relativeTranslation.z})),t.sort((function(e,t){return t.renderOrder-e.renderOrder})),this.stacks.transparent=t}else{var r=this.addToRegularPlaneStack(e);r.sort((function(e,t){return t.renderOrder-e.renderOrder})),this.stacks.opaque=r}}},{key:"removePlane",value:function(e){"PingPongPlane"===e.type?this.stacks.pingPong=this.stacks.pingPong.filter((function(t){return t.uuid!==e.uuid})):e.target?this.stacks.renderTargets=this.stacks.renderTargets.filter((function(t){return t.uuid!==e.uuid})):e._transparent?this.stacks.transparent=this.stacks.transparent.filter((function(t){return t.uuid!==e.uuid})):this.stacks.opaque=this.stacks.opaque.filter((function(t){return t.uuid!==e.uuid}))}},{key:"setPlaneRenderOrder",value:function(e){if("ShaderPass"===e.type)this.sortShaderPassStack(e._isScenePass?this.stacks.scenePasses:this.stacks.renderPasses);else if("PingPongPlane"===e.type)return;if(e.target)e.target._depth?(this.stacks.renderTargets.sort((function(e,t){return e.index-t.index})),this.stacks.renderTargets.sort((function(e,t){return t.renderOrder-e.renderOrder}))):(this.stacks.renderTargets.sort((function(e,t){return t.index-e.index})),this.stacks.renderTargets.sort((function(e,t){return e.renderOrder-t.renderOrder}))),this.stacks.renderTargets.sort((function(e,t){return e.target.index-t.target.index}));else{var t=e._transparent?this.stacks.transparent:this.stacks.opaque,r=this.stacks.scenePasses.find((function(e,t){return e._isScenePass&&!e._depth&&0===t}));!this.renderer.depth||r?(t.sort((function(e,t){return t.index-e.index})),e._transparent&&t.sort((function(e,t){return e.relativeTranslation.z-t.relativeTranslation.z})),t.sort((function(e,t){return e.renderOrder-t.renderOrder}))):(t.sort((function(e,t){return e.index-t.index})),e._transparent&&t.sort((function(e,t){return t.relativeTranslation.z-e.relativeTranslation.z})),t.sort((function(e,t){return t.renderOrder-e.renderOrder})))}}},{key:"addShaderPass",value:function(e){e._isScenePass?(this.stacks.scenePasses.push(e),this.sortShaderPassStack(this.stacks.scenePasses)):(this.stacks.renderPasses.push(e),this.sortShaderPassStack(this.stacks.renderPasses))}},{key:"removeShaderPass",value:function(e){this.resetShaderPassStacks()}},{key:"sortShaderPassStack",value:function(e){e.sort((function(e,t){return e.index-t.index})),e.sort((function(e,t){return e.renderOrder-t.renderOrder}))}},{key:"enableShaderPass",value:function(){this.stacks.scenePasses.length&&0===this.stacks.renderPasses.length&&this.renderer.planes.length&&(this.renderer.state.scenePassIndex=0,this.renderer.bindFrameBuffer(this.stacks.scenePasses[0].target))}},{key:"drawRenderPasses",value:function(){this.stacks.scenePasses.length&&this.stacks.renderPasses.length&&this.renderer.planes.length&&(this.renderer.state.scenePassIndex=0,this.renderer.bindFrameBuffer(this.stacks.scenePasses[0].target));for(var e=0;e<this.stacks.renderPasses.length;e++)this.stacks.renderPasses[e]._startDrawing(),this.renderer.clearDepth()}},{key:"drawScenePasses",value:function(){for(var e=0;e<this.stacks.scenePasses.length;e++)this.stacks.scenePasses[e]._startDrawing()}},{key:"drawPingPongStack",value:function(){for(var e=0;e<this.stacks.pingPong.length;e++){var t=this.stacks.pingPong[e];t&&t._startDrawing()}}},{key:"drawStack",value:function(e){for(var t=0;t<this.stacks[e].length;t++){var r=this.stacks[e][t];r&&r._startDrawing()}}},{key:"draw",value:function(){this.drawPingPongStack(),this.enableShaderPass(),this.drawStack("renderTargets"),this.drawRenderPasses(),this.renderer.setBlending(!1),this.drawStack("opaque"),this.stacks.transparent.length&&(this.renderer.setBlending(!0),this.drawStack("transparent")),this.drawScenePasses()}}]),e}(),o=function(){function e(){_classCallCheck(this,e),this.geometries=[],this.clear()}return _createClass(e,[{key:"clear",value:function(){this.textures=[],this.programs=[]}},{key:"getGeometryFromID",value:function(e){return this.geometries.find((function(t){return t.id===e}))}},{key:"addGeometry",value:function(e,t,r){this.geometries.push({id:e,vertices:t,uvs:r})}},{key:"isSameShader",value:function(e,t){return 0===e.localeCompare(t)}},{key:"getProgramFromShaders",value:function(e,t){var r=this;return this.programs.find((function(i){return r.isSameShader(i.vsCode,e)&&r.isSameShader(i.fsCode,t)}))}},{key:"addProgram",value:function(e){this.programs.push(e)}},{key:"getTextureFromSource",value:function(e){var t="string"==typeof e?e:e.src;return this.textures.find((function(e){return e.source&&e.source.src===t}))}},{key:"addTexture",value:function(e){this.getTextureFromSource(e.source)||this.textures.push(e)}},{key:"removeTexture",value:function(e){this.textures=this.textures.filter((function(t){return t.uuid!==e.uuid}))}}]),e}(),h=function(){function e(){_classCallCheck(this,e),this.clear()}return _createClass(e,[{key:"clear",value:function(){this.queue=[]}},{key:"add",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i={callback:e,keep:r,timeout:null};return i.timeout=setTimeout((function(){t.queue.push(i)}),0),i}},{key:"execute",value:function(){var e=this;this.queue.map((function(t){t.callback&&t.callback(),clearTimeout(e.queue.timeout)})),this.queue=this.queue.filter((function(e){return e.keep}))}}]),e}(),l=function(){function e(t){var i=t.alpha,n=t.antialias,s=t.premultipliedAlpha,a=t.depth,o=t.failIfMajorPerformanceCaveat,h=t.preserveDrawingBuffer,l=t.stencil,u=t.container,d=t.pixelRatio,c=t.renderingScale,f=t.production,p=t.onError,_=t.onSuccess,g=t.onContextLost,m=t.onContextRestored,v=t.onDisposed,y=t.onSceneChange;_classCallCheck(this,e),this.type="Renderer",this.alpha=i,this.antialias=n,this.premultipliedAlpha=s,this.depth=a,this.failIfMajorPerformanceCaveat=o,this.preserveDrawingBuffer=h,this.stencil=l,this.container=u,this.pixelRatio=d,this._renderingScale=c,this.production=f,this.onError=p,this.onSuccess=_,this.onContextLost=g,this.onContextRestored=m,this.onDisposed=v,this.onSceneChange=y,this.initState(),this.canvas=document.createElement("canvas");var x={alpha:this.alpha,premultipliedAlpha:this.premultipliedAlpha,antialias:this.antialias,depth:this.depth,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.preserveDrawingBuffer,stencil:this.stencil};if(this.gl=this.canvas.getContext("webgl2",x),this._isWebGL2=!!this.gl,this.gl||(this.gl=this.canvas.getContext("webgl",x)||this.canvas.getContext("experimental-webgl",x)),!this.gl)return this.production||r(this.type+": WebGL context could not be created"),this.state.isActive=!1,void(this.onError&&this.onError());this.onSuccess&&this.onSuccess(),this.initRenderer()}return _createClass(e,[{key:"initState",value:function(){this.state={isActive:!0,isContextLost:!0,drawingEnabled:!0,forceRender:!1,currentProgramID:null,currentGeometryID:null,forceBufferUpdate:!1,depthTest:null,blending:null,cullFace:null,frameBufferID:null,scenePassIndex:null,activeTexture:null,unpackAlignment:null,flipY:null,premultiplyAlpha:null}}},{key:"initCallbackQueueManager",value:function(){this.nextRender=new h}},{key:"initRenderer",value:function(){this.planes=[],this.renderTargets=[],this.shaderPasses=[],this.state.isContextLost=!1,this.initCallbackQueueManager(),this.setBlendFunc(),this.setDepthFunc(),this.setDepthTest(!0),this.cache=new o,this.scene=new a(this),this.getExtensions(),this._contextLostHandler=this.contextLost.bind(this),this.canvas.addEventListener("webglcontextlost",this._contextLostHandler,!1),this._contextRestoredHandler=this.contextRestored.bind(this),this.canvas.addEventListener("webglcontextrestored",this._contextRestoredHandler,!1)}},{key:"getExtensions",value:function(){this.extensions=[],this._isWebGL2?(this.extensions.EXT_color_buffer_float=this.gl.getExtension("EXT_color_buffer_float"),this.extensions.OES_texture_float_linear=this.gl.getExtension("OES_texture_float_linear"),this.extensions.EXT_texture_filter_anisotropic=this.gl.getExtension("EXT_texture_filter_anisotropic"),this.extensions.WEBGL_lose_context=this.gl.getExtension("WEBGL_lose_context")):(this.extensions.OES_vertex_array_object=this.gl.getExtension("OES_vertex_array_object"),this.extensions.OES_texture_float=this.gl.getExtension("OES_texture_float"),this.extensions.OES_texture_float_linear=this.gl.getExtension("OES_texture_float_linear"),this.extensions.OES_texture_half_float=this.gl.getExtension("OES_texture_half_float"),this.extensions.OES_texture_half_float_linear=this.gl.getExtension("OES_texture_half_float_linear"),this.extensions.EXT_texture_filter_anisotropic=this.gl.getExtension("EXT_texture_filter_anisotropic"),this.extensions.OES_element_index_uint=this.gl.getExtension("OES_element_index_uint"),this.extensions.OES_standard_derivatives=this.gl.getExtension("OES_standard_derivatives"),this.extensions.EXT_sRGB=this.gl.getExtension("EXT_sRGB"),this.extensions.WEBGL_depth_texture=this.gl.getExtension("WEBGL_depth_texture"),this.extensions.WEBGL_draw_buffers=this.gl.getExtension("WEBGL_draw_buffers"),this.extensions.WEBGL_lose_context=this.gl.getExtension("WEBGL_lose_context"))}},{key:"contextLost",value:function(e){var t=this;this.state.isContextLost=!0,this.state.isActive&&(e.preventDefault(),this.nextRender.add((function(){return t.onContextLost&&t.onContextLost()})))}},{key:"restoreContext",value:function(){this.state.isActive&&(this.initState(),this.gl&&this.extensions.WEBGL_lose_context?this.extensions.WEBGL_lose_context.restoreContext():(this.gl||this.production?this.extensions.WEBGL_lose_context||this.production||r(this.type+": Could not restore the context because the restore context extension is not defined"):r(this.type+": Could not restore the context because the context is not defined"),this.onError&&this.onError()))}},{key:"isContextexFullyRestored",value:function(){for(var e=!0,t=0;t<this.renderTargets.length;t++){this.renderTargets[t].textures[0]._canDraw||(e=!1);break}if(e)for(var r=0;r<this.planes.length;r++){if(!this.planes[r]._canDraw){e=!1;break}for(var i=0;i<this.planes[r].textures.length;i++)if(!this.planes[r].textures[i]._canDraw){e=!1;break}}if(e)for(var n=0;n<this.shaderPasses.length;n++){if(!this.shaderPasses[n]._canDraw){e=!1;break}for(var s=0;s<this.shaderPasses[n].textures.length;s++)if(!this.shaderPasses[n].textures[s]._canDraw){e=!1;break}}return e}},{key:"contextRestored",value:function(){var e=this;this.getExtensions(),this.setBlendFunc(),this.setDepthFunc(),this.setDepthTest(!0),this.cache.clear(),this.scene.initStacks();for(var t=0;t<this.renderTargets.length;t++)this.renderTargets[t]._restoreContext();for(var r=0;r<this.planes.length;r++)this.planes[r]._restoreContext();for(var i=0;i<this.shaderPasses.length;i++)this.shaderPasses[i]._restoreContext();var n=this.nextRender.add((function(){e.isContextexFullyRestored()&&(n.keep=!1,e.state.isContextLost=!1,e.onContextRestored&&e.onContextRestored(),e.onSceneChange(),e.needRender())}),!0)}},{key:"setPixelRatio",value:function(e){this.pixelRatio=e}},{key:"setSize",value:function(){if(this.gl){var e=this.container.getBoundingClientRect();this._boundingRect={width:e.width*this.pixelRatio,height:e.height*this.pixelRatio,top:e.top*this.pixelRatio,left:e.left*this.pixelRatio};var t=!!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/),r=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;t&&r&&(this._boundingRect.top=function(e){for(var t=0;e&&!isNaN(e.offsetTop);)t+=e.offsetTop-e.scrollTop,e=e.offsetParent;return t}(this.container)*this.pixelRatio),this.canvas.style.width=Math.floor(this._boundingRect.width/this.pixelRatio)+"px",this.canvas.style.height=Math.floor(this._boundingRect.height/this.pixelRatio)+"px",this.canvas.width=Math.floor(this._boundingRect.width*this._renderingScale),this.canvas.height=Math.floor(this._boundingRect.height*this._renderingScale),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}}},{key:"resize",value:function(){for(var e=0;e<this.planes.length;e++)this.planes[e]._canDraw&&this.planes[e].resize();for(var t=0;t<this.shaderPasses.length;t++)this.shaderPasses[t]._canDraw&&this.shaderPasses[t].resize();for(var r=0;r<this.renderTargets.length;r++)this.renderTargets[r].resize();this.needRender()}},{key:"clear",value:function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},{key:"clearDepth",value:function(){this.gl.clear(this.gl.DEPTH_BUFFER_BIT)}},{key:"clearColor",value:function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT)}},{key:"bindFrameBuffer",value:function(e,t){var r=null;e?(r=e.index)!==this.state.frameBufferID&&(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e._frameBuffer),this.gl.viewport(0,0,e._size.width,e._size.height),e._shouldClear&&!t&&this.clear()):null!==this.state.frameBufferID&&(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)),this.state.frameBufferID=r}},{key:"setDepthTest",value:function(e){e&&!this.state.depthTest?(this.state.depthTest=e,this.gl.enable(this.gl.DEPTH_TEST)):!e&&this.state.depthTest&&(this.state.depthTest=e,this.gl.disable(this.gl.DEPTH_TEST))}},{key:"setDepthFunc",value:function(){this.gl.depthFunc(this.gl.LEQUAL)}},{key:"setBlending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&!this.state.blending?(this.state.blending=e,this.gl.enable(this.gl.BLEND)):!e&&this.state.blending&&(this.state.blending=e,this.gl.disable(this.gl.BLEND))}},{key:"setBlendFunc",value:function(){this.gl.enable(this.gl.BLEND),this.premultipliedAlpha?this.gl.blendFuncSeparate(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA):this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)}},{key:"setFaceCulling",value:function(e){if(this.state.cullFace!==e)if(this.state.cullFace=e,"none"===e)this.gl.disable(this.gl.CULL_FACE);else{var t="front"===e?this.gl.FRONT:this.gl.BACK;this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(t)}}},{key:"useProgram",value:function(e){null!==this.state.currentProgramID&&this.state.currentProgramID===e.id||(this.gl.useProgram(e.program),this.state.currentProgramID=e.id)}},{key:"removePlane",value:function(e){this.gl&&(this.planes=this.planes.filter((function(t){return t.uuid!==e.uuid})),this.scene.removePlane(e),e=null,this.gl&&this.clear(),this.onSceneChange())}},{key:"removeRenderTarget",value:function(e){if(this.gl){for(var t=this.planes.find((function(t){return"PingPongPlane"!==t.type&&t.target&&t.target.uuid===e.uuid})),r=0;r<this.planes.length;r++)this.planes[r].target&&this.planes[r].target.uuid===e.uuid&&(this.planes[r].target=null);this.renderTargets=this.renderTargets.filter((function(t){return t.uuid!==e.uuid}));for(var i=0;i<this.renderTargets.length;i++)this.renderTargets[i].index=i;e=null,this.gl&&this.clear(),t&&this.scene.resetPlaneStacks(),this.onSceneChange()}}},{key:"removeShaderPass",value:function(e){this.gl&&(this.shaderPasses=this.shaderPasses.filter((function(t){return t.uuid!==e.uuid})),this.scene.removeShaderPass(e),e=null,this.gl&&this.clear(),this.onSceneChange())}},{key:"enableDrawing",value:function(){this.state.drawingEnabled=!0}},{key:"disableDrawing",value:function(){this.state.drawingEnabled=!1}},{key:"needRender",value:function(){this.state.forceRender=!0}},{key:"render",value:function(){this.gl&&(this.clear(),this.state.currentGeometryID=null,this.scene.draw())}},{key:"deletePrograms",value:function(){for(var e=0;e<this.cache.programs.length;e++){var t=this.cache.programs[e];this.gl.deleteProgram(t.program)}}},{key:"dispose",value:function(){var e=this;if(this.gl){for(this.state.isActive=!1;this.planes.length>0;)this.removePlane(this.planes[0]);for(;this.shaderPasses.length>0;)this.removeShaderPass(this.shaderPasses[0]);for(;this.renderTargets.length>0;)this.removeRenderTarget(this.renderTargets[0]);var t=this.nextRender.add((function(){0===e.planes.length&&0===e.shaderPasses.length&&0===e.renderTargets.length&&(t.keep=!1,e.deletePrograms(),e.clear(),e.canvas.removeEventListener("webgllost",e._contextLostHandler,!1),e.canvas.removeEventListener("webglrestored",e._contextRestoredHandler,!1),e.gl&&e.extensions.WEBGL_lose_context&&e.extensions.WEBGL_lose_context.loseContext(),e.canvas.width=e.canvas.width,e.gl=null,e.container.removeChild(e.canvas),e.container=null,e.canvas=null,e.onDisposed&&e.onDisposed())}),!0)}}}]),e}(),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.xOffset,i=void 0===r?0:r,n=t.yOffset,s=void 0===n?0:n,a=t.lastXDelta,o=void 0===a?0:a,h=t.lastYDelta,l=void 0===h?0:h,u=t.shouldWatch,d=void 0===u||u,c=t.onScroll,f=void 0===c?function(){}:c;_classCallCheck(this,e),this.xOffset=i,this.yOffset=s,this.lastXDelta=o,this.lastYDelta=l,this.shouldWatch=d,this.onScroll=f,this.handler=this.scroll.bind(this,!0),this.shouldWatch&&window.addEventListener("scroll",this.handler,{passive:!0})}return _createClass(e,[{key:"scroll",value:function(){this.updateScrollValues(window.pageXOffset,window.pageYOffset)}},{key:"updateScrollValues",value:function(e,t){var r=this.xOffset;this.xOffset=e,this.lastXDelta=r-this.xOffset;var i=this.yOffset;this.yOffset=t,this.lastYDelta=i-this.yOffset,this.onScroll&&this.onScroll(this.lastXDelta,this.lastYDelta)}},{key:"dispose",value:function(){this.shouldWatch&&window.removeEventListener("scroll",this.handler,{passive:!0})}}]),e}(),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.container,n=t.alpha,s=void 0===n||n,a=t.premultipliedAlpha,o=void 0!==a&&a,h=t.antialias,l=void 0===h||h,u=t.depth,d=void 0===u||u,c=t.failIfMajorPerformanceCaveat,f=void 0===c||c,p=t.preserveDrawingBuffer,_=void 0!==p&&p,g=t.stencil,m=void 0!==g&&g,v=t.autoResize,y=void 0===v||v,x=t.autoRender,b=void 0===x||x,k=t.watchScroll,w=void 0===k||k,T=t.pixelRatio,P=void 0===T?window.devicePixelRatio||1:T,R=t.renderingScale,S=void 0===R?1:R,C=t.production,E=void 0!==C&&C;_classCallCheck(this,e),this.type="Curtains",this._autoResize=y,this._autoRender=b,this._watchScroll=w,this.pixelRatio=P,S=isNaN(S)?1:parseFloat(S),this._renderingScale=Math.max(.25,Math.min(1,S)),this.premultipliedAlpha=o,this.alpha=s,this.antialias=l,this.depth=d,this.failIfMajorPerformanceCaveat=f,this.preserveDrawingBuffer=_,this.stencil=m,this.production=E,this.errors=!1,i?this.setContainer(i):this.production||r(this.type+": no container provided in the initial parameters. Use setContainer() method to set one later and initialize the WebGL context")}return _createClass(e,[{key:"setContainer",value:function(e){if(e)if("string"==typeof e)if(e=document.getElementById(e))this.container=e;else{var t=document.createElement("div");t.setAttribute("id","curtains-canvas"),document.body.appendChild(t),this.container=t,this.production||r('Curtains: no valid container HTML element or ID provided, created a div with "curtains-canvas" ID instead')}else e instanceof Element&&(this.container=e);else{var i=document.createElement("div");i.setAttribute("id","curtains-canvas"),document.body.appendChild(i),this.container=i,this.production||r('Curtains: no valid container HTML element or ID provided, created a div with "curtains-canvas" ID instead')}this._initCurtains()}},{key:"_initCurtains",value:function(){this.planes=[],this.renderTargets=[],this.shaderPasses=[],this._initRenderer(),this.gl&&(this._initScroll(),this._setSize(),this._addListeners(),this.container.appendChild(this.canvas),this._animationFrameID=null,this._autoRender&&this._animate())}},{key:"_initRenderer",value:function(){var e=this;this.renderer=new l({alpha:this.alpha,antialias:this.antialias,premultipliedAlpha:this.premultipliedAlpha,depth:this.depth,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.preserveDrawingBuffer,stencil:this.stencil,container:this.container,pixelRatio:this.pixelRatio,renderingScale:this._renderingScale,production:this.production,onError:function(){return e._onRendererError()},onSuccess:function(){return e._onRendererSuccess()},onContextLost:function(){return e._onRendererContextLost()},onContextRestored:function(){return e._onRendererContextRestored()},onDisposed:function(){return e._onRendererDisposed()},onSceneChange:function(){return e._keepSync()}}),this.gl=this.renderer.gl,this.canvas=this.renderer.canvas}},{key:"restoreContext",value:function(){this.renderer.restoreContext()}},{key:"_animate",value:function(){this.render(),this._animationFrameID=window.requestAnimationFrame(this._animate.bind(this))}},{key:"enableDrawing",value:function(){this.renderer.enableDrawing()}},{key:"disableDrawing",value:function(){this.renderer.disableDrawing()}},{key:"needRender",value:function(){this.renderer.needRender()}},{key:"nextRender",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.renderer.nextRender.add(e,t)}},{key:"clear",value:function(){this.renderer&&this.renderer.clear()}},{key:"clearDepth",value:function(){this.renderer&&this.renderer.clearDepth()}},{key:"clearColor",value:function(){this.renderer&&this.renderer.clearColor()}},{key:"isWebGL2",value:function(){return!!this.gl&&this.renderer._isWebGL2}},{key:"render",value:function(){this.renderer.nextRender.execute(),(this.renderer.state.drawingEnabled||this.renderer.state.forceRender)&&(this.renderer.state.forceRender&&(this.renderer.state.forceRender=!1),this._onRenderCallback&&this._onRenderCallback(),this.renderer.render())}},{key:"_addListeners",value:function(){this._resizeHandler=null,this._autoResize&&(this._resizeHandler=this.resize.bind(this,!0),window.addEventListener("resize",this._resizeHandler,!1))}},{key:"setPixelRatio",value:function(e,t){this.pixelRatio=parseFloat(Math.max(e,1))||1,this.renderer.setPixelRatio(e),this.resize(t)}},{key:"_setSize",value:function(){this.renderer.setSize(),this._scrollManager.shouldWatch&&(this._scrollManager.xOffset=window.pageXOffset,this._scrollManager.yOffset=window.pageYOffset)}},{key:"getBoundingRect",value:function(){return this.renderer._boundingRect}},{key:"resize",value:function(e){var t=this;this.gl&&(this._setSize(),this.renderer.resize(),this.nextRender((function(){t._onAfterResizeCallback&&e&&t._onAfterResizeCallback()})))}},{key:"_initScroll",value:function(){var e=this;this._scrollManager=new u({xOffset:window.pageXOffset,yOffset:window.pageYOffset,lastXDelta:0,lastYDelta:0,shouldWatch:this._watchScroll,onScroll:function(t,r){return e._updateScroll(t,r)}})}},{key:"_updateScroll",value:function(e,t){for(var r=0;r<this.planes.length;r++)this.planes[r].watchScroll&&this.planes[r].updateScrollPosition(e,t);this.renderer.needRender(),this._onScrollCallback&&this._onScrollCallback()}},{key:"updateScrollValues",value:function(e,t){this._scrollManager.updateScrollValues(e,t)}},{key:"getScrollDeltas",value:function(){return{x:this._scrollManager.lastXDelta,y:this._scrollManager.lastYDelta}}},{key:"getScrollValues",value:function(){return{x:this._scrollManager.xOffset,y:this._scrollManager.yOffset}}},{key:"_keepSync",value:function(){this.planes=this.renderer.planes,this.shaderPasses=this.renderer.shaderPasses,this.renderTargets=this.renderer.renderTargets}},{key:"lerp",value:function(e,t,r){return function(e,t,r){return(1-r)*e+r*t}(e,t,r)}},{key:"onAfterResize",value:function(e){return e&&(this._onAfterResizeCallback=e),this}},{key:"onError",value:function(e){return e&&(this._onErrorCallback=e),this}},{key:"_onRendererError",value:function(){var e=this;setTimeout((function(){e._onErrorCallback&&!e.errors&&e._onErrorCallback(),e.errors=!0}),0)}},{key:"onSuccess",value:function(e){return e&&(this._onSuccessCallback=e),this}},{key:"_onRendererSuccess",value:function(){var e=this;setTimeout((function(){e._onSuccessCallback&&e._onSuccessCallback()}),0)}},{key:"onContextLost",value:function(e){return e&&(this._onContextLostCallback=e),this}},{key:"_onRendererContextLost",value:function(){this._onContextLostCallback&&this._onContextLostCallback()}},{key:"onContextRestored",value:function(e){return e&&(this._onContextRestoredCallback=e),this}},{key:"_onRendererContextRestored",value:function(){this._onContextRestoredCallback&&this._onContextRestoredCallback()}},{key:"onRender",value:function(e){return e&&(this._onRenderCallback=e),this}},{key:"onScroll",value:function(e){return e&&(this._onScrollCallback=e),this}},{key:"dispose",value:function(){this.renderer.dispose()}},{key:"_onRendererDisposed",value:function(){this._animationFrameID&&window.cancelAnimationFrame(this._animationFrameID),this._resizeHandler&&window.removeEventListener("resize",this._resizeHandler,!1),this._scrollManager&&this._scrollManager.dispose()}}]),e}(),c=function(){function e(t,r,n){if(_classCallCheck(this,e),this.type="Uniforms",t&&"Renderer"===t.type){if(!t.gl)return void i(this.type+": Renderer WebGL context is undefined",t)}else i(this.type+": Renderer not passed as first argument",t);if(this.renderer=t,this.gl=t.gl,this.program=r,this.uniforms={},n)for(var s in n){var a=n[s];this.uniforms[s]={name:a.name,type:a.type,value:a.value.clone&&"function"==typeof a.value.clone?a.value.clone():a.value,update:null}}}return _createClass(e,[{key:"handleUniformSetting",value:function(e){switch(e.type){case"1i":e.update=this.setUniform1i.bind(this);break;case"1iv":e.update=this.setUniform1iv.bind(this);break;case"1f":e.update=this.setUniform1f.bind(this);break;case"1fv":e.update=this.setUniform1fv.bind(this);break;case"2i":e.update=this.setUniform2i.bind(this);break;case"2iv":e.update=this.setUniform2iv.bind(this);break;case"2f":e.update=this.setUniform2f.bind(this);break;case"2fv":e.update=this.setUniform2fv.bind(this);break;case"3i":e.update=this.setUniform3i.bind(this);break;case"3iv":e.update=this.setUniform3iv.bind(this);break;case"3f":e.update=this.setUniform3f.bind(this);break;case"3fv":e.update=this.setUniform3fv.bind(this);break;case"4i":e.update=this.setUniform4i.bind(this);break;case"4iv":e.update=this.setUniform4iv.bind(this);break;case"4f":e.update=this.setUniform4f.bind(this);break;case"4fv":e.update=this.setUniform4fv.bind(this);break;case"mat2":e.update=this.setUniformMatrix2fv.bind(this);break;case"mat3":e.update=this.setUniformMatrix3fv.bind(this);break;case"mat4":e.update=this.setUniformMatrix4fv.bind(this);break;default:this.renderer.production||r(this.type+": This uniform type is not handled : ",e.type)}}},{key:"setInternalFormat",value:function(e){"Vec2"===e.value.type?(e._internalFormat="Vec2",e.lastValue=e.value.clone()):"Vec3"===e.value.type?(e._internalFormat="Vec3",e.lastValue=e.value.clone()):"Mat4"===e.value.type?(e._internalFormat="Mat4",e.lastValue=e.value.clone()):"Quat"===e.value.type?(e._internalFormat="Quat",e.lastValue=e.value.clone()):Array.isArray(e.value)?(e._internalFormat="array",e.lastValue=Array.from(e.value)):e.value.constructor===Float32Array?(e._internalFormat="mat",e.lastValue=e.value):(e._internalFormat="float",e.lastValue=e.value)}},{key:"setUniforms",value:function(){if(this.uniforms)for(var e in this.uniforms){var t=this.uniforms[e];t.location=this.gl.getUniformLocation(this.program,t.name),t._internalFormat||this.setInternalFormat(t),t.type||("Vec2"===t._internalFormat?t.type="2f":"Vec3"===t._internalFormat?t.type="3f":"Mat4"===t._internalFormat?t.type="mat4":"array"===t._internalFormat?4===t.value.length?(t.type="4f",this.renderer.production||r(this.type+": No uniform type declared for "+t.name+", applied a 4f (array of 4 floats) uniform type")):3===t.value.length?(t.type="3f",this.renderer.production||r(this.type+": No uniform type declared for "+t.name+", applied a 3f (array of 3 floats) uniform type")):2===t.value.length&&(t.type="2f",this.renderer.production||r(this.type+": No uniform type declared for "+t.name+", applied a 2f (array of 2 floats) uniform type")):"mat"===t._internalFormat?16===t.value.length?(t.type="mat4",this.renderer.production||r(this.type+": No uniform type declared for "+t.name+", applied a mat4 (4x4 matrix array) uniform type")):9===t.value.length?(t.type="mat3",this.renderer.production||r(this.type+": No uniform type declared for "+t.name+", applied a mat3 (3x3 matrix array) uniform type")):4===t.value.length&&(t.type="mat2",this.renderer.production||r(this.type+": No uniform type declared for "+t.name+", applied a mat2 (2x2 matrix array) uniform type")):(t.type="1f",this.renderer.production||r(this.type+": No uniform type declared for "+t.name+", applied a 1f (float) uniform type"))),this.handleUniformSetting(t),t.update&&t.update(t)}}},{key:"updateUniforms",value:function(){if(this.uniforms)for(var e in this.uniforms){var t=this.uniforms[e],r=!1;"Vec2"===t._internalFormat||"Vec3"===t._internalFormat||"Quat"===t._internalFormat?t.value.equals(t.lastValue)||(r=!0,t.lastValue.copy(t.value)):t.value.length?JSON.stringify(t.value)!==JSON.stringify(t.lastValue)&&(r=!0,t.lastValue=Array.from(t.value)):t.value!==t.lastValue&&(r=!0,t.lastValue=t.value),r&&t.update&&t.update(t)}}},{key:"setUniform1i",value:function(e){this.gl.uniform1i(e.location,e.value)}},{key:"setUniform1iv",value:function(e){this.gl.uniform1iv(e.location,e.value)}},{key:"setUniform1f",value:function(e){this.gl.uniform1f(e.location,e.value)}},{key:"setUniform1fv",value:function(e){this.gl.uniform1fv(e.location,e.value)}},{key:"setUniform2i",value:function(e){"Vec2"===e._internalFormat?this.gl.uniform2i(e.location,e.value.x,e.value.y):this.gl.uniform2i(e.location,e.value[0],e.value[1])}},{key:"setUniform2iv",value:function(e){"Vec2"===e._internalFormat?this.gl.uniform2iv(e.location,[e.value.x,e.value.y]):this.gl.uniform2iv(e.location,e.value)}},{key:"setUniform2f",value:function(e){"Vec2"===e._internalFormat?this.gl.uniform2f(e.location,e.value.x,e.value.y):this.gl.uniform2f(e.location,e.value[0],e.value[1])}},{key:"setUniform2fv",value:function(e){"Vec2"===e._internalFormat?this.gl.uniform2fv(e.location,[e.value.x,e.value.y]):this.gl.uniform2fv(e.location,e.value)}},{key:"setUniform3i",value:function(e){"Vec3"===e._internalFormat?this.gl.uniform3i(e.location,e.value.x,e.value.y,e.value.z):this.gl.uniform3i(e.location,e.value[0],e.value[1],e.value[2])}},{key:"setUniform3iv",value:function(e){"Vec3"===e._internalFormat?this.gl.uniform3iv(e.location,[e.value.x,e.value.y,e.value.z]):this.gl.uniform3iv(e.location,e.value)}},{key:"setUniform3f",value:function(e){"Vec3"===e._internalFormat?this.gl.uniform3f(e.location,e.value.x,e.value.y,e.value.z):this.gl.uniform3f(e.location,e.value[0],e.value[1],e.value[2])}},{key:"setUniform3fv",value:function(e){"Vec3"===e._internalFormat?this.gl.uniform3fv(e.location,[e.value.x,e.value.y,e.value.z]):this.gl.uniform3fv(e.location,e.value)}},{key:"setUniform4i",value:function(e){"Quat"===e._internalFormat?this.gl.uniform4i(e.location,e.value.elements[0],e.value.elements[1],e.value.elements[2],e.value[3]):this.gl.uniform4i(e.location,e.value[0],e.value[1],e.value[2],e.value[3])}},{key:"setUniform4iv",value:function(e){"Quat"===e._internalFormat?this.gl.uniform4iv(e.location,[e.value.elements[0],e.value.elements[1],e.value.elements[2],e.value[3]]):this.gl.uniform4iv(e.location,e.value)}},{key:"setUniform4f",value:function(e){"Quat"===e._internalFormat?this.gl.uniform4f(e.location,e.value.elements[0],e.value.elements[1],e.value.elements[2],e.value[3]):this.gl.uniform4f(e.location,e.value[0],e.value[1],e.value[2],e.value[3])}},{key:"setUniform4fv",value:function(e){"Quat"===e._internalFormat?this.gl.uniform4fv(e.location,[e.value.elements[0],e.value.elements[1],e.value.elements[2],e.value[3]]):this.gl.uniform4fv(e.location,e.value)}},{key:"setUniformMatrix2fv",value:function(e){this.gl.uniformMatrix2fv(e.location,!1,e.value)}},{key:"setUniformMatrix3fv",value:function(e){this.gl.uniformMatrix3fv(e.location,!1,e.value)}},{key:"setUniformMatrix4fv",value:function(e){"Mat4"===e._internalFormat?this.gl.uniformMatrix4fv(e.location,!1,e.value.elements):this.gl.uniformMatrix4fv(e.location,!1,e.value)}}]),e}(),f="\nprecision mediump float;\n".replace(/\n/g,""),p="\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n".replace(/\n/g,""),_="\nvarying vec3 vVertexPosition;\nvarying vec2 vTextureCoord;\n".replace(/\n/g,""),g=(f+p+_+"\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\n\nvoid main() {\n    vTextureCoord = aTextureCoord;\n    vVertexPosition = aVertexPosition;\n    \n    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n}\n").replace(/\n/g,""),m=(f+_+"\nvoid main() {\n    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n}\n").replace(/\n/g,""),v=(f+p+_+"\nvoid main() {\n    vTextureCoord = aTextureCoord;\n    vVertexPosition = aVertexPosition;\n    \n    gl_Position = vec4(aVertexPosition, 1.0);\n}\n").replace(/\n/g,""),y=(f+_+"\nuniform sampler2D uRenderTexture;\n\nvoid main() {\n    gl_FragColor = texture2D(uRenderTexture, vTextureCoord);\n}\n").replace(/\n/g,""),x=0,b=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=n.parent,a=n.vertexShader,o=n.fragmentShader;if(_classCallCheck(this,e),this.type="Program",t&&"Renderer"===t.type){if(!t.gl)return void i(this.type+": Renderer WebGL context is undefined",t)}else i(this.type+": Renderer not passed as first argument",t);this.renderer=t,this.gl=this.renderer.gl,this.parent=s,this.defaultVsCode="Plane"===this.parent.type?g:v,this.defaultFsCode="Plane"===this.parent.type?m:y,a?this.vsCode=a:(this.renderer.production||"Plane"!==this.parent.type||r(this.parent.type+": No vertex shader provided, will use a default one"),this.vsCode=this.defaultVsCode),o?this.fsCode=o:(this.renderer.production||r(this.parent.type+": No fragment shader provided, will use a default one"),this.fsCode=this.defaultFsCode),this.compiled=!0,this.setupProgram()}return _createClass(e,[{key:"createShader",value:function(e,t){var n=this.gl.createShader(t);if(this.gl.shaderSource(n,e),this.gl.compileShader(n),!this.renderer.production&&!this.gl.getShaderParameter(n,this.gl.COMPILE_STATUS)){for(var s=t===this.gl.VERTEX_SHADER?"vertex shader":"fragment shader",a=this.gl.getShaderSource(n).split("\n"),o=0;o<a.length;o++)a[o]=o+1+": "+a[o];return a=a.join("\n"),r(this.type+": Errors occurred while compiling the",s,":\n",this.gl.getShaderInfoLog(n)),i(a),r(this.type+": Will use a default",s),this.createShader(t===this.gl.VERTEX_SHADER?this.defaultVsCode:this.defaultFsCode,t)}return n}},{key:"useNewShaders",value:function(){this.vertexShader=this.createShader(this.vsCode,this.gl.VERTEX_SHADER),this.fragmentShader=this.createShader(this.fsCode,this.gl.FRAGMENT_SHADER),this.vertexShader&&this.fragmentShader||this.renderer.production||r(this.type+": Unable to find or compile the vertex or fragment shader")}},{key:"setupProgram",value:function(){var e=this.renderer.cache.getProgramFromShaders(this.vsCode,this.fsCode);e?(this.vertexShader=e.vertexShader,this.fragmentShader=e.fragmentShader,this.activeUniforms=e.activeUniforms,this.activeAttributes=e.activeAttributes,this.createProgram()):(this.useNewShaders(),this.compiled&&(this.createProgram(),this.renderer.cache.addProgram(this)))}},{key:"createProgram",value:function(){if(x++,this.id=x,this.program=this.gl.createProgram(),this.gl.attachShader(this.program,this.vertexShader),this.gl.attachShader(this.program,this.fragmentShader),this.gl.linkProgram(this.program),!this.renderer.production&&!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))return r(this.type+": Unable to initialize the shader program: "+this.gl.getProgramInfoLog(this.program)),r(this.type+": Will use default vertex and fragment shaders"),this.vertexShader=this.createShader(this.defaultVsCode,this.gl.VERTEX_SHADER),this.fragmentShader=this.createShader(this.defaultFsCode,this.gl.FRAGMENT_SHADER),void this.createProgram();if(this.gl.deleteShader(this.vertexShader),this.gl.deleteShader(this.fragmentShader),!this.activeUniforms||!this.activeAttributes){this.activeUniforms={textures:[],textureMatrices:[]};for(var e=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_UNIFORMS),t=0;t<e;t++){var i=this.gl.getActiveUniform(this.program,t);i.type===this.gl.SAMPLER_2D&&this.activeUniforms.textures.push(i.name),i.type===this.gl.FLOAT_MAT4&&"uMVMatrix"!==i.name&&"uPMatrix"!==i.name&&this.activeUniforms.textureMatrices.push(i.name)}this.activeAttributes=[];for(var n=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),s=0;s<n;s++){var a=this.gl.getActiveAttrib(this.program,s);this.activeAttributes.push(a.name)}}}},{key:"createUniforms",value:function(e){this.uniformsManager=new c(this.renderer,this.program,e),this.setUniforms()}},{key:"setUniforms",value:function(){this.renderer.useProgram(this),this.uniformsManager.setUniforms()}},{key:"updateUniforms",value:function(){this.renderer.useProgram(this),this.uniformsManager.updateUniforms()}}]),e}(),k=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(r.program,r.width),s=void 0===n?1:n,a=r.height,o=void 0===a?1:a;if(_classCallCheck(this,e),this.type="Geometry",t&&"Renderer"===t.type){if(!t.gl)return void i(this.type+": Renderer WebGL context is undefined",t)}else i(this.type+": Renderer not passed as first argument",t);this.renderer=t,this.gl=this.renderer.gl,this.definition={id:s*o+s,width:s,height:o},this.setDefaultAttributes(),this.setVerticesUVs()}return _createClass(e,[{key:"restoreContext",value:function(e){this.program=null,this.setDefaultAttributes(),this.setVerticesUVs(),this.setProgram(e)}},{key:"setDefaultAttributes",value:function(){this.attributes={vertexPosition:{name:"aVertexPosition",size:3,isActive:!1},textureCoord:{name:"aTextureCoord",size:3,isActive:!1}}}},{key:"setVerticesUVs",value:function(){var e=this.renderer.cache.getGeometryFromID(this.definition.id);e?(this.attributes.vertexPosition.array=e.vertices,this.attributes.textureCoord.array=e.uvs):(this.computeVerticesUVs(),this.renderer.cache.addGeometry(this.definition.id,this.attributes.vertexPosition.array,this.attributes.textureCoord.array))}},{key:"setProgram",value:function(e){this.program=e,this.initAttributes(),this.renderer._isWebGL2?(this._vao=this.gl.createVertexArray(),this.gl.bindVertexArray(this._vao)):this.renderer.extensions.OES_vertex_array_object&&(this._vao=this.renderer.extensions.OES_vertex_array_object.createVertexArrayOES(),this.renderer.extensions.OES_vertex_array_object.bindVertexArrayOES(this._vao)),this.initializeBuffers()}},{key:"initAttributes",value:function(){for(var e in this.attributes){if(this.attributes[e].isActive=this.program.activeAttributes.includes(this.attributes[e].name),!this.attributes[e].isActive)return;this.attributes[e].location=this.gl.getAttribLocation(this.program.program,this.attributes[e].name),this.attributes[e].buffer=this.gl.createBuffer(),this.attributes[e].numberOfItems=this.definition.width*this.definition.height*this.attributes[e].size*2}}},{key:"computeVerticesUVs",value:function(){this.attributes.vertexPosition.array=[],this.attributes.textureCoord.array=[];for(var e=this.attributes.vertexPosition.array,t=this.attributes.textureCoord.array,r=0;r<this.definition.height;r++)for(var i=r/this.definition.height,n=0;n<this.definition.width;n++){var s=n/this.definition.width;t.push(s),t.push(i),t.push(0),e.push(2*(s-.5)),e.push(2*(i-.5)),e.push(0),t.push(s+1/this.definition.width),t.push(i),t.push(0),e.push(2*(s+1/this.definition.width-.5)),e.push(2*(i-.5)),e.push(0),t.push(s),t.push(i+1/this.definition.height),t.push(0),e.push(2*(s-.5)),e.push(2*(i+1/this.definition.height-.5)),e.push(0),t.push(s),t.push(i+1/this.definition.height),t.push(0),e.push(2*(s-.5)),e.push(2*(i+1/this.definition.height-.5)),e.push(0),t.push(s+1/this.definition.width),t.push(i),t.push(0),e.push(2*(s+1/this.definition.width-.5)),e.push(2*(i-.5)),e.push(0),t.push(s+1/this.definition.width),t.push(i+1/this.definition.height),t.push(0),e.push(2*(s+1/this.definition.width-.5)),e.push(2*(i+1/this.definition.height-.5)),e.push(0)}}},{key:"initializeBuffers",value:function(){if(this.attributes){for(var e in this.attributes){if(!this.attributes[e].isActive)return;this.gl.enableVertexAttribArray(this.attributes[e].location),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.attributes[e].buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.attributes[e].array),this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.attributes[e].location,this.attributes[e].size,this.gl.FLOAT,!1,0,0)}this.renderer.state.currentGeometryID=this.definition.id}}},{key:"bindBuffers",value:function(){if(this._vao)this.renderer._isWebGL2?this.gl.bindVertexArray(this._vao):this.renderer.extensions.OES_vertex_array_object.bindVertexArrayOES(this._vao);else for(var e in this.attributes){if(!this.attributes[e].isActive)return;this.gl.enableVertexAttribArray(this.attributes[e].location),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.attributes[e].buffer),this.gl.vertexAttribPointer(this.attributes[e].location,this.attributes[e].size,this.gl.FLOAT,!1,0,0)}this.renderer.state.currentGeometryID=this.definition.id}},{key:"draw",value:function(){this.gl.drawArrays(this.gl.TRIANGLES,0,this.attributes.vertexPosition.numberOfItems)}},{key:"dispose",value:function(){for(var e in this._vao&&(this.renderer._isWebGL2?this.gl.deleteVertexArray(this._vao):this.renderer.extensions.OES_vertex_array_object.deleteVertexArrayOES(this._vao)),this.attributes){if(!this.attributes[e].isActive)return;this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.attributes[e].buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,1,this.gl.STATIC_DRAW),this.gl.deleteBuffer(this.attributes[e].buffer)}this.attributes=null,this.renderer.state.currentGeometryID=null}}]),e}(),w=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);_classCallCheck(this,e),this.type="Mat4",this.elements=t}return _createClass(e,[{key:"setFromArray",value:function(e){for(var t=0;t<this.elements.length;t++)this.elements[t]=e[t];return this}},{key:"copy",value:function(e){var t=e.elements;return this.elements[0]=t[0],this.elements[1]=t[1],this.elements[2]=t[2],this.elements[3]=t[3],this.elements[4]=t[4],this.elements[5]=t[5],this.elements[6]=t[6],this.elements[7]=t[7],this.elements[8]=t[8],this.elements[9]=t[9],this.elements[10]=t[10],this.elements[11]=t[11],this.elements[12]=t[12],this.elements[13]=t[13],this.elements[14]=t[14],this.elements[15]=t[15],this}},{key:"clone",value:function(){return(new e).copy(this)}},{key:"multiply",value:function(t){var r=this.elements,i=t.elements,n=new e;return n.elements[0]=i[0]*r[0]+i[1]*r[4]+i[2]*r[8]+i[3]*r[12],n.elements[1]=i[0]*r[1]+i[1]*r[5]+i[2]*r[9]+i[3]*r[13],n.elements[2]=i[0]*r[2]+i[1]*r[6]+i[2]*r[10]+i[3]*r[14],n.elements[3]=i[0]*r[3]+i[1]*r[7]+i[2]*r[11]+i[3]*r[15],n.elements[4]=i[4]*r[0]+i[5]*r[4]+i[6]*r[8]+i[7]*r[12],n.elements[5]=i[4]*r[1]+i[5]*r[5]+i[6]*r[9]+i[7]*r[13],n.elements[6]=i[4]*r[2]+i[5]*r[6]+i[6]*r[10]+i[7]*r[14],n.elements[7]=i[4]*r[3]+i[5]*r[7]+i[6]*r[11]+i[7]*r[15],n.elements[8]=i[8]*r[0]+i[9]*r[4]+i[10]*r[8]+i[11]*r[12],n.elements[9]=i[8]*r[1]+i[9]*r[5]+i[10]*r[9]+i[11]*r[13],n.elements[10]=i[8]*r[2]+i[9]*r[6]+i[10]*r[10]+i[11]*r[14],n.elements[11]=i[8]*r[3]+i[9]*r[7]+i[10]*r[11]+i[11]*r[15],n.elements[12]=i[12]*r[0]+i[13]*r[4]+i[14]*r[8]+i[15]*r[12],n.elements[13]=i[12]*r[1]+i[13]*r[5]+i[14]*r[9]+i[15]*r[13],n.elements[14]=i[12]*r[2]+i[13]*r[6]+i[14]*r[10]+i[15]*r[14],n.elements[15]=i[12]*r[3]+i[13]*r[7]+i[14]*r[11]+i[15]*r[15],n}},{key:"getInverse",value:function(){var t=this.elements,r=new e,i=r.elements,n=t[0],s=t[1],a=t[2],o=t[3],h=t[4],l=t[5],u=t[6],d=t[7],c=t[8],f=t[9],p=t[10],_=t[11],g=t[12],m=t[13],v=t[14],y=t[15],x=n*l-s*h,b=n*u-a*h,k=n*d-o*h,w=s*u-a*l,T=s*d-o*l,P=a*d-o*u,R=c*m-f*g,S=c*v-p*g,C=c*y-_*g,E=f*v-p*m,M=f*y-_*m,A=p*y-_*v,O=x*A-b*M+k*E+w*C-T*S+P*R;return O?(O=1/O,i[0]=(l*A-u*M+d*E)*O,i[1]=(a*M-s*A-o*E)*O,i[2]=(m*P-v*T+y*w)*O,i[3]=(p*T-f*P-_*w)*O,i[4]=(u*C-h*A-d*S)*O,i[5]=(n*A-a*C+o*S)*O,i[6]=(v*k-g*P-y*b)*O,i[7]=(c*P-p*k+_*b)*O,i[8]=(h*M-l*C+d*R)*O,i[9]=(s*C-n*M-o*R)*O,i[10]=(g*T-m*k+y*x)*O,i[11]=(f*k-c*T-_*x)*O,i[12]=(l*S-h*E-u*R)*O,i[13]=(n*E-s*S+a*R)*O,i[14]=(m*b-g*w-v*x)*O,i[15]=(c*w-f*b+p*x)*O,r):null}},{key:"scale",value:function(e){var t=this.elements;return t[0]*=e.x,t[1]*=e.x,t[2]*=e.x,t[3]*=e.x,t[4]*=e.y,t[5]*=e.y,t[6]*=e.y,t[7]*=e.y,t[8]*=e.z,t[9]*=e.z,t[10]*=e.z,t[11]*=e.z,this}},{key:"compose",value:function(e,t,r){var i=this.elements,n=t.elements[0],s=t.elements[1],a=t.elements[2],o=t.elements[3],h=n+n,l=s+s,u=a+a,d=n*h,c=n*l,f=n*u,p=s*l,_=s*u,g=a*u,m=o*h,v=o*l,y=o*u,x=r.x,b=r.y,k=r.z;return i[0]=(1-(p+g))*x,i[1]=(c+y)*x,i[2]=(f-v)*x,i[3]=0,i[4]=(c-y)*b,i[5]=(1-(d+g))*b,i[6]=(_+m)*b,i[7]=0,i[8]=(f+v)*k,i[9]=(_-m)*k,i[10]=(1-(d+p))*k,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}},{key:"composeFromOrigin",value:function(e,t,r,i){var n=this.elements,s=t.elements[0],a=t.elements[1],o=t.elements[2],h=t.elements[3],l=s+s,u=a+a,d=o+o,c=s*l,f=s*u,p=s*d,_=a*u,g=a*d,m=o*d,v=h*l,y=h*u,x=h*d,b=r.x,k=r.y,w=r.z,T=i.x,P=i.y,R=i.z,S=(1-(_+m))*b,C=(f+x)*b,E=(p-y)*b,M=(f-x)*k,A=(1-(c+m))*k,O=(g+v)*k,F=(p+y)*w,D=(g-v)*w,z=(1-(c+_))*w;return n[0]=S,n[1]=C,n[2]=E,n[3]=0,n[4]=M,n[5]=A,n[6]=O,n[7]=0,n[8]=F,n[9]=D,n[10]=z,n[11]=0,n[12]=e.x+T-(S*T+M*P+F*R),n[13]=e.y+P-(C*T+A*P+D*R),n[14]=e.z+R-(E*T+O*P+z*R),n[15]=1,this}}]),e}(),T=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;_classCallCheck(this,e),this.type="Vec2",this._x=t,this._y=r}return _createClass(e,[{key:"onChange",value:function(e){return e&&(this._onChangeCallback=e),this}},{key:"set",value:function(e,t){return this._x=e,this._y=t,this}},{key:"add",value:function(e){return this._x+=e.x,this._y+=e.y,this}},{key:"addScalar",value:function(e){return this._x+=e,this._y+=e,this}},{key:"sub",value:function(e){return this._x-=e.x,this._y-=e.y,this}},{key:"subScalar",value:function(e){return this._x-=e,this._y-=e,this}},{key:"multiply",value:function(e){return this._x*=e.x,this._y*=e.y,this}},{key:"multiplyScalar",value:function(e){return this._x*=e,this._y*=e,this}},{key:"copy",value:function(e){return this._x=e.x,this._y=e.y,this}},{key:"clone",value:function(){return new e(this._x,this._y)}},{key:"sanitizeNaNValuesWith",value:function(e){return this._x=isNaN(this._x)?e.x:parseFloat(this._x),this._y=isNaN(this._y)?e.y:parseFloat(this._y),this}},{key:"max",value:function(e){return this._x=Math.max(this._x,e.x),this._y=Math.max(this._y,e.y),this}},{key:"min",value:function(e){return this._x=Math.min(this._x,e.x),this._y=Math.min(this._y,e.y),this}},{key:"equals",value:function(e){return this._x===e.x&&this._y===e.y}},{key:"normalize",value:function(){var e=this._x*this._x+this._y*this._y;return e>0&&(e=1/Math.sqrt(e)),this._x*=e,this._y*=e,this}},{key:"dot",value:function(e){return this._x*e.x+this._y*e.y}},{key:"x",get:function(){return this._x},set:function(e){var t=e!==this._x;this._x=e,t&&this._onChangeCallback&&this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){var t=e!==this._y;this._y=e,t&&this._onChangeCallback&&this._onChangeCallback()}}]),e}(),P=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;_classCallCheck(this,e),this.type="Vec3",this._x=t,this._y=r,this._z=i}return _createClass(e,[{key:"onChange",value:function(e){return e&&(this._onChangeCallback=e),this}},{key:"set",value:function(e,t,r){return this._x=e,this._y=t,this._z=r,this}},{key:"add",value:function(e){return this._x+=e.x,this._y+=e.y,this._z+=e.z,this}},{key:"addScalar",value:function(e){return this._x+=e,this._y+=e,this._z+=e,this}},{key:"sub",value:function(e){return this._x-=e.x,this._y-=e.y,this._z-=e.z,this}},{key:"subScalar",value:function(e){return this._x-=e,this._y-=e,this._z-=e,this}},{key:"multiply",value:function(e){return this._x*=e.x,this._y*=e.y,this._z*=e.z,this}},{key:"multiplyScalar",value:function(e){return this._x*=e,this._y*=e,this._z*=e,this}},{key:"copy",value:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this}},{key:"clone",value:function(){return new e(this._x,this._y,this._z)}},{key:"sanitizeNaNValuesWith",value:function(e){return this._x=isNaN(this._x)?e.x:parseFloat(this._x),this._y=isNaN(this._y)?e.y:parseFloat(this._y),this._z=isNaN(this._z)?e.z:parseFloat(this._z),this}},{key:"max",value:function(e){return this._x=Math.max(this._x,e.x),this._y=Math.max(this._y,e.y),this._z=Math.max(this._z,e.z),this}},{key:"min",value:function(e){return this._x=Math.min(this._x,e.x),this._y=Math.min(this._y,e.y),this._z=Math.min(this._z,e.z),this}},{key:"equals",value:function(e){return this._x===e.x&&this._y===e.y&&this._z===e.z}},{key:"normalize",value:function(){var e=this._x*this._x+this._y*this._y+this._z*this._z;return e>0&&(e=1/Math.sqrt(e)),this._x*=e,this._y*=e,this._z*=e,this}},{key:"dot",value:function(e){return this._x*e.x+this._y*e.y+this._z*e.z}},{key:"applyMat4",value:function(e){var t=this._x,r=this._y,i=this._z,n=e.elements,s=n[3]*t+n[7]*r+n[11]*i+n[15];return s=s||1,this._x=(n[0]*t+n[4]*r+n[8]*i+n[12])/s,this._y=(n[1]*t+n[5]*r+n[9]*i+n[13])/s,this._z=(n[2]*t+n[6]*r+n[10]*i+n[14])/s,this}},{key:"applyQuat",value:function(e){var t=this._x,r=this._y,i=this._z,n=e.elements[0],s=e.elements[1],a=e.elements[2],o=e.elements[3],h=o*t+s*i-a*r,l=o*r+a*t-n*i,u=o*i+n*r-s*t,d=-n*t-s*r-a*i;return this._x=h*o+d*-n+l*-a-u*-s,this._y=l*o+d*-s+u*-n-h*-a,this._z=u*o+d*-a+h*-s-l*-n,this}},{key:"project",value:function(e){return this.applyMat4(e.viewMatrix).applyMat4(e.projectionMatrix),this}},{key:"unproject",value:function(e){return this.applyMat4(e.projectionMatrix.getInverse()).applyMat4(e.worldMatrix),this}},{key:"x",get:function(){return this._x},set:function(e){var t=e!==this._x;this._x=e,t&&this._onChangeCallback&&this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){var t=e!==this._y;this._y=e,t&&this._onChangeCallback&&this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){var t=e!==this._z;this._z=e,t&&this._onChangeCallback&&this._onChangeCallback()}}]),e}(),R=new T,S=new P,C=new w,E=function(){function e(t){var r=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=s.isFBOTexture,o=void 0!==a&&a,h=s.fromTexture,l=void 0!==h&&h,u=s.loader,d=s.sampler,c=s.floatingPoint,f=void 0===c?"none":c,p=s.premultiplyAlpha,_=void 0!==p&&p,g=s.anisotropy,m=void 0===g?1:g,v=s.generateMipmap,y=void 0===v?null:v,x=s.wrapS,b=s.wrapT,k=s.minFilter,P=s.magFilter;if(_classCallCheck(this,e),this.type="Texture",(t=t&&t.renderer||t)&&"Renderer"===t.type){if(!t.gl)return void(t.production||i(this.type+": Unable to create a "+this.type+" because the Renderer WebGL context is not defined"))}else i(this.type+": Renderer not passed as first argument",t);if(this.renderer=t,this.gl=this.renderer.gl,this.uuid=n(),this._globalParameters={unpackAlignment:4,flipY:!o,premultiplyAlpha:!1,shouldPremultiplyAlpha:_,floatingPoint:f,type:this.gl.UNSIGNED_BYTE,internalFormat:this.gl.RGBA,format:this.gl.RGBA},this.parameters={anisotropy:m,generateMipmap:y,wrapS:x||this.gl.CLAMP_TO_EDGE,wrapT:b||this.gl.CLAMP_TO_EDGE,minFilter:k||this.gl.LINEAR,magFilter:P||this.gl.LINEAR,_shouldUpdate:!0},this._initState(),this.sourceType=o?"fbo":"empty",this._useCache=!0,this._samplerName=d,this._sampler={isActive:!1,isTextureBound:!1,texture:this.gl.createTexture()},this._textureMatrix={matrix:new w,isActive:!1},this._size={width:1,height:1},this.scale=new T(1),this.scale.onChange((function(){return r.resize()})),this.offset=new T,this.offset.onChange((function(){return r.resize()})),this._loader=u,this._sourceLoaded=!1,this._uploaded=!1,this._willUpdate=!1,this.shouldUpdate=!1,this._forceUpdate=!1,this.userData={},this._canDraw=!1,l)return this._copyOnInit=!0,void(this._copiedFrom=l);this._copyOnInit=!1,this._initTexture()}return _createClass(e,[{key:"_initState",value:function(){this._state={anisotropy:1,generateMipmap:!1,wrapS:null,wrapT:null,minFilter:null,magFilter:this.gl.LINEAR}}},{key:"_initTexture",value:function(){this.gl.bindTexture(this.gl.TEXTURE_2D,this._sampler.texture),"empty"===this.sourceType&&(this._globalParameters.flipY=!1,this._updateGlobalTexParameters(),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array([0,0,0,255])),this._canDraw=!0)}},{key:"_restoreFromTexture",value:function(){this._copyOnInit||this._initTexture(),this._parent&&(this._setTextureUniforms(),this._setSize()),this.copy(this._copiedFrom),this._canDraw=!0}},{key:"_restoreContext",value:function(){var e=this;if(this._canDraw=!1,this._sampler.texture=this.gl.createTexture(),this._sampler.isActive=!1,this._sampler.isTextureBound=!1,this._textureMatrix.isActive=!1,this._initState(),this._state.generateMipmap=!1,this.parameters._shouldUpdate=!0,this._copiedFrom)var t=this.renderer.nextRender.add((function(){e._copiedFrom._canDraw&&(e._restoreFromTexture(),t.keep=!1)}),!0);else this._initTexture(),this._parent&&this._setParent(),this.source&&(this.setSource(this.source),"image"===this.sourceType?this.renderer.cache.addTexture(this):this.needUpdate()),this._canDraw=!0}},{key:"addParent",value:function(e){!e||"Plane"!==e.type&&"PingPongPlane"!==e.type&&"ShaderPass"!==e.type&&"RenderTarget"!==e.type?this.renderer.production||r(this.type+": cannot add texture as a child of ",e," because it is not a valid parent"):(this._parent=e,this.index=this._parent.textures.length,this._parent.textures.push(this),this._setParent())}},{key:"_setParent",value:function(){var e=this;if(this._sampler.name=this._samplerName||"uSampler"+this.index,this._textureMatrix.name=this._samplerName?this._samplerName+"Matrix":"uTextureMatrix"+this.index,this._parent._program){if(!this._parent._program.compiled)return void(this.renderer.production||r(this.type+": Unable to create the texture because the program is not valid"));if(this._setTextureUniforms(),this._copyOnInit){var t=this.renderer.nextRender.add((function(){e._copiedFrom._canDraw&&e._copiedFrom._uploaded&&(e.copy(e._copiedFrom),t.keep=!1)}),!0);return}this.source?this._parent.loader&&this._parent.loader._addSourceToParent(this.source,this.sourceType):this._size={width:this._parent._boundingRect.document.width,height:this._parent._boundingRect.document.height},this._setSize()}else"RenderTarget"===this._parent.type&&(this._size={width:this._parent._size&&this._parent._size.width||this.renderer._boundingRect.width,height:this._parent._size&&this._parent._size.height||this.renderer._boundingRect.height},this._upload(),this._updateTexParameters(),this._canDraw=!0)}},{key:"hasParent",value:function(){return!!this._parent}},{key:"_setTextureUniforms",value:function(){for(var e=this,t=this._parent._program.activeUniforms,r=0;r<t.textures.length;r++)t.textures[r]===this._sampler.name&&(this._sampler.isActive=!0,this.renderer.useProgram(this._parent._program),this._sampler.location=this.gl.getUniformLocation(this._parent._program.program,this._sampler.name),t.textureMatrices.find((function(t){return t===e._textureMatrix.name}))&&(this._textureMatrix.isActive=!0,this._textureMatrix.location=this.gl.getUniformLocation(this._parent._program.program,this._textureMatrix.name)),this.gl.uniform1i(this._sampler.location,this.index))}},{key:"copy",value:function(e){e&&"Texture"===e.type?(this._globalParameters=e._globalParameters,this._state=e._state,this._size=e._size,!this._sourceLoaded&&e._sourceLoaded&&this._onSourceLoadedCallback&&this._onSourceLoadedCallback(),this._sourceLoaded=e._sourceLoaded,!this._uploaded&&e._uploaded&&this._onSourceUploadedCallback&&this._onSourceUploadedCallback(),this._uploaded=e._uploaded,this.sourceType=e.sourceType,this.source=e.source,this._videoFrameCallbackID=e._videoFrameCallbackID,this._sampler.texture=e._sampler.texture,this._copiedFrom=e,!this._parent||!this._parent._program||this._canDraw&&this._textureMatrix.matrix||(this._setSize(),this._canDraw=!0),this.renderer.needRender()):this.renderer.production||r(this.type+": Unable to set the texture from texture:",e)}},{key:"setSource",value:function(e){var t=this;this._sourceLoaded||this.renderer.nextRender.add((function(){return t._onSourceLoadedCallback&&t._onSourceLoadedCallback()}));var i="IMG"===e.tagName.toUpperCase()?"image":e.tagName.toLowerCase();if("video"!==i&&"canvas"!==i||(this._useCache=!1),this._useCache){var n=this.renderer.cache.getTextureFromSource(e);if(n&&n.uuid!==this.uuid)return this._uploaded||(this.renderer.nextRender.add((function(){return t._onSourceUploadedCallback&&t._onSourceUploadedCallback()})),this._uploaded=!0),this.copy(n),void this.resize()}if("empty"===this.sourceType||this.sourceType!==i)if("video"===i)this._willUpdate=!1,this.shouldUpdate=!0;else if("canvas"===i)this._willUpdate=!0,this.shouldUpdate=!0;else{if("image"!==i)return void(this.renderer.production||r(this.type+": this HTML tag could not be converted into a texture:",e.tagName));this._willUpdate=!1,this.shouldUpdate=!1}this.source=e,this.sourceType=i,this._size={width:this.source.naturalWidth||this.source.width||this.source.videoWidth,height:this.source.naturalHeight||this.source.height||this.source.videoHeight},this._sourceLoaded=!0,this.gl.bindTexture(this.gl.TEXTURE_2D,this._sampler.texture),this.resize(),this._globalParameters.flipY=!0,this._globalParameters.premultiplyAlpha=this._globalParameters.shouldPremultiplyAlpha,"image"===this.sourceType&&(this.parameters.generateMipmap=this.parameters.generateMipmap||null===this.parameters.generateMipmap,this.parameters._shouldUpdate=this.parameters.generateMipmap,this._state.generateMipmap=!1,this._upload()),this.renderer.needRender()}},{key:"_updateGlobalTexParameters",value:function(){this.renderer.state.unpackAlignment!==this._globalParameters.unpackAlignment&&(this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,this._globalParameters.unpackAlignment),this.renderer.state.unpackAlignment=this._globalParameters.unpackAlignment),this.renderer.state.flipY!==this._globalParameters.flipY&&(this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,this._globalParameters.flipY),this.renderer.state.flipY=this._globalParameters.flipY),this.renderer.state.premultiplyAlpha!==this._globalParameters.premultiplyAlpha&&(this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._globalParameters.premultiplyAlpha),this.renderer.state.premultiplyAlpha=this._globalParameters.premultiplyAlpha),"half-float"===this._globalParameters.floatingPoint?this.renderer._isWebGL2&&this.renderer.extensions.EXT_color_buffer_float?(this._globalParameters.internalFormat=this.gl.RGBA16F,this._globalParameters.type=this.gl.HALF_FLOAT):this.renderer.extensions.OES_texture_half_float?this._globalParameters.type=this.renderer.extensions.OES_texture_half_float.HALF_FLOAT_OES:this.renderer.production||r(this.type+": could not use half-float textures because the extension is not available"):"float"===this._globalParameters.floatingPoint&&(this.renderer._isWebGL2&&this.renderer.extensions.EXT_color_buffer_float?(this._globalParameters.internalFormat=this.gl.RGBA16F,this._globalParameters.type=this.gl.FLOAT):this.renderer.extensions.OES_texture_float?this._globalParameters.type=this.renderer.extensions.OES_texture_half_float.FLOAT:this.renderer.production||r(this.type+": could not use float textures because the extension is not available"))}},{key:"_updateTexParameters",value:function(){this.index&&this.renderer.state.activeTexture!==this.index&&this._bindTexture(),this.parameters.wrapS!==this._state.wrapS&&(this.renderer._isWebGL2||s(this._size.width)&&s(this._size.height)||(this.parameters.wrapS=this.gl.CLAMP_TO_EDGE),this.parameters.wrapS!==this.gl.REPEAT&&this.parameters.wrapS!==this.gl.CLAMP_TO_EDGE&&this.parameters.wrapS!==this.gl.MIRRORED_REPEAT&&(this.renderer.production||r(this.type+": Wrong wrapS value",this.parameters.wrapS,"for this texture:",this,"\ngl.CLAMP_TO_EDGE wrapping will be used instead"),this.parameters.wrapS=this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.parameters.wrapS),this._state.wrapS=this.parameters.wrapS),this.parameters.wrapT!==this._state.wrapT&&(this.renderer._isWebGL2||s(this._size.width)&&s(this._size.height)||(this.parameters.wrapT=this.gl.CLAMP_TO_EDGE),this.parameters.wrapT!==this.gl.REPEAT&&this.parameters.wrapT!==this.gl.CLAMP_TO_EDGE&&this.parameters.wrapT!==this.gl.MIRRORED_REPEAT&&(this.renderer.production||r(this.type+": Wrong wrapT value",this.parameters.wrapT,"for this texture:",this,"\ngl.CLAMP_TO_EDGE wrapping will be used instead"),this.parameters.wrapT=this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.parameters.wrapT),this._state.wrapT=this.parameters.wrapT),this.parameters.generateMipmap&&!this._state.generateMipmap&&this.source&&(this.renderer._isWebGL2||s(this._size.width)&&s(this._size.height)?this.gl.generateMipmap(this.gl.TEXTURE_2D):this.parameters.generateMipmap=!1,this._state.generateMipmap=this.parameters.generateMipmap),this.parameters.minFilter!==this._state.minFilter&&(this.renderer._isWebGL2||s(this._size.width)&&s(this._size.height)||(this.parameters.minFilter=this.gl.LINEAR),this.parameters.generateMipmap||null===this.parameters.generateMipmap||(this.parameters.minFilter=this.gl.LINEAR),this.parameters.minFilter!==this.gl.LINEAR&&this.parameters.minFilter!==this.gl.NEAREST&&this.parameters.minFilter!==this.gl.NEAREST_MIPMAP_NEAREST&&this.parameters.minFilter!==this.gl.LINEAR_MIPMAP_NEAREST&&this.parameters.minFilter!==this.gl.NEAREST_MIPMAP_LINEAR&&this.parameters.minFilter!==this.gl.LINEAR_MIPMAP_LINEAR&&(this.renderer.production||r(this.type+": Wrong minFilter value",this.parameters.minFilter,"for this texture:",this,"\ngl.LINEAR filtering will be used instead"),this.parameters.minFilter=this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.parameters.minFilter),this._state.minFilter=this.parameters.minFilter),this.parameters.magFilter!==this._state.magFilter&&(this.renderer._isWebGL2||s(this._size.width)&&s(this._size.height)||(this.parameters.magFilter=this.gl.LINEAR),this.parameters.magFilter!==this.gl.LINEAR&&this.parameters.magFilter!==this.gl.NEAREST&&(this.renderer.production||r(this.type+": Wrong magFilter value",this.parameters.magFilter,"for this texture:",this,"\ngl.LINEAR filtering will be used instead"),this.parameters.magFilter=this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.parameters.magFilter),this._state.magFilter=this.parameters.magFilter);var e=this.renderer.extensions.EXT_texture_filter_anisotropic;if(e&&this.parameters.anisotropy!==this._state.anisotropy){var t=this.gl.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.parameters.anisotropy=Math.max(1,Math.min(this.parameters.anisotropy,t)),this.gl.texParameterf(this.gl.TEXTURE_2D,e.TEXTURE_MAX_ANISOTROPY_EXT,this.parameters.anisotropy),this._state.anisotropy=this.parameters.anisotropy}}},{key:"setWrapS",value:function(e){this.parameters.wrapS!==e&&(this.parameters.wrapS=e,this.parameters._shouldUpdate=!0)}},{key:"setWrapT",value:function(e){this.parameters.wrapT!==e&&(this.parameters.wrapT=e,this.parameters._shouldUpdate=!0)}},{key:"setMinFilter",value:function(e){this.parameters.minFilter!==e&&(this.parameters.minFilter=e,this.parameters._shouldUpdate=!0)}},{key:"setMagFilter",value:function(e){this.parameters.magFilter!==e&&(this.parameters.magFilter=e,this.parameters._shouldUpdate=!0)}},{key:"setAnisotropy",value:function(e){e=isNaN(e)?this.parameters.anisotropy:e,this.parameters.anisotropy!==e&&(this.parameters.anisotropy=e,this.parameters._shouldUpdate=!0)}},{key:"needUpdate",value:function(){this._forceUpdate=!0}},{key:"_videoFrameCallback",value:function(){var e=this;this._willUpdate=!0,this.source.requestVideoFrameCallback((function(){return e._videoFrameCallback()}))}},{key:"_upload",value:function(){var e=this;this._updateGlobalTexParameters(),this.source?this.gl.texImage2D(this.gl.TEXTURE_2D,0,this._globalParameters.internalFormat,this._globalParameters.format,this._globalParameters.type,this.source):"fbo"===this.sourceType&&this.gl.texImage2D(this.gl.TEXTURE_2D,0,this._globalParameters.internalFormat,this._size.width,this._size.height,0,this._globalParameters.format,this._globalParameters.type,this.source||null),this._uploaded||(this.renderer.nextRender.add((function(){return e._onSourceUploadedCallback&&e._onSourceUploadedCallback()})),this._uploaded=!0)}},{key:"_getSizes",value:function(){if("fbo"===this.sourceType)return{parentWidth:this._parent._boundingRect.document.width,parentHeight:this._parent._boundingRect.document.height,sourceWidth:this._parent._boundingRect.document.width,sourceHeight:this._parent._boundingRect.document.height,xOffset:0,yOffset:0};var e=this._parent.scale?R.set(this._parent.scale.x,this._parent.scale.y):R.set(1,1),t=this._parent._boundingRect.document.width*e.x,r=this._parent._boundingRect.document.height*e.y,i=this._size.width,n=this._size.height,s=i/n,a=t/r,o=0,h=0;return a>s?h=Math.min(0,r-t*(1/s)):a<s&&(o=Math.min(0,t-r*s)),{parentWidth:t,parentHeight:r,sourceWidth:i,sourceHeight:n,xOffset:o,yOffset:h}}},{key:"setScale",value:function(e){e.type&&"Vec2"===e.type?(e.sanitizeNaNValuesWith(this.scale).max(R.set(.001,.001)),e.equals(this.scale)||(this.scale.copy(e),this.resize())):this.renderer.production||r(this.type+": Cannot set scale because the parameter passed is not of Vec2 type:",e)}},{key:"setOffset",value:function(e){e.type&&"Vec2"===e.type?(e.sanitizeNaNValuesWith(this.offset),e.equals(this.offset)||(this.offset.copy(e),this.resize())):this.renderer.production||r(this.type+": Cannot set offset because the parameter passed is not of Vec2 type:",scale)}},{key:"_setSize",value:function(){if(this._parent&&this._parent._program){var e=this._getSizes();this._updateTextureMatrix(e)}}},{key:"resize",value:function(){"fbo"===this.sourceType?(this._size={width:this._parent._size&&this._parent._size.width||this._parent._boundingRect.document.width,height:this._parent._size&&this._parent._size.height||this._parent._boundingRect.document.height},this._copiedFrom||(this.gl.bindTexture(this.gl.TEXTURE_2D,this._sampler.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this._globalParameters.internalFormat,this._size.width,this._size.height,0,this._globalParameters.format,this._globalParameters.type,null))):this.source&&(this._size={width:this.source.naturalWidth||this.source.width||this.source.videoWidth,height:this.source.naturalHeight||this.source.height||this.source.videoHeight}),this._setSize()}},{key:"_updateTextureMatrix",value:function(e){var t=S.set(e.parentWidth/(e.parentWidth-e.xOffset),e.parentHeight/(e.parentHeight-e.yOffset),1);t.x/=this.scale.x,t.y/=this.scale.y,this._textureMatrix.matrix=C.setFromArray([t.x,0,0,0,0,t.y,0,0,0,0,1,0,(1-t.x)/2+this.offset.x,(1-t.y)/2+this.offset.y,0,1]),this._updateMatrixUniform()}},{key:"_updateMatrixUniform",value:function(){this._textureMatrix.isActive&&(this.renderer.useProgram(this._parent._program),this.gl.uniformMatrix4fv(this._textureMatrix.location,!1,this._textureMatrix.matrix.elements))}},{key:"_onSourceLoaded",value:function(e){this.setSource(e),"image"===this.sourceType&&this.renderer.cache.addTexture(this)}},{key:"_bindTexture",value:function(){this._canDraw&&(this.renderer.state.activeTexture!==this.index&&(this.gl.activeTexture(this.gl.TEXTURE0+this.index),this.renderer.state.activeTexture=this.index),this.gl.bindTexture(this.gl.TEXTURE_2D,this._sampler.texture),this._sampler.isTextureBound||(this._sampler.isTextureBound=!!this.gl.getParameter(this.gl.TEXTURE_BINDING_2D),this._sampler.isTextureBound&&this.renderer.needRender()))}},{key:"_draw",value:function(){this._sampler.isActive&&(this._bindTexture(),"video"===this.sourceType&&this.source&&!this._videoFrameCallbackID&&this.source.readyState>=this.source.HAVE_CURRENT_DATA&&!this.source.paused&&(this._willUpdate=!0),(this._forceUpdate||this._willUpdate&&this.shouldUpdate)&&(this._state.generateMipmap=!1,this._upload()),"video"===this.sourceType&&(this._willUpdate=!1),this._forceUpdate=!1),this.parameters._shouldUpdate&&(this._updateTexParameters(),this.parameters._shouldUpdate=!1)}},{key:"onSourceLoaded",value:function(e){return e&&(this._onSourceLoadedCallback=e),this}},{key:"onSourceUploaded",value:function(e){return e&&(this._onSourceUploadedCallback=e),this}},{key:"_dispose",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];"video"===this.sourceType||"image"===this.sourceType&&!this.renderer.state.isActive?(this._loader&&this._loader._removeSource(this),this.source=null):"canvas"===this.sourceType&&(this.source.width=this.source.width,this.source=null),this._parent=null;var t=this.gl&&!this._copiedFrom&&(e||"image"!==this.sourceType||!this.renderer.state.isActive);t&&(this._canDraw=!1,this.renderer.cache.removeTexture(this),this.gl.activeTexture(this.gl.TEXTURE0+this.index),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.deleteTexture(this._sampler.texture))}}]),e}(),M=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"anonymous";if(_classCallCheck(this,e),this.type="TextureLoader",(t=t&&t.renderer||t)&&"Renderer"===t.type){if(!t.gl)return void i(this.type+": Renderer WebGL context is undefined",t)}else i(this.type+": Renderer not passed as first argument",t);this.renderer=t,this.gl=this.renderer.gl,this.crossOrigin=r,this.elements=[]}return _createClass(e,[{key:"_addElement",value:function(e,t,r,i){var n={source:e,texture:t,load:this._sourceLoaded.bind(this,e,t,r),error:this._sourceLoadError.bind(this,e,i)};return this.elements.push(n),n}},{key:"_sourceLoadError",value:function(e,t,r){t&&t(e,r)}},{key:"_sourceLoaded",value:function(e,t,r){var i=this;t._sourceLoaded||(t._onSourceLoaded(e),this._parent&&(this._increment&&this._increment(),this.renderer.nextRender.add((function(){return i._parent._onLoadingCallback&&i._parent._onLoadingCallback(t)}))),r&&r(t))}},{key:"_getSourceType",value:function(e){var t;return"string"==typeof e?null!==e.match(/\.(jpeg|jpg|jfif|pjpeg|pjp|gif|bmp|png|webp|svg|avif|apng)$/)?t="image":null!==e.match(/\.(webm|mp4|mpg|mpeg|avi|ogg|ogm|ogv|mov|av1)$/)&&(t="video"):"IMG"===e.tagName.toUpperCase()?t="image":"VIDEO"===e.tagName.toUpperCase()?t="video":"CANVAS"===e.tagName.toUpperCase()&&(t="canvas"),t}},{key:"_createImage",value:function(e){if("string"!=typeof e&&e.hasAttribute("crossOrigin"))return e;var t=new Image;return t.crossOrigin=this.crossOrigin,"string"==typeof e?t.src=e:(t.src=e.src,e.hasAttribute("data-sampler")&&t.setAttribute("data-sampler",e.getAttribute("data-sampler"))),t}},{key:"_createVideo",value:function(e){if("string"==typeof e||null===e.getAttribute("crossOrigin")){var t=document.createElement("video");return t.crossOrigin=this.crossOrigin,"string"==typeof e?t.src=e:(t.src=e.src,e.hasAttribute("data-sampler")&&t.setAttribute("data-sampler",e.getAttribute("data-sampler"))),t}return e}},{key:"loadSource",value:function(e,t,r,i){switch(this._getSourceType(e)){case"image":this.loadImage(e,t,r,i);break;case"video":this.loadVideo(e,t,r,i);break;case"canvas":this.loadCanvas(e,t,r);break;default:this._sourceLoadError(e,i,"this source could not be converted into a texture: "+e)}}},{key:"loadSources",value:function(e,t,r,i){for(var n=0;n<e.length;n++)this.loadSource(e[n],t,r,i)}},{key:"loadImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,n=this.renderer.cache.getTextureFromSource(e),s=Object.assign({},t);if(this._parent&&(s=Object.assign(s,this._parent._texturesOptions)),s.loader=this,n){s.sampler="string"!=typeof e&&e.hasAttribute("data-sampler")?e.getAttribute("data-sampler"):s.sampler,s.fromTexture=n;var a=new E(this.renderer,s);return this._sourceLoaded(n.source,a,r),void(this._parent&&this._addToParent(a,n.source,"image"))}var o=this._createImage(e);s.sampler=o.hasAttribute("data-sampler")?o.getAttribute("data-sampler"):s.sampler;var h=new E(this.renderer,s),l=this._addElement(o,h,r,i);o.complete?this._sourceLoaded(o,h,r):o.decode?o.decode().then(this._sourceLoaded.bind(this,o,h,r)).catch((function(){o.addEventListener("load",l.load,!1),o.addEventListener("error",l.error,!1)})):(o.addEventListener("load",l.load,!1),o.addEventListener("error",l.error,!1)),this._parent&&this._addToParent(h,o,"image")}},{key:"loadImages",value:function(e,t,r,i){for(var n=0;n<e.length;n++)this.loadImage(e[n],t,r,i)}},{key:"loadVideo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,n=this._createVideo(e);n.preload=!0,n.muted=!0,n.loop=!0,n.setAttribute("playsinline",""),n.crossOrigin=this.crossOrigin;var s=Object.assign({},t);this._parent&&(s=Object.assign(t,this._parent._texturesOptions)),s.loader=this,s.sampler=n.hasAttribute("data-sampler")?n.getAttribute("data-sampler"):s.sampler;var a=new E(this.renderer,s),o=this._addElement(n,a,r,i);n.addEventListener("canplaythrough",o.load,!1),n.addEventListener("error",o.error,!1),n.readyState>=n.HAVE_FUTURE_DATA&&r&&this._sourceLoaded(n,a,r),n.load(),this._addToParent&&this._addToParent(a,n,"video"),"requestVideoFrameCallback"in HTMLVideoElement.prototype&&(o.videoFrameCallback=a._videoFrameCallback.bind(a),a._videoFrameCallbackID=n.requestVideoFrameCallback(o.videoFrameCallback))}},{key:"loadVideos",value:function(e,t,r,i){for(var n=0;n<e.length;n++)this.loadVideo(e[n],t,r,i)}},{key:"loadCanvas",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=Object.assign({},t);this._parent&&(i=Object.assign(t,this._parent._texturesOptions)),i.loader=this,i.sampler=e.hasAttribute("data-sampler")?e.getAttribute("data-sampler"):i.sampler;var n=new E(this.renderer,i);this._addElement(e,n,r,null),this._sourceLoaded(e,n,r),this._parent&&this._addToParent(n,e,"canvas")}},{key:"loadCanvases",value:function(e,t,r){for(var i=0;i<e.length;i++)this.loadCanvas(e[i],t,r)}},{key:"_removeSource",value:function(e){var t=this.elements.find((function(t){return t.texture.uuid===e.uuid}));t&&("image"===e.sourceType?t.source.removeEventListener("load",t.load,!1):"video"===e.sourceType&&(t.videoFrameCallback&&e._videoFrameCallbackID&&t.source.cancelVideoFrameCallback(e._videoFrameCallbackID),t.source.removeEventListener("canplaythrough",t.load,!1),t.source.pause(),t.source.removeAttribute("src"),t.source.load()),t.source.removeEventListener("error",t.error,!1))}}]),e}(),A=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,n){var s,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=a.sourcesLoaded,h=void 0===o?0:o,l=a.sourcesToLoad,u=void 0===l?0:l,d=a.complete,c=void 0!==d&&d,f=a.onComplete,p=void 0===f?function(){}:f;return _classCallCheck(this,i),(s=t.call(this,e,n.crossOrigin)).type="PlaneTextureLoader",s._parent=n,"Plane"!==s._parent.type&&"PingPongPlane"!==s._parent.type&&"ShaderPass"!==s._parent.type&&(r(s.type+": Wrong parent type assigned to this loader"),s._parent=null),s.sourcesLoaded=h,s.sourcesToLoad=u,s.complete=c,s.onComplete=p,s}return _createClass(i,[{key:"_setLoaderSize",value:function(e){var t=this;this.sourcesToLoad=e,0===this.sourcesToLoad&&(this.complete=!0,this.renderer.nextRender.add((function(){return t.onComplete&&t.onComplete()})))}},{key:"_increment",value:function(){var e=this;this.sourcesLoaded++,this.sourcesLoaded>=this.sourcesToLoad&&!this.complete&&(this.complete=!0,this.renderer.nextRender.add((function(){return e.onComplete&&e.onComplete()})))}},{key:"_addSourceToParent",value:function(e,t){if("image"===t){var r=this._parent.images;!r.find((function(t){return t.src===e.src}))&&r.push(e)}else if("video"===t){var i=this._parent.videos;!i.find((function(t){return t.src===e.src}))&&i.push(e)}else if("canvas"===t){var n=this._parent.canvases;!n.find((function(t){return t.isSameNode(e)}))&&n.push(e)}}},{key:"_addToParent",value:function(e,t,r){this._addSourceToParent(t,r),this._parent&&e.addParent(this._parent)}}]),i}(M),O=function(){function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Mesh",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=s.vertexShaderID,o=s.fragmentShaderID,h=s.vertexShader,l=s.fragmentShader,u=s.uniforms,d=void 0===u?{}:u,c=s.widthSegments,f=void 0===c?1:c,p=s.heightSegments,_=void 0===p?1:p,g=s.renderOrder,m=void 0===g?0:g,v=s.depthTest,y=void 0===v||v,x=s.cullFace,w=void 0===x?"back":x,T=s.texturesOptions,P=void 0===T?{}:T,R=s.crossOrigin,S=void 0===R?"anonymous":R;if(_classCallCheck(this,e),this.type=n,(t=t&&t.renderer||t)&&"Renderer"===t.type||(i(this.type+": Curtains not passed as first argument or Curtains Renderer is missing",t),setTimeout((function(){r._onErrorCallback&&r._onErrorCallback()}),0)),this.renderer=t,this.gl=this.renderer.gl,!this.gl)return this.renderer.production||i(this.type+": Unable to create a "+this.type+" because the Renderer WebGL context is not defined"),void setTimeout((function(){r._onErrorCallback&&r._onErrorCallback()}),0);this._canDraw=!1,this.renderOrder=m,this._depthTest=y,this.cullFace=w,"back"!==this.cullFace&&"front"!==this.cullFace&&"none"!==this.cullFace&&(this.cullFace="back"),this.textures=[],this._texturesOptions=Object.assign({premultiplyAlpha:!1,anisotropy:1,floatingPoint:"none",wrapS:this.gl.CLAMP_TO_EDGE,wrapT:this.gl.CLAMP_TO_EDGE,minFilter:this.gl.LINEAR,magFilter:this.gl.LINEAR},P),this.crossOrigin=S,!h&&a&&document.getElementById(a)&&(h=document.getElementById(a).innerHTML),!l&&o&&document.getElementById(o)&&(l=document.getElementById(o).innerHTML),this._initMesh(),f=parseInt(f),_=parseInt(_),this._geometry=new k(this.renderer,{width:f,height:_}),this._program=new b(this.renderer,{parent:this,vertexShader:h,fragmentShader:l}),this._program.compiled?(this._program.createUniforms(d),this.uniforms=this._program.uniformsManager.uniforms,this._geometry.setProgram(this._program),this.renderer.onSceneChange()):this.renderer.nextRender.add((function(){return r._onErrorCallback&&r._onErrorCallback()}))}return _createClass(e,[{key:"_initMesh",value:function(){var e=this;this.uuid=n(),this.loader=new A(this.renderer,this,{sourcesLoaded:0,initSourcesToLoad:0,complete:!1,onComplete:function(){e._onReadyCallback&&e._onReadyCallback(),e.renderer.needRender()}}),this.images=[],this.videos=[],this.canvases=[],this.userData={},this._canDraw=!0}},{key:"_restoreContext",value:function(){this._canDraw=!1,this._matrices&&(this._matrices=null),this._program=new b(this.renderer,{parent:this,vertexShader:this._program.vsCode,fragmentShader:this._program.fsCode}),this._program.compiled&&(this._geometry.restoreContext(this._program),this._program.createUniforms(this.uniforms),this.uniforms=this._program.uniformsManager.uniforms,this._programRestored())}},{key:"setRenderTarget",value:function(e){e&&"RenderTarget"===e.type?("Plane"===this.type&&this.renderer.scene.removePlane(this),this.target=e,"Plane"===this.type&&this.renderer.scene.addPlane(this)):this.renderer.production||r(this.type+": Could not set the render target because the argument passed is not a RenderTarget class object",e)}},{key:"setRenderOrder",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(e=isNaN(e)?this.renderOrder:parseInt(e))!==this.renderOrder&&(this.renderOrder=e,this.renderer.scene.setPlaneRenderOrder(this))}},{key:"createTexture",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new E(this.renderer,Object.assign(this._texturesOptions,e));return t.addParent(this),t}},{key:"addTexture",value:function(e){e&&"Texture"===e.type?e.addParent(this):this.renderer.production||r(this.type+": cannot add ",e," to this "+this.type+" because it is not a valid texture")}},{key:"loadSources",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,n=0;n<e.length;n++)this.loadSource(e[n],t,r,i)}},{key:"loadSource",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;this.loader.loadSource(e,Object.assign(i,this._texturesOptions),(function(e){n&&n(e)}),(function(e,i){t.renderer.production||r(t.type+": this HTML tag could not be converted into a texture:",e.tagName),s&&s(e,i)}))}},{key:"loadImage",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;this.loader.loadImage(e,Object.assign(i,this._texturesOptions),(function(e){n&&n(e)}),(function(e,i){t.renderer.production||r(t.type+": There has been an error:\n",i,"\nwhile loading this image:\n",e),s&&s(e,i)}))}},{key:"loadVideo",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;this.loader.loadVideo(e,Object.assign(i,this._texturesOptions),(function(e){n&&n(e)}),(function(e,i){t.renderer.production||r(t.type+": There has been an error:\n",i,"\nwhile loading this video:\n",e),s&&s(e,i)}))}},{key:"loadCanvas",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;this.loader.loadCanvas(e,Object.assign(t,this._texturesOptions),(function(e){r&&r(e)}))}},{key:"loadImages",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,n=0;n<e.length;n++)this.loadImage(e[n],t,r,i)}},{key:"loadVideos",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,n=0;n<e.length;n++)this.loadVideo(e[n],t,r,i)}},{key:"loadCanvases",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=0;i<e.length;i++)this.loadCanvas(e[i],t,r)}},{key:"playVideos",value:function(){for(var e=this,t=0;t<this.textures.length;t++){var i=this.textures[t];if("video"===i.sourceType){var n=i.source.play();void 0!==n&&n.catch((function(t){e.renderer.production||r(e.type+": Could not play the video : ",t)}))}}}},{key:"_draw",value:function(){this.renderer.setDepthTest(this._depthTest),this.renderer.setFaceCulling(this.cullFace),this._program.updateUniforms(),this._geometry.bindBuffers(),this.renderer.state.forceBufferUpdate=!1;for(var e=0;e<this.textures.length;e++)if(this.textures[e]._draw(),this.textures[e]._sampler.isActive&&!this.textures[e]._sampler.isTextureBound)return;this._geometry.draw(),this.renderer.state.activeTexture=null,this._onAfterRenderCallback&&this._onAfterRenderCallback()}},{key:"onError",value:function(e){return e&&(this._onErrorCallback=e),this}},{key:"onLoading",value:function(e){return e&&(this._onLoadingCallback=e),this}},{key:"onReady",value:function(e){return e&&(this._onReadyCallback=e),this}},{key:"onRender",value:function(e){return e&&(this._onRenderCallback=e),this}},{key:"onAfterRender",value:function(e){return e&&(this._onAfterRenderCallback=e),this}},{key:"remove",value:function(){this._canDraw=!1,this.target&&this.renderer.bindFrameBuffer(null),this._dispose(),"Plane"===this.type?this.renderer.removePlane(this):"ShaderPass"===this.type&&(this.target&&(this.target._shaderPass=null,this.target.remove(),this.target=null),this.renderer.removeShaderPass(this))}},{key:"_dispose",value:function(){if(this.gl){this._geometry&&this._geometry.dispose(),this.target&&"ShaderPass"===this.type&&(this.renderer.removeRenderTarget(this.target),this.textures.shift());for(var e=0;e<this.textures.length;e++)this.textures[e]._dispose();this.textures=[]}}}]),e}(),F=new T,D=new T,z=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,n){var s,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"DOMMesh",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},h=o.widthSegments,l=o.heightSegments,u=o.renderOrder,d=o.depthTest,c=o.cullFace,f=o.uniforms,p=o.vertexShaderID,_=o.fragmentShaderID,g=o.vertexShader,m=o.fragmentShader,v=o.texturesOptions,y=o.crossOrigin;return _classCallCheck(this,i),p=p||n&&n.getAttribute("data-vs-id"),_=_||n&&n.getAttribute("data-fs-id"),(s=t.call(this,e,a,{widthSegments:h,heightSegments:l,renderOrder:u,depthTest:d,cullFace:c,uniforms:f,vertexShaderID:p,fragmentShaderID:_,vertexShader:g,fragmentShader:m,texturesOptions:v,crossOrigin:y})).gl?(s.htmlElement=n,s.htmlElement&&0!==s.htmlElement.length||s.renderer.production||r(s.type+": The HTML element you specified does not currently exists in the DOM"),s._setDocumentSizes(),s):_possibleConstructorReturn(s)}return _createClass(i,[{key:"_setDocumentSizes",value:function(){var e=this.htmlElement.getBoundingClientRect();this._boundingRect||(this._boundingRect={}),this._boundingRect.document={width:e.width*this.renderer.pixelRatio,height:e.height*this.renderer.pixelRatio,top:e.top*this.renderer.pixelRatio,left:e.left*this.renderer.pixelRatio}}},{key:"getBoundingRect",value:function(){return{width:this._boundingRect.document.width,height:this._boundingRect.document.height,top:this._boundingRect.document.top,left:this._boundingRect.document.left,right:this._boundingRect.document.left+this._boundingRect.document.width,bottom:this._boundingRect.document.top+this._boundingRect.document.height}}},{key:"resize",value:function(){var e=this;this._setDocumentSizes(),"Plane"===this.type&&(this.setPerspective(this.camera.fov,this.camera.near,this.camera.far),this._setWorldSizes(),this._applyWorldPositions());for(var t=0;t<this.textures.length;t++)this.textures[t].resize();this.renderer.nextRender.add((function(){return e._onAfterResizeCallback&&e._onAfterResizeCallback()}))}},{key:"mouseToPlaneCoords",value:function(e){var t=this.scale?this.scale:D.set(1,1),r=F.set((this._boundingRect.document.width-this._boundingRect.document.width*t.x)/2,(this._boundingRect.document.height-this._boundingRect.document.height*t.y)/2),i=this._boundingRect.document.width*t.x/this.renderer.pixelRatio,n=this._boundingRect.document.height*t.y/this.renderer.pixelRatio,s=(this._boundingRect.document.top+r.y)/this.renderer.pixelRatio,a=(this._boundingRect.document.left+r.x)/this.renderer.pixelRatio;return F.set((e.x-a)/i*2-1,1-(e.y-s)/n*2)}},{key:"onAfterResize",value:function(e){return e&&(this._onAfterResizeCallback=e),this}}]),i}(O),L=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.fov,i=void 0===r?50:r,n=t.near,s=void 0===n?.1:n,a=t.far,o=void 0===a?150:a,h=t.width,l=t.height,u=t.pixelRatio,d=void 0===u?1:u;_classCallCheck(this,e),this.position=new P,this.projectionMatrix=new w,this.worldMatrix=new w,this.viewMatrix=new w,this._shouldUpdate=!1,this.setSize(),this.setPerspective(i,s,o,h,l,d)}return _createClass(e,[{key:"setFov",value:function(e){e=isNaN(e)?this.fov:parseFloat(e),(e=Math.max(1,Math.min(e,179)))!==this.fov&&(this.fov=e,this.setPosition(),this._shouldUpdate=!0),this.setCSSPerspective()}},{key:"setNear",value:function(e){e=isNaN(e)?this.near:parseFloat(e),(e=Math.max(e,.01))!==this.near&&(this.near=e,this._shouldUpdate=!0)}},{key:"setFar",value:function(e){e=isNaN(e)?this.far:parseFloat(e),(e=Math.max(e,50))!==this.far&&(this.far=e,this._shouldUpdate=!0)}},{key:"setPixelRatio",value:function(e){e!==this.pixelRatio&&(this._shouldUpdate=!0),this.pixelRatio=e}},{key:"setSize",value:function(e,t){e===this.width&&t===this.height||(this._shouldUpdate=!0),this.width=e,this.height=t}},{key:"setPerspective",value:function(e,t,r,i,n,s){this.setPixelRatio(s),this.setSize(i,n),this.setFov(e),this.setNear(t),this.setFar(r),this._shouldUpdate&&this.updateProjectionMatrix()}},{key:"setPosition",value:function(){this.position.set(0,0,1),this.worldMatrix.setFromArray([1,0,0,0,0,1,0,0,0,0,1,0,this.position.x,this.position.y,this.position.z,1]),this.viewMatrix=this.viewMatrix.copy(this.worldMatrix).getInverse()}},{key:"setCSSPerspective",value:function(){this.CSSPerspective=Math.pow(Math.pow(this.width/(2*this.pixelRatio),2)+Math.pow(this.height/(2*this.pixelRatio),2),.5)/Math.tan(.5*this.fov*Math.PI/180)}},{key:"getScreenRatiosFromFov",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.position.z;e<t?e-=t:e+=t;var r=this.fov*Math.PI/180,i=2*Math.tan(r/2)*Math.abs(e);return{width:i*this.width/this.height,height:i}}},{key:"updateProjectionMatrix",value:function(){var e=this.width/this.height,t=this.near*Math.tan(Math.PI/180*.5*this.fov),r=2*t,i=e*r,n=-.5*i,s=n+i,a=t-r,o=2*this.near/(s-n),h=2*this.near/(t-a),l=(s+n)/(s-n),u=(t+a)/(t-a),d=-(this.far+this.near)/(this.far-this.near),c=-2*this.far*this.near/(this.far-this.near);this.projectionMatrix.setFromArray([o,0,0,0,0,h,0,0,l,u,d,-1,0,0,c,0])}},{key:"forceUpdate",value:function(){this._shouldUpdate=!0}},{key:"cancelUpdate",value:function(){this._shouldUpdate=!1}}]),e}(),I=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Float32Array([0,0,0,1]),r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"XYZ";_classCallCheck(this,e),this.type="Quat",this.elements=t,this.axisOrder=r}return _createClass(e,[{key:"setFromArray",value:function(e){return this.elements[0]=e[0],this.elements[1]=e[1],this.elements[2]=e[2],this.elements[3]=e[3],this}},{key:"setAxisOrder",value:function(e){switch(e=e.toUpperCase()){case"XYZ":case"YXZ":case"ZXY":case"ZYX":case"YZX":case"XZY":this.axisOrder=e;break;default:this.axisOrder="XYZ"}return this}},{key:"copy",value:function(e){return this.elements=e.elements,this.axisOrder=e.axisOrder,this}},{key:"clone",value:function(){return(new e).copy(this)}},{key:"equals",value:function(e){return this.elements[0]===e.elements[0]&&this.elements[1]===e.elements[1]&&this.elements[2]===e.elements[2]&&this.elements[3]===e.elements[3]&&this.axisOrder===e.axisOrder}},{key:"setFromVec3",value:function(e){var t=.5*e.x,r=.5*e.y,i=.5*e.z,n=Math.cos(t),s=Math.cos(r),a=Math.cos(i),o=Math.sin(t),h=Math.sin(r),l=Math.sin(i);return"XYZ"===this.axisOrder?(this.elements[0]=o*s*a+n*h*l,this.elements[1]=n*h*a-o*s*l,this.elements[2]=n*s*l+o*h*a,this.elements[3]=n*s*a-o*h*l):"YXZ"===this.axisOrder?(this.elements[0]=o*s*a+n*h*l,this.elements[1]=n*h*a-o*s*l,this.elements[2]=n*s*l-o*h*a,this.elements[3]=n*s*a+o*h*l):"ZXY"===this.axisOrder?(this.elements[0]=o*s*a-n*h*l,this.elements[1]=n*h*a+o*s*l,this.elements[2]=n*s*l+o*h*a,this.elements[3]=n*s*a-o*h*l):"ZYX"===this.axisOrder?(this.elements[0]=o*s*a-n*h*l,this.elements[1]=n*h*a+o*s*l,this.elements[2]=n*s*l-o*h*a,this.elements[3]=n*s*a+o*h*l):"YZX"===this.axisOrder?(this.elements[0]=o*s*a+n*h*l,this.elements[1]=n*h*a+o*s*l,this.elements[2]=n*s*l-o*h*a,this.elements[3]=n*s*a-o*h*l):"XZY"===this.axisOrder&&(this.elements[0]=o*s*a-n*h*l,this.elements[1]=n*h*a-o*s*l,this.elements[2]=n*s*l+o*h*a,this.elements[3]=n*s*a+o*h*l),this}}]),e}(),U=new T,B=new P,N=new P,V=new P,W=new P,X=new P,G=new P,Y=new P,j=new P,H=new I,q=new P(.5,.5,0),Q=new P,Z=new P,K=new P,$=new P,J=new T,ee=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,r){var n,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=s.widthSegments,o=s.heightSegments,h=s.renderOrder,l=s.depthTest,u=s.cullFace,d=s.uniforms,c=s.vertexShaderID,f=s.fragmentShaderID,p=s.vertexShader,_=s.fragmentShader,g=s.texturesOptions,m=s.crossOrigin,v=s.alwaysDraw,y=void 0!==v&&v,x=s.visible,b=void 0===x||x,k=s.transparent,w=void 0!==k&&k,T=s.drawCheckMargins,P=void 0===T?{top:0,right:0,bottom:0,left:0}:T,R=s.autoloadSources,S=void 0===R||R,C=s.watchScroll,E=void 0===C||C,M=s.fov,A=void 0===M?50:M;return _classCallCheck(this,i),(n=t.call(this,e,r,"Plane",{widthSegments:a,heightSegments:o,renderOrder:h,depthTest:l,cullFace:u,uniforms:d,vertexShaderID:c,fragmentShaderID:f,vertexShader:p,fragmentShader:_,texturesOptions:g,crossOrigin:m})).gl?(n.index=n.renderer.planes.length,n.target=null,n.alwaysDraw=y,n._shouldDraw=!0,n.visible=b,n._transparent=w,n.drawCheckMargins=P,n.autoloadSources=S,n.watchScroll=E,n._updateMVMatrix=!1,n.camera=new L({fov:A,width:n.renderer._boundingRect.width,height:n.renderer._boundingRect.height,pixelRatio:n.renderer.pixelRatio}),n._program.compiled&&(n._initPlane(),n.renderer.scene.addPlane(_assertThisInitialized(n)),n.renderer.planes.push(_assertThisInitialized(n))),n):_possibleConstructorReturn(n)}return _createClass(i,[{key:"_programRestored",value:function(){this.target&&this.setRenderTarget(this.renderer.renderTargets[this.target.index]),this._initMatrices(),this.setPerspective(this.camera.fov,this.camera.near,this.camera.far),this._setWorldSizes(),this._applyWorldPositions(),this.renderer.scene.addPlane(this);for(var e=0;e<this.textures.length;e++)this.textures[e]._parent=this,this.textures[e]._restoreContext();this._canDraw=!0}},{key:"_initPlane",value:function(){this._initTransformValues(),this._initPositions(),this.setPerspective(this.camera.fov,this.camera.near,this.camera.far),this._initSources()}},{key:"_initTransformValues",value:function(){var e=this;this.rotation=new P,this.rotation.onChange((function(){return e._applyRotation()})),this.quaternion=new I,this.relativeTranslation=new P,this.relativeTranslation.onChange((function(){return e._setTranslation()})),this._translation=new P,this.scale=new P(1),this.scale.onChange((function(){e.scale.z=1,e._applyScale()})),this.transformOrigin=new P(.5,.5,0),this.transformOrigin.onChange((function(){e._setWorldTransformOrigin(),e._updateMVMatrix=!0}))}},{key:"resetPlane",value:function(e){this._initTransformValues(),this._setWorldTransformOrigin(),null!==e&&e?(this.htmlElement=e,this.resize()):e||this.renderer.production||r(this.type+": You are trying to reset a plane with a HTML element that does not exist. The old HTML element will be kept instead.")}},{key:"removeRenderTarget",value:function(){this.target&&(this.renderer.scene.removePlane(this),this.target=null,this.renderer.scene.addPlane(this))}},{key:"_initPositions",value:function(){this._initMatrices(),this._setWorldSizes(),this._applyWorldPositions()}},{key:"_initMatrices",value:function(){var e=new w;this._matrices={world:{matrix:e},modelView:{name:"uMVMatrix",matrix:e,location:this.gl.getUniformLocation(this._program.program,"uMVMatrix")},projection:{name:"uPMatrix",matrix:e,location:this.gl.getUniformLocation(this._program.program,"uPMatrix")},modelViewProjection:{matrix:e}}}},{key:"_setPerspectiveMatrix",value:function(){this.camera._shouldUpdate&&(this.renderer.useProgram(this._program),this.gl.uniformMatrix4fv(this._matrices.projection.location,!1,this._matrices.projection.matrix.elements)),this.camera.cancelUpdate()}},{key:"setPerspective",value:function(e,t,r){this.camera.setPerspective(e,t,r,this.renderer._boundingRect.width,this.renderer._boundingRect.height,this.renderer.pixelRatio),this.renderer.state.isContextLost&&this.camera.forceUpdate(),this._matrices.projection.matrix=this.camera.projectionMatrix,this.camera._shouldUpdate&&(this._setWorldSizes(),this._applyWorldPositions(),this._translation.z=this.relativeTranslation.z/this.camera.CSSPerspective),this._updateMVMatrix=this.camera._shouldUpdate}},{key:"_setMVMatrix",value:function(){this._updateMVMatrix&&(this._matrices.world.matrix=this._matrices.world.matrix.composeFromOrigin(this._translation,this.quaternion,this.scale,this._boundingRect.world.transformOrigin),this._matrices.world.matrix.scale({x:this._boundingRect.world.width,y:this._boundingRect.world.height,z:1}),this._matrices.modelView.matrix.copy(this._matrices.world.matrix),this._matrices.modelView.matrix.elements[14]-=this.camera.position.z,this._matrices.modelViewProjection.matrix=this._matrices.projection.matrix.multiply(this._matrices.modelView.matrix),this.alwaysDraw||this._shouldDrawCheck(),this.renderer.useProgram(this._program),this.gl.uniformMatrix4fv(this._matrices.modelView.location,!1,this._matrices.modelView.matrix.elements)),this._updateMVMatrix=!1}},{key:"_setWorldTransformOrigin",value:function(){this._boundingRect.world.transformOrigin=new P((2*this.transformOrigin.x-1)*this._boundingRect.world.width,-(2*this.transformOrigin.y-1)*this._boundingRect.world.height,this.transformOrigin.z)}},{key:"_documentToWorldSpace",value:function(e){return N.set(e.x*this.renderer.pixelRatio/this.renderer._boundingRect.width*this._boundingRect.world.ratios.width,-e.y*this.renderer.pixelRatio/this.renderer._boundingRect.height*this._boundingRect.world.ratios.height,e.z)}},{key:"_setWorldSizes",value:function(){var e=this.camera.getScreenRatiosFromFov();this._boundingRect.world={width:this._boundingRect.document.width/this.renderer._boundingRect.width*e.width/2,height:this._boundingRect.document.height/this.renderer._boundingRect.height*e.height/2,ratios:e},this._setWorldTransformOrigin()}},{key:"_setWorldPosition",value:function(){var e=this._boundingRect.document.width/2+this._boundingRect.document.left,t=this._boundingRect.document.height/2+this._boundingRect.document.top,r=this.renderer._boundingRect.width/2+this.renderer._boundingRect.left,i=this.renderer._boundingRect.height/2+this.renderer._boundingRect.top;this._boundingRect.world.top=(i-t)/this.renderer._boundingRect.height*this._boundingRect.world.ratios.height,this._boundingRect.world.left=(e-r)/this.renderer._boundingRect.width*this._boundingRect.world.ratios.width}},{key:"setScale",value:function(e){e.type&&"Vec2"===e.type?(e.sanitizeNaNValuesWith(this.scale).max(U.set(.001,.001)),e.x===this.scale.x&&e.y===this.scale.y||(this.scale.set(e.x,e.y,1),this._applyScale())):this.renderer.production||r(this.type+": Cannot set scale because the parameter passed is not of Vec2 type:",e)}},{key:"_applyScale",value:function(){for(var e=0;e<this.textures.length;e++)this.textures[e].resize();this._updateMVMatrix=!0}},{key:"setRotation",value:function(e){e.type&&"Vec3"===e.type?(e.sanitizeNaNValuesWith(this.rotation),e.equals(this.rotation)||(this.rotation.copy(e),this._applyRotation())):this.renderer.production||r(this.type+": Cannot set rotation because the parameter passed is not of Vec3 type:",e)}},{key:"_applyRotation",value:function(){this.quaternion.setFromVec3(this.rotation),this._updateMVMatrix=!0}},{key:"setTransformOrigin",value:function(e){e.type&&"Vec3"===e.type?(e.sanitizeNaNValuesWith(this.transformOrigin),e.equals(this.transformOrigin)||(this.transformOrigin.copy(e),this._setWorldTransformOrigin(),this._updateMVMatrix=!0)):this.renderer.production||r(this.type+": Cannot set transform origin because the parameter passed is not of Vec3 type:",e)}},{key:"_setTranslation",value:function(){var e=B.set(0,0,0);this.relativeTranslation.equals(e)||(e=this._documentToWorldSpace(this.relativeTranslation)),this._translation.set(this._boundingRect.world.left+e.x,this._boundingRect.world.top+e.y,this.relativeTranslation.z/this.camera.CSSPerspective),this._updateMVMatrix=!0}},{key:"setRelativeTranslation",value:function(e){e.type&&"Vec3"===e.type?(e.sanitizeNaNValuesWith(this.relativeTranslation),e.equals(this.relativeTranslation)||(this.relativeTranslation.copy(e),this._setTranslation())):this.renderer.production||r(this.type+": Cannot set translation because the parameter passed is not of Vec3 type:",e)}},{key:"_applyWorldPositions",value:function(){this._setWorldPosition(),this._setTranslation()}},{key:"updatePosition",value:function(){this._setDocumentSizes(),this._applyWorldPositions()}},{key:"updateScrollPosition",value:function(e,t){(e||t)&&(this._boundingRect.document.top+=t*this.renderer.pixelRatio,this._boundingRect.document.left+=e*this.renderer.pixelRatio,this._applyWorldPositions())}},{key:"_getIntersection",value:function(e,t){for(var r=t.clone().sub(e),i=e.clone();i.z>-1;)i.add(r);return i}},{key:"_getNearPlaneIntersections",value:function(e,t,r){var i=this._matrices.modelViewProjection.matrix;if(1===r.length)0===r[0]?(t[0]=this._getIntersection(t[1],Y.set(.95,1,0).applyMat4(i)),t.push(this._getIntersection(t[3],j.set(-1,-.95,0).applyMat4(i)))):1===r[0]?(t[1]=this._getIntersection(t[0],Y.set(-.95,1,0).applyMat4(i)),t.push(this._getIntersection(t[2],j.set(1,-.95,0).applyMat4(i)))):2===r[0]?(t[2]=this._getIntersection(t[3],Y.set(-.95,-1,0).applyMat4(i)),t.push(this._getIntersection(t[1],j.set(1,.95,0).applyMat4(i)))):3===r[0]&&(t[3]=this._getIntersection(t[2],Y.set(.95,-1,0).applyMat4(i)),t.push(this._getIntersection(t[0],j.set(-1,.95,0).applyMat4(i))));else if(2===r.length)0===r[0]&&1===r[1]?(t[0]=this._getIntersection(t[3],Y.set(-1,-.95,0).applyMat4(i)),t[1]=this._getIntersection(t[2],j.set(1,-.95,0).applyMat4(i))):1===r[0]&&2===r[1]?(t[1]=this._getIntersection(t[0],Y.set(-.95,1,0).applyMat4(i)),t[2]=this._getIntersection(t[3],j.set(-.95,-1,0).applyMat4(i))):2===r[0]&&3===r[1]?(t[2]=this._getIntersection(t[1],Y.set(1,.95,0).applyMat4(i)),t[3]=this._getIntersection(t[0],j.set(-1,.95,0).applyMat4(i))):0===r[0]&&3===r[1]&&(t[0]=this._getIntersection(t[1],Y.set(.95,1,0).applyMat4(i)),t[3]=this._getIntersection(t[2],j.set(.95,-1,0).applyMat4(i)));else if(3===r.length){for(var n=0,s=0;s<e.length;s++)r.includes(s)||(n=s);t=[t[n]],0===n?(t.push(this._getIntersection(t[0],Y.set(-.95,1,0).applyMat4(i))),t.push(this._getIntersection(t[0],j.set(-1,.95,0).applyMat4(i)))):1===n?(t.push(this._getIntersection(t[0],Y.set(.95,1,0).applyMat4(i))),t.push(this._getIntersection(t[0],j.set(1,.95,0).applyMat4(i)))):2===n?(t.push(this._getIntersection(t[0],Y.set(.95,-1,0).applyMat4(i))),t.push(this._getIntersection(t[0],j.set(1,-.95,0).applyMat4(i)))):3===n&&(t.push(this._getIntersection(t[0],Y.set(-.95,-1,0).applyMat4(i))),t.push(this._getIntersection(t[0],j.set(-1.95,0).applyMat4(i))))}else for(var a=0;a<e.length;a++)t[a][0]=1e4,t[a][1]=1e4;return t}},{key:"_getWorldCoords",value:function(){for(var e=[V.set(-1,1,0),W.set(1,1,0),X.set(1,-1,0),G.set(-1,-1,0)],t=[],r=[],i=0;i<e.length;i++){var n=e[i].applyMat4(this._matrices.modelViewProjection.matrix);t.push(n),Math.abs(n.z)>1&&r.push(i)}r.length&&(t=this._getNearPlaneIntersections(e,t,r));for(var s=1/0,a=-1/0,o=1/0,h=-1/0,l=0;l<t.length;l++){var u=t[l];u.x<s&&(s=u.x),u.x>a&&(a=u.x),u.y<o&&(o=u.y),u.y>h&&(h=u.y)}return{top:h,right:a,bottom:o,left:s}}},{key:"_computeWebGLBoundingRect",value:function(){var e=this._getWorldCoords(),t={top:1-(e.top+1)/2,right:(e.right+1)/2,bottom:1-(e.bottom+1)/2,left:(e.left+1)/2};t.width=t.right-t.left,t.height=t.bottom-t.top,this._boundingRect.worldToDocument={width:t.width*this.renderer._boundingRect.width,height:t.height*this.renderer._boundingRect.height,top:t.top*this.renderer._boundingRect.height+this.renderer._boundingRect.top,left:t.left*this.renderer._boundingRect.width+this.renderer._boundingRect.left,right:t.left*this.renderer._boundingRect.width+this.renderer._boundingRect.left+t.width*this.renderer._boundingRect.width,bottom:t.top*this.renderer._boundingRect.height+this.renderer._boundingRect.top+t.height*this.renderer._boundingRect.height}}},{key:"getWebGLBoundingRect",value:function(){return this._matrices.modelViewProjection?(this._boundingRect.worldToDocument&&!this.alwaysDraw||this._computeWebGLBoundingRect(),this._boundingRect.worldToDocument):this._boundingRect.document}},{key:"_getWebGLDrawRect",value:function(){return this._computeWebGLBoundingRect(),{top:this._boundingRect.worldToDocument.top-this.drawCheckMargins.top,right:this._boundingRect.worldToDocument.right+this.drawCheckMargins.right,bottom:this._boundingRect.worldToDocument.bottom+this.drawCheckMargins.bottom,left:this._boundingRect.worldToDocument.left-this.drawCheckMargins.left}}},{key:"_shouldDrawCheck",value:function(){var e=this,t=this._getWebGLDrawRect();Math.round(t.right)<=this.renderer._boundingRect.left||Math.round(t.left)>=this.renderer._boundingRect.left+this.renderer._boundingRect.width||Math.round(t.bottom)<=this.renderer._boundingRect.top||Math.round(t.top)>=this.renderer._boundingRect.top+this.renderer._boundingRect.height?this._shouldDraw&&(this._shouldDraw=!1,this.renderer.nextRender.add((function(){return e._onLeaveViewCallback&&e._onLeaveViewCallback()}))):(this._shouldDraw||this.renderer.nextRender.add((function(){return e._onReEnterViewCallback&&e._onReEnterViewCallback()})),this._shouldDraw=!0)}},{key:"isDrawn",value:function(){return this._canDraw&&this.visible&&(this._shouldDraw||this.alwaysDraw)}},{key:"enableDepthTest",value:function(e){this._depthTest=e}},{key:"_initSources",value:function(){var e=0;if(this.autoloadSources){var t=this.htmlElement.getElementsByTagName("img"),r=this.htmlElement.getElementsByTagName("video"),i=this.htmlElement.getElementsByTagName("canvas");t.length&&this.loadImages(t),r.length&&this.loadVideos(r),i.length&&this.loadCanvases(i),e=t.length+r.length+i.length}this.loader._setLoaderSize(e),this._canDraw=!0}},{key:"_startDrawing",value:function(){this._canDraw&&(this._onRenderCallback&&this._onRenderCallback(),this.target?this.renderer.bindFrameBuffer(this.target):null===this.renderer.state.scenePassIndex&&this.renderer.bindFrameBuffer(null),this._setPerspectiveMatrix(),this._setMVMatrix(),(this.alwaysDraw||this._shouldDraw)&&this.visible&&this._draw())}},{key:"mouseToPlaneCoords",value:function(e){if(H.setAxisOrder(this.quaternion.axisOrder),H.equals(this.quaternion)&&q.equals(this.transformOrigin))return _get(_getPrototypeOf(i.prototype),"mouseToPlaneCoords",this).call(this,e);var t={x:e.x/(this.renderer._boundingRect.width/this.renderer.pixelRatio)*2-1,y:2*(1-e.y/(this.renderer._boundingRect.height/this.renderer.pixelRatio))-1},r=this.camera.position.clone(),n=Q.set(t.x,t.y,-.5);n.unproject(this.camera),n.sub(r).normalize();var s=Z.set(0,0,-1);s.applyQuat(this.quaternion).normalize();var a=$.set(0,0,0),o=s.dot(n);if(Math.abs(o)>=1e-4){var h=this._matrices.world.matrix.getInverse().multiply(this.camera.viewMatrix),l=this._boundingRect.world.transformOrigin.clone().add(this._translation),u=K.set(this._translation.x-l.x,this._translation.y-l.y,this._translation.z-l.z);u.applyQuat(this.quaternion),l.add(u);var d=s.dot(l.clone().sub(r))/o;a.copy(r.add(n.multiplyScalar(d))),a.applyMat4(h)}else a.set(1/0,1/0,1/0);return J.set(a.x,a.y)}},{key:"onReEnterView",value:function(e){return e&&(this._onReEnterViewCallback=e),this}},{key:"onLeaveView",value:function(e){return e&&(this._onLeaveViewCallback=e),this}}]),i}(z),te=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.shaderPass,a=r.depth,o=void 0!==a&&a,h=r.clear,l=void 0===h||h,u=r.minWidth,d=void 0===u?1024:u,c=r.minHeight,f=void 0===c?1024:c,p=r.texturesOptions,_=void 0===p?{}:p;if(_classCallCheck(this,e),this.type="RenderTarget",(t=t&&t.renderer||t)&&"Renderer"===t.type){if(!t.gl)return void(t.production||i(this.type+": Unable to create a "+this.type+" because the Renderer WebGL context is not defined"))}else i(this.type+": Renderer not passed as first argument",t);this.renderer=t,this.gl=this.renderer.gl,this.index=this.renderer.renderTargets.length,this._shaderPass=s,this._depth=o,this._shouldClear=l,this._minSize={width:d*this.renderer.pixelRatio,height:f*this.renderer.pixelRatio},_=Object.assign({sampler:"uRenderTexture",isFBOTexture:!0,premultiplyAlpha:!1,anisotropy:1,generateMipmap:!1,floatingPoint:"none",wrapS:this.gl.CLAMP_TO_EDGE,wrapT:this.gl.CLAMP_TO_EDGE,minFilter:this.gl.LINEAR,magFilter:this.gl.LINEAR},_),this._texturesOptions=_,this.userData={},this.uuid=n(),this.renderer.renderTargets.push(this),this.renderer.onSceneChange(),this._initRenderTarget()}return _createClass(e,[{key:"_initRenderTarget",value:function(){this._setSize(),this.textures=[],this._createFrameBuffer()}},{key:"_restoreContext",value:function(){this._setSize(),this._createFrameBuffer()}},{key:"_setSize",value:function(){this._shaderPass&&this._shaderPass._isScenePass?this._size={width:this.renderer._boundingRect.width,height:this.renderer._boundingRect.height}:this._size={width:Math.max(this._minSize.width,this.renderer._boundingRect.width),height:Math.max(this._minSize.height,this.renderer._boundingRect.height)}}},{key:"resize",value:function(){this._shaderPass&&(this._setSize(),this.textures[0].resize(),this.renderer.bindFrameBuffer(this,!0),this._depth&&this._bindDepthBuffer(),this.renderer.bindFrameBuffer(null))}},{key:"_bindDepthBuffer",value:function(){this._depthBuffer&&(this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,this._depthBuffer),this.gl.renderbufferStorage(this.gl.RENDERBUFFER,this.gl.DEPTH_COMPONENT16,this._size.width,this._size.height),this.gl.framebufferRenderbuffer(this.gl.FRAMEBUFFER,this.gl.DEPTH_ATTACHMENT,this.gl.RENDERBUFFER,this._depthBuffer))}},{key:"_createFrameBuffer",value:function(){this._frameBuffer=this.gl.createFramebuffer(),this.renderer.bindFrameBuffer(this,!0),this.textures.length?(this.textures[0]._parent=this,this.textures[0]._restoreContext()):new E(this.renderer,this._texturesOptions).addParent(this),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this.textures[0]._sampler.texture,0),this._depth&&(this._depthBuffer=this.gl.createRenderbuffer(),this._bindDepthBuffer()),this.renderer.bindFrameBuffer(null)}},{key:"getTexture",value:function(){return this.textures[0]}},{key:"remove",value:function(){this._shaderPass?this.renderer.production||r(this.type+": You're trying to remove a RenderTarget attached to a ShaderPass. You should remove that ShaderPass instead:",this._shaderPass):(this._dispose(),this.renderer.removeRenderTarget(this))}},{key:"_dispose",value:function(){this._frameBuffer&&(this.gl.deleteFramebuffer(this._frameBuffer),this._frameBuffer=null),this._depthBuffer&&(this.gl.deleteRenderbuffer(this._depthBuffer),this._depthBuffer=null),this.textures[0]._dispose(),this.textures=[]}}]),e}(),re=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){var i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=n.widthSegments,a=n.heightSegments,o=n.renderOrder,h=n.depthTest,l=n.cullFace,u=n.uniforms,d=n.vertexShaderID,c=n.fragmentShaderID,f=n.vertexShader,p=n.fragmentShader,_=n.texturesOptions,g=n.crossOrigin,m=n.depth,v=void 0!==m&&m,y=n.clear,x=void 0===y||y,b=n.renderTarget;return _classCallCheck(this,r),s=1,a=1,l="back",(i=t.call(this,e,e.container,"ShaderPass",{widthSegments:s,heightSegments:a,renderOrder:o,depthTest:h,cullFace:l,uniforms:u,vertexShaderID:d,fragmentShaderID:c,vertexShader:f,fragmentShader:p,texturesOptions:_,crossOrigin:g})).gl?(i._isScenePass=!0,i.index=i.renderer.shaderPasses.length,i._depth=v,i._shouldClear=x,i.target=b,i.target&&(i._isScenePass=!1,i._shouldClear=i.target._shouldClear),i._program.compiled&&(i._initShaderPass(),i.renderer.shaderPasses.push(_assertThisInitialized(i)),i.renderer.nextRender.add((function(){i.renderer.scene.addShaderPass(_assertThisInitialized(i))}))),i):_possibleConstructorReturn(i)}return _createClass(r,[{key:"_programRestored",value:function(){this.renderer.scene.addShaderPass(this);for(var e=0;e<this.textures.length;e++)this.textures[e]._parent=this,this.textures[e]._restoreContext();this._canDraw=!0}},{key:"_initShaderPass",value:function(){this.target?(this.setRenderTarget(this.target),this.target._shaderPass=this):this._createFrameBuffer(),new E(this.renderer,{sampler:"uRenderTexture",isFBOTexture:!0,fromTexture:this.target.getTexture()}).addParent(this),this.loader._setLoaderSize(0),this._canDraw=!0,this.renderer.needRender()}},{key:"_createFrameBuffer",value:function(){var e=new te(this.renderer,{shaderPass:this,clear:this._shouldClear,depth:this._depth,texturesOptions:this._texturesOptions});this.setRenderTarget(e)}},{key:"_startDrawing",value:function(){this._canDraw&&(this._onRenderCallback&&this._onRenderCallback(),this._isScenePass?this.renderer.state.scenePassIndex+1<this.renderer.scene.stacks.scenePasses.length?(this.renderer.bindFrameBuffer(this.renderer.scene.stacks.scenePasses[this.renderer.state.scenePassIndex+1].target),this.renderer.state.scenePassIndex++):this.renderer.bindFrameBuffer(null):null===this.renderer.state.scenePassIndex&&this.renderer.bindFrameBuffer(null),this.renderer.state.forceBufferUpdate=!0,this._draw())}}]),r}(z),ie=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,i){var n,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=s.sampler,o=void 0===a?"uPingPongTexture":a,h=s.widthSegments,l=s.heightSegments,u=s.renderOrder,d=s.depthTest,c=s.cullFace,f=s.uniforms,p=s.vertexShaderID,_=s.fragmentShaderID,g=s.vertexShader,m=s.fragmentShader,v=s.texturesOptions,y=s.crossOrigin,x=s.alwaysDraw,b=s.visible,k=s.transparent,w=s.drawCheckMargins,T=s.autoloadSources,P=s.watchScroll,R=s.fov;if(_classCallCheck(this,r),d=!1,T=!1,!(n=t.call(this,e,i,{widthSegments:h,heightSegments:l,renderOrder:u,depthTest:d,cullFace:c,uniforms:f,vertexShaderID:p,fragmentShaderID:_,vertexShader:g,fragmentShader:m,texturesOptions:v,crossOrigin:y,alwaysDraw:x,visible:b,transparent:k,drawCheckMargins:w,autoloadSources:T,watchScroll:P,fov:R})).gl)return _possibleConstructorReturn(n);n.renderer.scene.removePlane(_assertThisInitialized(n)),n.type="PingPongPlane",n.renderer.scene.addPlane(_assertThisInitialized(n)),n.readPass=new te(e,{depth:!1,clear:!1,texturesOptions:v}),n.writePass=new te(e,{depth:!1,clear:!1,texturesOptions:v}),n.createTexture({sampler:o});var S=0;return n.readPass.getTexture().onSourceUploaded((function(){S++,n._checkIfReady(S)})),n.writePass.getTexture().onSourceUploaded((function(){S++,n._checkIfReady(S)})),n.setRenderTarget(n.readPass),n._onRenderCallback=function(){n.readPass&&n.writePass&&n.textures[0]&&n.textures[0]._uploaded&&n.setRenderTarget(n.writePass),n._onPingPongRenderCallback&&n._onPingPongRenderCallback()},n._onAfterRenderCallback=function(){n.readPass&&n.writePass&&n.textures[0]&&n.textures[0]._uploaded&&n._swapPasses(),n._onPingPongAfterRenderCallback&&n._onPingPongAfterRenderCallback()},n}return _createClass(r,[{key:"_checkIfReady",value:function(e){var t=this;2===e&&this.renderer.nextRender.add((function(){t.textures[0].copy(t.target.getTexture())}))}},{key:"_swapPasses",value:function(){var e=this.readPass;this.readPass=this.writePass,this.writePass=e,this.textures[0].copy(this.readPass.getTexture())}},{key:"getTexture",value:function(){return this.textures[0]}},{key:"onRender",value:function(e){return e&&(this._onPingPongRenderCallback=e),this}},{key:"onAfterRender",value:function(e){return e&&(this._onPingPongAfterRenderCallback=e),this}},{key:"remove",value:function(){this.target=null,this.renderer.bindFrameBuffer(null),this.writePass&&(this.writePass.remove(),this.writePass=null),this.readPass&&(this.readPass.remove(),this.readPass=null),_get(_getPrototypeOf(r.prototype),"remove",this).call(this)}}]),r}(ee),ne=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){var i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=n.renderOrder,a=n.depthTest,o=n.texturesOptions,h=n.crossOrigin,l=n.depth,u=n.clear,d=n.renderTarget;_classCallCheck(this,r);var c="\n            precision mediump float;\n            \n            varying vec3 vVertexPosition;\n            varying vec2 vTextureCoord;\n        \n            uniform sampler2D uRenderTexture;\n            \n            uniform vec2 uResolution;\n            \n            #define FXAA_REDUCE_MIN   (1.0/128.0)\n            #define FXAA_REDUCE_MUL   (1.0/8.0)\n            #define FXAA_SPAN_MAX     8.0\n            \n            void main() {\n                vec2 res = 1.0 / uResolution;\n            \n                vec3 rgbNW = texture2D(uRenderTexture, (vTextureCoord.xy + vec2(-1.0, -1.0) * res)).xyz;\n                vec3 rgbNE = texture2D(uRenderTexture, (vTextureCoord.xy + vec2(1.0, -1.0) * res)).xyz;\n                vec3 rgbSW = texture2D(uRenderTexture, (vTextureCoord.xy + vec2(-1.0, 1.0) * res)).xyz;\n                vec3 rgbSE = texture2D(uRenderTexture, (vTextureCoord.xy + vec2(1.0, 1.0) * res)).xyz;\n                vec4 rgbaM = texture2D(uRenderTexture, vTextureCoord.xy * res);\n                vec3 rgbM = rgbaM.xyz;\n                vec3 luma = vec3(0.299, 0.587, 0.114);\n            \n                float lumaNW = dot(rgbNW, luma);\n                float lumaNE = dot(rgbNE, luma);\n                float lumaSW = dot(rgbSW, luma);\n                float lumaSE = dot(rgbSE, luma);\n                float lumaM  = dot(rgbM,  luma);\n                float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n                float lumaMax = max(lumaM, max(max(lumaNW, lumaNE) , max(lumaSW, lumaSE)));\n            \n                vec2 dir;\n                dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n                dir.y = ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n            \n                float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) * (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n            \n                float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n                dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n                      max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                            dir * rcpDirMin)) * res;\n                vec4 rgbA = (1.0/2.0) * (\n                texture2D(uRenderTexture, vTextureCoord.xy + dir * (1.0/3.0 - 0.5)) +\n                texture2D(uRenderTexture, vTextureCoord.xy + dir * (2.0/3.0 - 0.5)));\n                vec4 rgbB = rgbA * (1.0/2.0) + (1.0/4.0) * (\n                texture2D(uRenderTexture, vTextureCoord.xy + dir * (0.0/3.0 - 0.5)) +\n                texture2D(uRenderTexture, vTextureCoord.xy + dir * (3.0/3.0 - 0.5)));\n                float lumaB = dot(rgbB, vec4(luma, 0.0));\n            \n                if ((lumaB < lumaMin) || (lumaB > lumaMax)) {\n                    gl_FragColor = rgbA;\n                } else {\n                    gl_FragColor = rgbB;\n                }\n            }\n        ",f={resolution:{name:"uResolution",type:"2f",value:[0,0]}};return(i=t.call(this,e,{fragmentShader:c,uniforms:f,renderOrder:s,depthTest:a,texturesOptions:o,crossOrigin:h,depth:l,clear:u,renderTarget:d})).gl?(i.uniforms.resolution.value=[i.renderer._boundingRect.width,i.renderer._boundingRect.height],i._onAfterResizeCallback=function(){i.uniforms.resolution.value=[i.renderer._boundingRect.width,i.renderer._boundingRect.height],i._onFXAAPassAfterResizeCallback&&i._onFXAAPassAfterResizeCallback()},i):_possibleConstructorReturn(i)}return _createClass(r,[{key:"onAfterResize",value:function(e){return e&&(this._onFXAAPassAfterResizeCallback=e),this}}]),r}(re);e.Curtains=d,e.FXAAPass=ne,e.Mat4=w,e.PingPongPlane=ie,e.Plane=ee,e.Quat=I,e.RenderTarget=te,e.ShaderPass=re,e.Texture=E,e.TextureLoader=M,e.Vec2=T,e.Vec3=P,Object.defineProperty(e,"__esModule",{value:!0})}));